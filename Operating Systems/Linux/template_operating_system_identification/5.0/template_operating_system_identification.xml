<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T08:04:07Z</date>
  <groups>
    <group>
      <name>Templates</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Template_OSI_v2</template>
      <name>Template Operating System Identification v2</name>
      <groups>
        <group>
          <name>Templates</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>OS</name>
        </application>
      </applications>
      <discovery_rules>
        <discovery_rule>
          <name>Operating System Identification discovery</name>
          <key>vfs.file.contents["/etc/os-release"]</key>
          <delay>1d</delay>
          <description>Operating System Identification discovery.</description>
          <item_prototypes>
            <item_prototype>
              <name>OSI {#KEY}</name>
              <key>vfs.file.regexp["/etc/os-release","^{#KEY}=(?P&lt;quote>[\"']?)(?P&lt;value>[\S\s]*?)(?P=quote)($|\s)",,,,\2]</key>
              <delay>1d</delay>
              <trends>0</trends>
              <value_type>CHAR</value_type>
              <applications>
                <application>
                  <name>OS</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
          <preprocessing>
            <step>
              <type>JAVASCRIPT</type>
              <params> var lld = []; var lines = value.split("\n"); var lines_num = lines.length; for (i = 0; i &lt; lines_num; i++) { var row = {}; var k = lines[i].split("="); row["{#KEY}"] = k[0]; lld.push(row); } return JSON.stringify(lld);</params>
            </step>
          </preprocessing>
        </discovery_rule>
      </discovery_rules>
    </template>
  </templates>
</zabbix_export>