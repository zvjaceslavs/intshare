<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-19T21:23:17Z</date>
  <groups>
    <group>
      <name>Security Cameras - HikVision</name>
    </group>
    <group>
      <name>Templates</name>
    </group>
    <group>
      <name>Templates/Modules</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Security Cameras - HikVision</template>
      <name>Security Cameras - HikVision</name>
      <description>Based of SNMP v2 Generic</description>
      <templates>
        <template>
          <name>Template App HTTP Service</name>
        </template>
        <template>
          <name>Template Module ICMP Ping</name>
        </template>
      </templates>
      <groups>
        <group>
          <name>Security Cameras - HikVision</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>General</name>
        </application>
        <application>
          <name>Video Stream</name>
        </application>
      </applications>
      <items>
        <item>
          <name>System Firmware</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.39165.1.3.0</snmp_oid>
          <key>system.firmware</key>
          <delay>1h</delay>
          <history>0</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>MIB: SNMPv2-MIB A textual description of the entity. This value should include the full name and version identification of the system's hardware type, software operating-system, and networking software.</description>
          <inventory_link>OS</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>1d</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{diff()}=1</expression>
              <recovery_mode>NONE</recovery_mode>
              <name>Firmware Updated</name>
              <priority>INFO</priority>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>System MAC Address</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.39165.1.4.0</snmp_oid>
          <key>system.macaddress</key>
          <delay>12h</delay>
          <history>0</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>MIB: SNMPv2-MIB A textual description of the entity. This value should include the full name and version identification of the system's hardware type, software operating-system, and networking software.</description>
          <inventory_link>MACADDRESS_A</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>1d</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>System Manafacturer</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.39165.1.6.0</snmp_oid>
          <key>system.manafacturer</key>
          <delay>12h</delay>
          <history>0</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>MIB: SNMPv2-MIB A textual description of the entity. This value should include the full name and version identification of the system's hardware type, software operating-system, and networking software.</description>
          <inventory_link>VENDOR</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>1d</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>System Model</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.39165.1.1.0</snmp_oid>
          <key>system.model</key>
          <delay>12h</delay>
          <history>0</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>MIB: SNMPv2-MIB A textual description of the entity. This value should include the full name and version identification of the system's hardware type, software operating-system, and networking software.</description>
          <inventory_link>MODEL</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>1d</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>SNMP agent availability</name>
          <type>INTERNAL</type>
          <key>zabbix[host,snmp,available]</key>
          <delay>5m</delay>
          <history>7d</history>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <valuemap>
            <name>zabbix.host.available</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{max({$SNMP.TIMEOUT})}=0</expression>
              <name>No SNMP data collection</name>
              <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
              <priority>WARNING</priority>
              <description>SNMP is not available for polling. Please check device connectivity and SNMP settings.</description>
              <dependencies>
                <dependency>
                  <name>Unavailable by ICMP ping</name>
                  <expression>{Security Cameras - HikVision:icmpping.max(#3)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
      </items>
      <macros>
        <macro>
          <macro>{$RTSP_PASS}</macro>
          <value>RTSP_PASS</value>
        </macro>
        <macro>
          <macro>{$RTSP_USER}</macro>
          <value>RTSP_User</value>
        </macro>
        <macro>
          <macro>{$SNMP.TIMEOUT}</macro>
          <value>5m</value>
        </macro>
      </macros>
    </template>
    <template>
      <template>Template App HTTP Service</template>
      <name>Template App HTTP Service</name>
      <groups>
        <group>
          <name>Templates</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>HTTP service</name>
        </application>
      </applications>
      <items>
        <item>
          <name>HTTP service is running</name>
          <type>SIMPLE</type>
          <key>net.tcp.service[http]</key>
          <delay>60</delay>
          <history>7d</history>
          <applications>
            <application>
              <name>HTTP service</name>
            </application>
          </applications>
          <valuemap>
            <name>Service state</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{max(#3)}=0</expression>
              <name>HTTP service is down on {HOST.NAME}</name>
              <priority>AVERAGE</priority>
            </trigger>
          </triggers>
        </item>
      </items>
    </template>
    <template>
      <template>Template Module ICMP Ping</template>
      <name>Template Module ICMP Ping</name>
      <description>Template Module ICMP Ping version: 0.12</description>
      <groups>
        <group>
          <name>Templates/Modules</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Status</name>
        </application>
      </applications>
      <items>
        <item>
          <name>ICMP ping</name>
          <type>SIMPLE</type>
          <key>icmpping</key>
          <delay>60</delay>
          <history>1w</history>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <valuemap>
            <name>Service state</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{max(#3)}=0</expression>
              <name>Unavailable by ICMP ping</name>
              <priority>HIGH</priority>
              <description>Last value: {ITEM.LASTVALUE1}. Last three attempts returned timeout. Please check device connectivity.</description>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>ICMP loss</name>
          <type>SIMPLE</type>
          <key>icmppingloss</key>
          <delay>60</delay>
          <history>1w</history>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{min(5m)}>{$ICMP_LOSS_WARN} and {min(5m)}&lt;100</expression>
              <name>High ICMP ping loss</name>
              <priority>WARNING</priority>
              <dependencies>
                <dependency>
                  <name>Unavailable by ICMP ping</name>
                  <expression>{Template Module ICMP Ping:icmpping.max(#3)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>ICMP response time</name>
          <type>SIMPLE</type>
          <key>icmppingsec</key>
          <delay>60</delay>
          <history>1w</history>
          <value_type>FLOAT</value_type>
          <units>s</units>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{avg(5m)}>{$ICMP_RESPONSE_TIME_WARN}</expression>
              <name>High ICMP ping response time</name>
              <priority>WARNING</priority>
              <dependencies>
                <dependency>
                  <name>High ICMP ping loss</name>
                  <expression>{Template Module ICMP Ping:icmppingloss.min(5m)}>{$ICMP_LOSS_WARN} and {Template Module ICMP Ping:icmppingloss.min(5m)}&lt;100</expression>
                </dependency>
                <dependency>
                  <name>Unavailable by ICMP ping</name>
                  <expression>{Template Module ICMP Ping:icmpping.max(#3)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
      </items>
      <macros>
        <macro>
          <macro>{$ICMP_LOSS_WARN}</macro>
          <value>20</value>
        </macro>
        <macro>
          <macro>{$ICMP_RESPONSE_TIME_WARN}</macro>
          <value>0.15</value>
        </macro>
      </macros>
    </template>
  </templates>
  <value_maps>
    <value_map>
      <name>Service state</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Down</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Up</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>zabbix.host.available</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>not available</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>available</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>unknown</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>