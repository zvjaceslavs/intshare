<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-19T21:25:06Z</date>
  <groups>
    <group>
      <name>Templates/IOT</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Shelly-1PM</template>
      <name>Template Shelly 1PM</name>
      <groups>
        <group>
          <name>Templates/IOT</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Cloud</name>
        </application>
        <application>
          <name>Gatherer</name>
        </application>
        <application>
          <name>Input</name>
        </application>
        <application>
          <name>Meters</name>
        </application>
        <application>
          <name>MQTT</name>
        </application>
        <application>
          <name>Relays</name>
        </application>
        <application>
          <name>System</name>
        </application>
        <application>
          <name>Temperature</name>
        </application>
        <application>
          <name>Update</name>
        </application>
        <application>
          <name>WiFi</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Status gatherer</name>
          <type>HTTP_AGENT</type>
          <key>shelly1pm.status</key>
          <history>30d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <authtype>BASIC</authtype>
          <username>admin</username>
          <password>{$SHELLYPWD}</password>
          <description>This gatherer gathers all the data for the different items from the Rest-API Interface of the Shelly device.</description>
          <applications>
            <application>
              <name>Gatherer</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$.body</params>
            </step>
          </preprocessing>
          <url>http://{HOST.IP}/status</url>
          <follow_redirects>NO</follow_redirects>
          <output_format>JSON</output_format>
          <triggers>
            <trigger>
              <expression>{nodata(180)}=1</expression>
              <name>No data received for >3m</name>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Actions Skipped Count</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.actions_stats.skipped</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..actions_stats.skipped</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{change()}>0</expression>
              <recovery_mode>NONE</recovery_mode>
              <name>At least one action has been skipped</name>
              <priority>WARNING</priority>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Configuration Changed Count</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.cfg_changed_cnt</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..cfg_changed_cnt</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{change()}>0</expression>
              <recovery_mode>NONE</recovery_mode>
              <name>System configuration has been changed</name>
              <priority>INFO</priority>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Cloud Connection State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.cloud.connected</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Cloud</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Connection State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..cloud.connected</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "false") { return 0 ; } else if (value == "true") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{change()}&lt;>0</expression>
              <recovery_mode>NONE</recovery_mode>
              <name>Cloud connection state has changed</name>
              <priority>WARNING</priority>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Cloud Configured State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.cloud.enabled</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Cloud</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Enabled State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..cloud.enabled</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "false") { return 0 ; } else if (value == "true") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{change()}&lt;>0</expression>
              <recovery_mode>NONE</recovery_mode>
              <name>Cloud configuration has changed</name>
              <priority>INFO</priority>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Filesystem Free</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.fs_free</key>
          <delay>0</delay>
          <units>b</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..fs_free</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Filesystem Total</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.fs_size</key>
          <delay>0</delay>
          <units>b</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..fs_size</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Input Event</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.inputs0.event</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Input</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Input Event</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..inputs[0].event</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]"</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "S") { return 0 ; } else if (value == "L") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Input Event Count</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.inputs0.event_cnt</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Input</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..inputs[0].event_cnt</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Input State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.inputs0.input</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Input</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly On/Off State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..inputs[0].input</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{change()}&lt;>0</expression>
              <recovery_mode>NONE</recovery_mode>
              <name>Input state has changed</name>
              <priority>INFO</priority>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>MAC Address</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.mac</key>
          <delay>0</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <inventory_link>MACADDRESS_A</inventory_link>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..mac</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]"</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Power Consumption (1m)</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.meters0.counters0</key>
          <delay>0</delay>
          <value_type>FLOAT</value_type>
          <units>Wh</units>
          <applications>
            <application>
              <name>Meters</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..meters[0].counters[0]</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>return value/60;</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Meters Self-Check State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.meters0.is_valid</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Meters</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Status</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..meters[0].is_valid</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "true") { return 0 ; } else if (value == "false") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{last()}&lt;>0</expression>
              <name>Meters self-check is not ok</name>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Overpower Value</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.meters0.overpower</key>
          <delay>0</delay>
          <value_type>FLOAT</value_type>
          <units>W</units>
          <applications>
            <application>
              <name>Meters</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..meters[0].overpower</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Current Power Consumption</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.meters0.power</key>
          <delay>0</delay>
          <value_type>FLOAT</value_type>
          <units>W</units>
          <applications>
            <application>
              <name>Meters</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..meters[0].power</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Current Power Consumption Time</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.meters0.timestamp</key>
          <delay>0</delay>
          <value_type>FLOAT</value_type>
          <applications>
            <application>
              <name>Meters</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..meters[0].timestamp</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Total Power Consumption</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.meters0.total</key>
          <delay>0</delay>
          <value_type>FLOAT</value_type>
          <units>W</units>
          <applications>
            <application>
              <name>Meters</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..meters[0].total</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>MQTT Connection State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.mqtt.connected</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>MQTT</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Connection State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..mqtt.connected</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "false") { return 0 ; } else if (value == "true") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{change()}&lt;>0</expression>
              <recovery_mode>NONE</recovery_mode>
              <name>MQTT connection state has changed</name>
              <priority>WARNING</priority>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Overheating State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.overtemperature</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Temperature</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Status</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..overtemperature</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "false") { return 0 ; } else if (value == "true") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{last()}=1</expression>
              <name>Overheating event has been detected</name>
              <priority>DISASTER</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Memory Free</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.ram_free</key>
          <delay>0</delay>
          <units>b</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..ram_free</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Memory Total</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.ram_total</key>
          <delay>0</delay>
          <units>b</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..ram_total</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Relay Timer State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.relays0.has_timer</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Relays</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Enabled State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..relays[0].has_timer</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "false") { return 0 ; } else if (value == "true") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Relay State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.relays0.ison</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Relays</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly On/Off State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..relays[0].ison</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "false") { return 0 ; } else if (value == "true") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{change()}&lt;>0</expression>
              <recovery_mode>NONE</recovery_mode>
              <name>Input state has changed</name>
              <priority>WARNING</priority>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Relay Overpower State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.relays0.overpower</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Relays</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Status</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..relays[0].overpower</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "false") { return 0 ; } else if (value == "true") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{last()}=1</expression>
              <name>Overpower event has been detected</name>
              <priority>DISASTER</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Relay Last Command Source</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.relays0.source</key>
          <delay>0</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>Relays</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..relays[0].source</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]"</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Relay Timer Duration</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.relays0.timer_duration</key>
          <delay>0</delay>
          <units>s</units>
          <applications>
            <application>
              <name>Relays</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..relays[0].timer_duration</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Relay Timer Remaining</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.relays0.timer_remaining</key>
          <delay>0</delay>
          <units>s</units>
          <applications>
            <application>
              <name>Relays</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..relays[0].timer_remaining</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Relay Timer Started</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.relays0.timer_started</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Relays</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..relays[0].timer_started</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Cloud Serial Number</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.serial</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Cloud</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..serial</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Temperature Status</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.temperature_status</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Temperature</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Temperature Status</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..temperature_status</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]"</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "Normal") { return 0 ; } else if (value == "High") { return 1 ; } else if (value == "Very High") { return 2 ; } else { return 3 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{last()}=1</expression>
              <name>Device temperature is high</name>
              <priority>AVERAGE</priority>
            </trigger>
            <trigger>
              <expression>{last()}=2</expression>
              <name>Device temperature is very high</name>
              <priority>HIGH</priority>
            </trigger>
            <trigger>
              <expression>{last()}=3</expression>
              <name>Device temperature status is unknown</name>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Current Time</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.time</key>
          <delay>0</delay>
          <trends>0</trends>
          <status>DISABLED</status>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..time</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Temperature Self-Check State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.tmp.is_valid</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Temperature</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Status</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..tmp.is_valid</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "true") { return 0 ; } else if (value == "false") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{last()}&lt;>0</expression>
              <name>Temperature self-check is not ok</name>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Current Temperature</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.tmp.tC</key>
          <delay>0</delay>
          <value_type>FLOAT</value_type>
          <units>°C</units>
          <applications>
            <application>
              <name>Temperature</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..tmp.tC</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Current Unixtime</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.unixtime</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..unixtime</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{fuzzytime(60)}=0</expression>
              <name>Time is out of sync</name>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Update Availability</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.update.has_update</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Update</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Update Availability</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..update.has_update</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "false") { return 0 ; } else if (value == "true") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{last()}=1</expression>
              <name>Update available</name>
              <priority>INFO</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>New Version Available</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.update.new_version</key>
          <delay>0</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>Update</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..update.new_version</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]"</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Current Version</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.update.old_version</key>
          <delay>0</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>Update</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..update.old_version</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]"</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{change()}&lt;>0</expression>
              <recovery_mode>NONE</recovery_mode>
              <name>Version has changed</name>
              <priority>WARNING</priority>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Update Status</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.update.status</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>Update</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Update Status</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..update.status</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]"</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "idle") { return 0 ; } else if (value == "pending") { return 1 ; } else if (value == "updating") { return 2 ; } else { return 3 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>Uptime</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.uptime</key>
          <delay>0</delay>
          <units>s</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..uptime</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{last()}&lt;600</expression>
              <name>Device has been restarted (Uptime &lt;10m)</name>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>WiFi Connection State</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.wifi_sta.connected</key>
          <delay>0</delay>
          <applications>
            <application>
              <name>WiFi</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Connection State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..wifi_sta.connected</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
            <step>
              <type>JAVASCRIPT</type>
              <params>if (value == "false") { return 0 ; } else if (value == "true") { return 1 ; } else { return 2 ; }</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>WiFi IP</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.wifi_sta.ip</key>
          <delay>0</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>WiFi</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..wifi_sta.ip</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]"</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>WiFi RSSI</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.wifi_sta.rssi</key>
          <delay>0</delay>
          <value_type>FLOAT</value_type>
          <applications>
            <application>
              <name>WiFi</name>
            </application>
          </applications>
          <valuemap>
            <name>Shelly Connection State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..wifi_sta.rssi</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
        <item>
          <name>WiFi SSID</name>
          <type>DEPENDENT</type>
          <key>shelly1pm.status.wifi_sta.ssid</key>
          <delay>0</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>WiFi</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$..wifi_sta.ssid</params>
            </step>
            <step>
              <type>TRIM</type>
              <params>[]"</params>
            </step>
          </preprocessing>
          <master_item>
            <key>shelly1pm.status</key>
          </master_item>
        </item>
      </items>
      <macros>
        <macro>
          <macro>{$SHELLYPWD}</macro>
          <type>SECRET_TEXT</type>
          <description>Password for admin user, if present</description>
        </macro>
      </macros>
    </template>
  </templates>
  <triggers>
    <trigger>
      <expression>{Shelly-1PM:shelly1pm.status.fs_free.last()}>={Shelly-1PM:shelly1pm.status.fs_size.last()}*0.8 and {Shelly-1PM:shelly1pm.status.fs_free.last()}&lt;{Shelly-1PM:shelly1pm.status.fs_size.last()}*0.9</expression>
      <name>Filesystem usage >=80%</name>
      <priority>WARNING</priority>
    </trigger>
    <trigger>
      <expression>{Shelly-1PM:shelly1pm.status.fs_free.last()}>={Shelly-1PM:shelly1pm.status.fs_size.last()}*0.9</expression>
      <name>Filesystem usage >=90%</name>
      <priority>AVERAGE</priority>
    </trigger>
    <trigger>
      <expression>{Shelly-1PM:shelly1pm.status.ram_free.last()}>={Shelly-1PM:shelly1pm.status.ram_total.last()}*0.8 and {Shelly-1PM:shelly1pm.status.ram_free.last()}&lt;{Shelly-1PM:shelly1pm.status.ram_total.last()}*0.9</expression>
      <name>Memory usage >=80%</name>
      <priority>WARNING</priority>
    </trigger>
    <trigger>
      <expression>{Shelly-1PM:shelly1pm.status.ram_free.last()}>={Shelly-1PM:shelly1pm.status.ram_total.last()}*0.9</expression>
      <name>Memory usage >=90%</name>
      <priority>AVERAGE</priority>
    </trigger>
  </triggers>
  <value_maps>
    <value_map>
      <name>Shelly Connection State</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Disconnected</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Connected</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>Unknown</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Shelly Enabled State</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Disabled</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Enabled</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>Unknown</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Shelly Input Event</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Shortpush</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Longpush</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>none/invalid</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Shelly On/Off State</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Off</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>On</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>Unknown</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Shelly Status</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Ok</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Critical</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>Unknown</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Shelly Temperature Status</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Normal</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>High</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>Very High</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>Unknown</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Shelly Update Availability</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>No Update Available</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Update Available</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>Unknown</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Shelly Update Status</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Idle</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Pending</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>Updating</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>Unknown</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>