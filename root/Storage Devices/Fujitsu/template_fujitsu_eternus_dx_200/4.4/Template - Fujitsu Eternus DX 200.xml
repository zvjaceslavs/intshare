<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2020-01-21T08:24:32Z</date>
    <groups>
        <group>
            <name>Hardware: Fujitsu Servers</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template - Fujitsu Eternus DX 200</template>
            <name>Template - Fujitsu Eternus DX 200</name>
            <description>Template to monitor Fujitsu Eternus SAN arrays</description>
            <groups>
                <group>
                    <name>Hardware: Fujitsu Servers</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Health</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Machine Pool Used Status</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.211.1.21.1.150.14.1.6.0</snmp_oid>
                    <key>fjdaryMgtMachinePoolUsedStatus</key>
                    <trends>1d</trends>
                    <port>161</port>
                    <description>This is a summary of the pool used status.&#13;
Syntax	 INTEGER {normal(1),&#13;
attention(2),&#13;
warning(3)&#13;
}</description>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Fujitsu Eternus pool used status</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1800</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Overall system status</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.211.1.21.1.150.6.0</snmp_oid>
                    <key>unit.status</key>
                    <trends>1d</trends>
                    <port>161</port>
                    <description>INTEGER {unknown(1),&#13;
unused(2),&#13;
ok(3),&#13;
warning(4),&#13;
failed(5)&#13;
}</description>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Fujitsu eternus status</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1800</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{max(15m)}&lt;3 or {min(15m)}&gt;3</expression>
                            <name>{HOST.NAME} -&gt; Storage status is not OK</name>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Maximum temperature in the last hour</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.211.1.21.1.150.13.3.2.1.5.0</snmp_oid>
                    <key>unit.temperature</key>
                    <trends>1d</trends>
                    <units>C</units>
                    <port>161</port>
                    <description>The maximum temperature is shown during one hour in the past.</description>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1800</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min(15m)}&gt;50</expression>
                            <name>{HOST.NAME} -&gt; Temperature too high</name>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Maximum temperature enclosure in the last hour</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.211.1.21.1.150.13.4.2.1.7.0</snmp_oid>
                    <key>unit.temperature.enclosure</key>
                    <trends>1d</trends>
                    <units>C</units>
                    <port>161</port>
                    <description>The maximum temperature is shown during one hour in the past.</description>
                    <applications>
                        <application>
                            <name>Health</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1800</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{min(15m)}&gt;50</expression>
                            <name>{HOST.NAME}  -&gt; Temperature enclosure too high</name>
                            <priority>HIGH</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Disks</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>discovery[{#DISK_CAPACITY}, 1.3.6.1.4.1.211.1.21.1.150.2.19.2.1.16, {#DISK_STATUS}, 1.3.6.1.4.1.211.1.21.1.150.2.19.2.1.3]</snmp_oid>
                    <key>snmp.discovery.disks</key>
                    <port>161</port>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#DISK_CAPACITY}</macro>
                                <value>^\d\d+</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>2d</lifetime>
                    <description>Discover raid group and status</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Disk №{#SNMPINDEX} - Status</name>
                            <type>SNMPV2</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>1.3.6.1.4.1.211.1.21.1.150.2.19.2.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>disk.status.[{#SNMPINDEX}]</key>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Disks</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>Fujitsu Eternus DX200 Disk status</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>({max(15m)}&lt;1 or {min(15m)}&gt;1) and ({max(15m)}&lt;5 or {min(15m)}&gt;5) and ({max(15m)}&lt;65 or {min(15m)}&gt;65)</expression>
                                    <name>{HOST.NAME} -&gt; Disk №{#SNMPINDEX} not ok</name>
                                    <priority>HIGH</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>RAID Group</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>discovery[{#RAID_GROUP}, 1.3.6.1.4.1.211.1.21.1.150.14.3.2.1.1, {#RAID_LEVEL}, 1.3.6.1.4.1.211.1.21.1.150.14.3.2.1.3, {#RAID_STATUS}, 1.3.6.1.4.1.211.1.21.1.150.14.3.2.1.2, {#RAID_CAPACITY}, 1.3.6.1.4.1.211.1.21.1.150.14.3.2.1.4]</snmp_oid>
                    <key>snmp.discovery.raid.group</key>
                    <port>161</port>
                    <lifetime>2d</lifetime>
                    <description>Discover raid group and status</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>RAID №{#RAID_GROUP} - Capacity</name>
                            <type>SNMPV2</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>1.3.6.1.4.1.211.1.21.1.150.14.3.2.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>raid.group.capacity.[{#SNMPINDEX}]</key>
                            <history>{$HISTORY_LONG}</history>
                            <trends>{$TREND_LONG}</trends>
                            <units>B</units>
                            <port>161</port>
                            <application_prototypes>
                                <application_prototype>
                                    <name>RAID</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1048576</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>RAID №{#RAID_GROUP} - Level</name>
                            <type>SNMPV2</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>1.3.6.1.4.1.211.1.21.1.150.14.3.2.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>raid.group.level.[{#SNMPINDEX}]</key>
                            <history>{$HISTORY_LONG}</history>
                            <trends>{$TREND_LONG}</trends>
                            <port>161</port>
                            <application_prototypes>
                                <application_prototype>
                                    <name>RAID</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>RAID №{#RAID_GROUP} - Status</name>
                            <type>SNMPV2</type>
                            <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                            <snmp_oid>1.3.6.1.4.1.211.1.21.1.150.14.3.2.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>raid.group.status.[{#SNMPINDEX}]</key>
                            <history>{$HISTORY_LONG}</history>
                            <trends>{$TREND_LONG}</trends>
                            <port>161</port>
                            <application_prototypes>
                                <application_prototype>
                                    <name>RAID</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>Fujitsu Eternus DX200</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{max(15m)}&lt;2 or {min(15m)}&gt;2</expression>
                                    <name>{HOST.NAME} -&gt; RAID №{#RAID_GROUP} is not ok</name>
                                    <priority>HIGH</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$SNMP_COMMUNITY}</macro>
                    <value>public</value>
                </macro>
            </macros>
        </template>
    </templates>
    <value_maps>
        <value_map>
            <name>Fujitsu Eternus DX200</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>unknown</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>ok</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>degraded</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>error</newvalue>
                </mapping>
                <mapping>
                    <value>15</value>
                    <newvalue>dormant</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Fujitsu Eternus DX200 Disk status</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>available</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>broken</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>notavailable</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>notsupported</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>present</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>readying</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>recovering</newvalue>
                </mapping>
                <mapping>
                    <value>64</value>
                    <newvalue>partbroken</newvalue>
                </mapping>
                <mapping>
                    <value>65</value>
                    <newvalue>spare</newvalue>
                </mapping>
                <mapping>
                    <value>66</value>
                    <newvalue>formatting</newvalue>
                </mapping>
                <mapping>
                    <value>67</value>
                    <newvalue>unformatted</newvalue>
                </mapping>
                <mapping>
                    <value>68</value>
                    <newvalue>notexist</newvalue>
                </mapping>
                <mapping>
                    <value>69</value>
                    <newvalue>copying</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Fujitsu Eternus pool used status</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>normal</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>attention</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>warning</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Fujitsu eternus status</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>unknown</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>unused</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>ok</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>warning</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>failed</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
