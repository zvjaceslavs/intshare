{"link_name": "AZURE DISCOVERY / MONITOR", "type": "Template", "OS": "General", "vendor": "Others", "minZabbVer": "5.4.x", "link_desc": "<h1>azure-monitor</h1>\n<p>A proof-of-concept to get Azure monitor metrics by Python</p>\n<h1> </h1>\n<h1>How to</h1>\n<p>You could have a Azure Service principal created and keep yout variables, for example:</p>\n<div class=\"snippet-clipboard-content position-relative\">\n<pre><code>az ad sp create-for-rbac --name azure-monitor-test\n</code></pre>\n</div>\n<h1> </h1>\n<h1>USAGE:</h1>\n<p>To discover Available Metrics for a Azure product:</p>\n<p>Azure Components granted by this script. : </p>\n<ul>\n<li>AKS: Azure Kubernetes Services</li>\n<li>ADF: Data Factory</li>\n<li>APIM: API Management</li>\n<li>VM: Virtual Machines</li>\n<li>WEB: App WebServices</li>\n<li>SQL: Azure databases</li>\n<li>CONNECTION: Azur connections</li>\n</ul>\n<p><em>aggregation</em> : metric aggregation, depends of metric </p>\n<ul>\n<li>total: Gets all values in a timerange, and sums it.</li>\n<li>average: presents a mean value in the timerange.</li>\n</ul>\n<p> </p>\n<p>SPECIFIC TIMERANGES (default is 5)</p>\n<p>Use the option <em>-t</em> to define a custom time minute range, in minutes. Example:</p>\n<div class=\"snippet-clipboard-content position-relative\">\n<pre><code>./az_getmonitormetrics.py -m \"cclient-aks-prod,resourcegroup_name,AKS,node_disk_usage_bytes,average\" -t 10\n</code></pre>\n</div>\n<p> </p>\n<p>TODO:</p>\n<ul>\n<li>Aggregate others Azure components <a href=\"https://docs.microsoft.com/pt-br/azure/azure-monitor/essentials/metrics-supported\" rel=\"nofollow\">in the list</a></li>\n<li>AKS: Split metrics by nodes (e.g: node memory, presenting each node separated)</li>\n</ul>\n<p> </p>\n<h3> </h3>\n<h3>Zabbix Template</h3>\n<p> </p>\n<p>To use in Zabbix, follow these instructions:</p>\n<p> </p>\n<ul>\n<li>Copy the files in this repository to external scripts folder (usually /usr/lib/zabbix/externalscripts)</li>\n<li>Install the python libraries with <code>pip install -r requirements.txt</code></li>\n</ul>\n<p> </p>\n<p>In the frontend, include the template <em>zabbix_template_azure.yaml</em> . There will append all Azure templates.</p>\n<ul>\n<li>Create an host and attach the template \"Template - Itens Discovery\"</li>\n</ul>\n<p> </p>\n<p><a href=\"https://github.com/rickkbarbosa/azure-monitor/blob/master/img/template_client.png\" target=\"_blank\" rel=\"noopener noreferrer\"><img style=\"max-width: 100%;\" src=\"https://github.com/rickkbarbosa/azure-monitor/raw/master/img/template_client.png\" alt=\"Screenshot\" /></a></p>\n<p> </p>\n<p>In <em>Macros</em>, put in the values your Azure Service Principal credentials:</p>\n<ul>\n<li>\n<p>AZURE_APP_ID</p>\n</li>\n<li>\n<p> </p>\n<p>AZURE_APP_PASSWORD</p>\n</li>\n<li>\n<p>AZURE_SUBSCRIPTION_ID</p>\n</li>\n<li>\n<p>AZURE_TENANT_ID</p>\n</li>\n<li>\n<p><strong><em>AZURE CLIENT NAME</em> </strong>: This macro exists for Inventory Purposes. The discover will create hosts for each component detected, and add</p>\n</li>\n</ul>", "features": "Zabbix Agent", "address": "", "city": "", "state": "", "country": "", "postcode": "", "telephone": "", "fax": "", "email": "", "website": "https://github.com/rickkbarbosa/azure-monitor", "price": 0, "link_hits": 504, "link_votes": null, "link_rating": 0, "link_featured": null, "link_created": "2021-08-26 20:15:03", "link_modified": "2021-08-26 20:17:37", "link_visited": 74, "publish_up": "2021-08-26 20:15:03", "publish_down": "0000-00-00 00:00:00", "metakey": "", "metadesc": "", "1.8": "", "2.0": "", "2.2": "", "2.4": "", "3.0": "", "3.2": "", "3.4": "", "4.0": "", "4.2": "", "4.4": "", "5.0": "", "5.2": "", "tags": "Azure, Azure Monitor, Cloud, Discovery, Zabbix Azure integration", "author": "Rickk Barbosa", "user_id": 11228, "link_id": 2551, "cat_id": "406", "internal_notes": "", "lat": 0, "lng": 0, "zoom": ""}