{"link_name": "How to use CSV module of Zaf", "type": "Integration", "OS": "", "vendor": "Others", "minZabbVer": "2.2.x", "link_desc": "<p>Do you have lot of devices and you want to monitor them not only physically but from inventory point of view?<br /><br />Do you have CMDB and you want to correlate data from it into Zabbix? Zaf CSV plugin is</p>\n<p>here for you!</p>\n<p><a href=\"https://macura.cz/node/36\">More info at my site</a>.</p>\n<p><br />This example will show how to use this plugin and demonstrate its capabilities.<br /><br />Let us use example CSV file devices.csv which contains data<br /><br />Name,Primary IP,Type,Status,OS,OS Version,Platform<br />host1,1.2.3.4,server,verified,Windows,10,win64<br />host2,2.3.4.5,server,verified,Ubuntu,14.4,linux64<br />host3,2.3.4.6,workstation,verified,Ubuntu,14.4,linux64<br /><br />Format of CSV file is not important because CSV module can select any column of it so it is highly customizable.<br /><br />Now we want to create all this devices in Zabbix. To do so, we have to create auto registration action in Zabbix frontend. Best way how to do it is to use some specific metadata to be able to classify discovered hosts into right groups and templates. You can find more info about hosts autoregistration in Zabbix manual pages. Let us use metadata value \"ZAF\".<br /><br />Now we want to do magic. Zaf csv register will read data from devices.csv and get field 'Name' from it. For each line it will try to register host with name (lowercased) and metadata 'ZAF'. Metadata can be any column too, using some of macros below.<br /><br />zaf install csv<br /><br />zaf csv register<br />Missing arguments!<br />register file.csv delim host metadata<br />host and metadata are strings where:<br />{COLUMN:x} is replaced by value of column x<br />{column:x} is replaced by lowercased value of column x<br />x can be column index (x starts with zero) or header name.<br />CSV must include header line.<br /><br />zaf csv register devices.csv ',' {column:Name} ZAF<br /><br /># To use more sophisticated action, you can prepend hosts with some prefix or append some postfix. Macros are powerful! <br /><br />#zaf csv register devices.csv ',' test_{column:Name} ZAF<br />#zaf csv register devices.csv ',' {column:Name}_postfix ZAF<br /><br />#To use metadata specific per host (to classify by OS)<br />#zaf csv register devices.csv ',' test_{column:Name} 'ZAF:{column:OS}'<br /><br /><br /><br /><br />If autoregistration process is OK, we should see all hosts in Zabbix frontend with needed templates linked in. For our example, you have to define two trapper items for that hosts with name os and platform. Of course you can create your own keys and templates.<br /><br />Next to this, we want to show data generated from CSV suitable for zabbix_sender.<br /><br />zaf csv send<br />Missing arguments!<br />send file.csv delim mode hostfield [item1=field1] [item2=field2] ...<br />mode is stdout or send,<br />hostfield is host for item to send,<br />itemx is key for item to send,<br />fieldx is data to send send,<br />In hostfield, itemx and fieldx are replaced this macros:", "features": "Low Level Discovery (LLD)|Zabbix Agent|Zabbix Agent Active|Zabbix Trapper|Other", "address": "", "city": "", "state": "", "country": "", "postcode": "", "telephone": "", "fax": "", "email": "", "website": "https://macura.cz/node/36", "price": 0, "link_hits": 5704, "link_votes": null, "link_rating": 0, "link_featured": null, "link_created": "2017-01-30 13:59:38", "link_modified": "0000-00-00 00:00:00", "link_visited": 430, "publish_up": "2017-01-30 13:59:38", "publish_down": "0000-00-00 00:00:00", "metakey": "", "metadesc": "", "1.8": "", "2.0": "", "2.2": "", "2.4": "", "3.0": "", "3.2": "", "3.4": "", "4.0": "", "4.2": "", "4.4": "", "5.0": "", "5.2": "", "tags": "", "author": "", "user_id": 186, "link_id": 735, "cat_id": "231", "internal_notes": "", "lat": 0, "lng": 0, "zoom": ""}