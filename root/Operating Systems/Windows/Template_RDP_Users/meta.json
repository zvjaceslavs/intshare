{
    "link_name": "Template RDP Users",
    "type": "Template",
    "OS": "Microsoft Windows",
    "vendor": "",
    "minZabbVer": "2.4.x",
    "link_desc": "<p>RDP Logged on Users</p>\n<p>I use this template to check Users, that are logged on RDP sessions on Windows servers. It's not full audit, it's only for current view of logged-on users.</p>\n<p>Template is really simple.It has only one Item and user parameter configured on monitored server.</p>\n<p>User parameter in zabbix_agentd.conf: UserParameter=RDPUsers,\"c:\\zabbix\\RDPUsers.cmd\" Script RDPUsers.cmd:</p>\n<p>@echo off</p>\n<p>for /F \"usebackq tokens=1,2,3,4,5*\" %%i in (`qwinsta ^| find \"Active\"`) do (</p>\n<p>    if \"%%l\" == \"Active\" ( echo %%j )</p>\n<p>)</p>\n<p>I was asked to enhance script for monitoring disconnected terminal users too. So this is my second version of script. Script adds \"D:\" before name for disconnecter users and \"A: \"for Active users. Script was tested only for English version of Windows server:</p>\n<p>New script RDPUsers.cmd:</p>\n<p>@echo off</p>\n<p>for /F \"usebackq tokens=1,2,3,4,5*\" %%i in (`query user 2^>nul`) do (</p>\n<p>    if \"%%l\" == \"Active\" ( echo A: %%i )</p>\n<p>    if \"%%k\" == \"Disc\" ( echo D: %%i )</p>\n<p>)</p>",
    "features": "Zabbix Agent Active",
    "address": "",
    "city": "",
    "state": "",
    "country": "",
    "postcode": "",
    "telephone": "",
    "fax": "",
    "email": "",
    "website": "",
    "price": 0,
    "link_hits": 30099,
    "link_votes": 1,
    "link_rating": 5,
    "link_featured": null,
    "link_created": "2016-09-07 07:27:14",
    "link_modified": "2018-02-27 12:26:55",
    "link_visited": null,
    "publish_up": "2016-09-07 07:27:14",
    "publish_down": "0000-00-00 00:00:00",
    "metakey": "",
    "metadesc": "",
    "1.8": "",
    "2.0": "",
    "2.2": "",
    "2.4": "",
    "3.0": "RDPUsers_template.xml",
    "3.2": "",
    "3.4": "",
    "4.0": "",
    "4.2": "",
    "4.4": "",
    "5.0": "",
    "5.2": "",
    "tags": "",
    "author": "",
    "user_id": 1003,
    "link_id": 614,
    "cat_id": "180",
    "internal_notes": "",
    "lat": 0,
    "lng": 0,
    "zoom": ""
}