<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2020-05-14T19:30:35Z</date>
    <groups>
        <group>
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template Network Performance Conntrack</template>
            <name>Template Network Performance Conntrack</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Conntrack</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Conntrack delete per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[delete]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of conntrack entries which were removed.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.delete</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack delete_list per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[delete_list]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of conntrack entries which were put to dying list.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.delete_list</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack drop per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[drop]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of packets dropped due to conntrack failure. Either new conntrack entry allocation failed, or protocol helper dropped the packet.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.drop</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack early_drop per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[early_drop]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of dropped conntrack entries to make room for new ones, if maximum table size was reached.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.early_drop</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack entries</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[entries]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <description>Number of entries in conntrack table.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.entries</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack expect_create per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[expect_create]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of expectations added.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.expect_create</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack expect_delete per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[expect_delete]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of expectations deleted.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.expect_delete</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack expect_new per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[expect_new]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of conntrack entries added after an expectation for them was already present.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.expect_new</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack found per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[found]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of searched entries which were successful.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.found</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack icmp_error per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[icmp_error]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of packets which could not be tracked due to error situation. This is a subset of invalid.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.icmp_error</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack ignore per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[ignore]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of packets seen which are already connected to a conntrack entry.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ignore</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack insert per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[insert]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of entries inserted into the list.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.insert</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack insert_failed per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[insert_failed]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of entries for which list insertion was attempted but failed (happens if the same entry is already present).</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.insert_failed</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack invalid per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[invalid]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of packets seen which can not be tracked.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.invalid</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack new per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[new]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of conntrack entries added which were not expected before.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.new</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack searched per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[searched]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of conntrack table lookups performed.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.searched</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack search_restart per second</name>
                    <type>DEPENDENT</type>
                    <key>conntrack_stats[search_restart]</key>
                    <delay>0</delay>
                    <history>7d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>ops</units>
                    <description>Number of conntrack table lookups which had to be restarted due to hashtable resizes.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.search_restart</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>10m</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    </master_item>
                </item>
                <item>
                    <name>Conntrack max</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.run[&quot;/sbin/sysctl -n net.netfilter.nf_conntrack_max&quot;]</key>
                    <delay>1h</delay>
                    <history>1d</history>
                    <trends>90d</trends>
                    <description>Maximum conntrack entries limit configured.</description>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Conntrack stats</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>system.run[&quot;lnstat -jc1 -f nf_conntrack | sed 's/{{/{/g' | sed 's/}}/}/g'&quot;]</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>Conntrack</name>
                        </application>
                    </applications>
                </item>
            </items>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{Template Network Performance Conntrack:conntrack_stats[entries].last()} &gt; {Template Network Performance Conntrack:system.run[&quot;/sbin/sysctl -n net.netfilter.nf_conntrack_max&quot;].last()} * 0.7</expression>
            <name>Conntrack table utilization over 70%</name>
            <priority>AVERAGE</priority>
            <dependencies>
                <dependency>
                    <name>Conntrack table utilization over 80%</name>
                    <expression>{Template Network Performance Conntrack:conntrack_stats[entries].last()} &gt; {Template Network Performance Conntrack:system.run[&quot;/sbin/sysctl -n net.netfilter.nf_conntrack_max&quot;].last()} * 0.8</expression>
                </dependency>
                <dependency>
                    <name>Conntrack table utilization over 90%</name>
                    <expression>{Template Network Performance Conntrack:conntrack_stats[entries].last()} &gt; {Template Network Performance Conntrack:system.run[&quot;/sbin/sysctl -n net.netfilter.nf_conntrack_max&quot;].last()} * 0.9</expression>
                </dependency>
            </dependencies>
        </trigger>
        <trigger>
            <expression>{Template Network Performance Conntrack:conntrack_stats[entries].last()} &gt; {Template Network Performance Conntrack:system.run[&quot;/sbin/sysctl -n net.netfilter.nf_conntrack_max&quot;].last()} * 0.8</expression>
            <name>Conntrack table utilization over 80%</name>
            <priority>HIGH</priority>
            <dependencies>
                <dependency>
                    <name>Conntrack table utilization over 90%</name>
                    <expression>{Template Network Performance Conntrack:conntrack_stats[entries].last()} &gt; {Template Network Performance Conntrack:system.run[&quot;/sbin/sysctl -n net.netfilter.nf_conntrack_max&quot;].last()} * 0.9</expression>
                </dependency>
            </dependencies>
        </trigger>
        <trigger>
            <expression>{Template Network Performance Conntrack:conntrack_stats[entries].last()} &gt; {Template Network Performance Conntrack:system.run[&quot;/sbin/sysctl -n net.netfilter.nf_conntrack_max&quot;].last()} * 0.9</expression>
            <name>Conntrack table utilization over 90%</name>
            <priority>DISASTER</priority>
        </trigger>
    </triggers>
</zabbix_export>
