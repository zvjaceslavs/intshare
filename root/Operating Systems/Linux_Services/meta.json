{"link_name": "Linux Services", "type": "Template", "OS": "RedHat|CentOS|Debian|Ubuntu", "vendor": "", "minZabbVer": "3.4.x", "link_desc": "<p>This script detects processes that are running for a while and presumes that these are services that should be running always. The magic is in the regular expression.<br />The LLD-template will use the JSON-output to create the item proc.num[{#SERVICE}] for each of these processes and a trigger that will check if it is running or not.</p>\n<p>This takes away the need to specify in your template which service is supposed to be running.</p>\n<p>If it detects a service that does not need monitoring you can always disable it. If the service should never be monitored it is better to add these to the \"Global regular expressions\" of Zabbix (or in the script).</p>\n<p><em> <span style=\"color: #1f2c33; font-family: arial, sans-serif; font-size: 12px;\">/etc/zabbix/scripts/service_discovery</span></em></p>\n<p style=\"padding-left: 30px;\"><b>#!/bin/bash</b></p>\n<p style=\"padding-left: 30px;\"><b>TMPDIR=`mktemp -t -d ${0//*\\/}.XXXXXXXXXX`<br /></b></p>\n<p style=\"padding-left: 30px;\"><b>echo '^-</b></p>\n<p style=\"padding-left: 30px;\"><b>^_<br /></b><b>^sleep$<br /></b><b>^qmgr$<br /></b><b>^showq$<br /></b><b>^pickup$<br /></b><b>^pigz$<br /></b><b>^tar$<br /></b><b>^pmm-ras$<br /></b><b>^backupmng$<br /></b><b>^proxymap$<br /></b><b>^cleanup$<br /></b><b>^tlsmgr$<br /></b><b>^anvil$<br /></b><b>^trivial-rewrite$<br /></b><b>^dd$<br /></b><b>^init$<br /></b><b>^php<br /></b><b>^perl$<br /></b><b>^python$<br /></b><b>^lua$<br /></b><b>^sh$<br /></b><b>^bash$<br /></b><b>^auth$<br /></b><b>^login$<br /></b><b>^imap<br /></b><b>^accounts-daemon$<br /></b><b>^config$<br /></b><b>^ssl-params$<br /></b><b>^vlogger$<br /></b><b>^ssh$<br /></b><b>^zabbix_agent<br /></b><b>^systemd<br /></b><b>^proxymap$<br /></b><b>zip$<br /></b><b>^awk$<br /></b><b>^log$<br /></b><b>^run-parts$<br /></b><b>getty$<br /></b><b>^smtp$<br /></b><b>^smtpd$<br /></b><b>^amavisd<br /></b><b>^postgrey<br /></b><b>^pure-ftpd<br /></b><b>^proftpd<br /></b><b>^Passenger<br /></b><b>^qsync<br /></b><b>^qWatchdogd<br /></b><b>^spamd$' >${TMPDIR}/filter</b></p>\n<p style=\"padding-left: 30px;\"><b> </b><b>ps aux | egrep -io '([a-z]+[0-9]+| 20[0-9][0-9]) +[0-9]+:[0-9]+ [A-Za-z0-9/_-]*( |:|$)' | \\<br /></b><b>   sed 's/.*\\///g;s/[ :]$//g;s/.* //g' | grep '[a-z]' | \\<br /></b><b>   grep -vf ${TMPDIR}/filter | sort | uniq >${TMPDIR}/progs</b></p>\n<p style=\"padding-left: 30px;\"><b>if [ -s ${TMPDIR}/progs ] ; then<br /></b><b>  echo -e \"{\\n\\t\\\"data\\\":[\"<br /></b><b>  while read SERVICE ; do<br /></b><b>    [ ${PRINTED} ] && echo \",\"<br /></b><b>    PRINTED=true<br /></b><b>    echo -en \"\\t\\t{ \\\"{#SERVICE}\\\":\\\"${SERVICE}\\\" }\"<br /></b><b>  done <${TMPDIR}/progs<br /></b><b>  echo -e \"\\n\\t]\\n}\"<br /></b><strong>fi</strong><br /><strong>rm -r ${TMPDIR}</strong></p>\n<p> </p>", "features": "Low Level Discovery (LLD)|Zabbix Agent|Custom Script", "address": "", "city": "", "state": "", "country": "", "postcode": "", "telephone": "", "fax": "", "email": "", "website": "", "price": 0, "link_hits": 14808, "link_votes": null, "link_rating": 0, "link_featured": null, "link_created": "2017-12-11 19:35:19", "link_modified": "2017-12-23 12:09:41", "link_visited": null, "publish_up": "2017-12-11 19:35:19", "publish_down": "0000-00-00 00:00:00", "metakey": "", "metadesc": "", "1.8": "", "2.0": "", "2.2": "", "2.4": "", "3.0": "", "3.2": "Template_Linux_Services.xml", "3.4": "", "4.0": "", "4.2": "", "4.4": "", "5.0": "", "5.2": "", "tags": "", "author": "Frater", "user_id": 4268, "link_id": 1022, "cat_id": "113", "internal_notes": "", "lat": 0, "lng": 0, "zoom": ""}