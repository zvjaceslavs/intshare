[
    {
        "proxy_hostid": "0",
        "host": "Template ARP Monitoring",
        "status": "3",
        "disable_until": "0",
        "error": "",
        "available": "0",
        "errors_from": "0",
        "lastaccess": "0",
        "ipmi_authtype": "-1",
        "ipmi_privilege": "2",
        "ipmi_username": "",
        "ipmi_password": "",
        "ipmi_disable_until": "0",
        "ipmi_available": "0",
        "snmp_disable_until": "0",
        "snmp_available": "0",
        "maintenanceid": "0",
        "maintenance_status": "0",
        "maintenance_type": "0",
        "maintenance_from": "0",
        "ipmi_errors_from": "0",
        "snmp_errors_from": "0",
        "ipmi_error": "",
        "snmp_error": "",
        "jmx_disable_until": "0",
        "jmx_available": "0",
        "jmx_errors_from": "0",
        "jmx_error": "",
        "name": "Template ARP Monitoring",
        "flags": "0",
        "templateid": "11239",
        "description": "Rafael Gustavo Gassner 02/2021\r\nThis script activelly scans arp and sends to zabbix server using zabbix_sender.\r\narp-scan should be installed and interfaces variable should\r\n be configured for your environment.\r\nYou will want to run every 10 minutes or so, using crontab.\r\nFirst run(s) might not populate data, since LLD items\r\n are still beeing created in zabbix server.\r\nWith the script and template, you will be able to:\r\n - Detect newly connected devices on the network.\r\n - Have a history of which macs were used by which ips and vice versa.\r\n - Detect if there are multiple ips associated to the same mac.\r\n - Detect if there are multiple macs associated to the same ip address.\r\n - Identify the active period on the network for each device.\r\nSince this is designed for a small environment, the trigger for\r\nnew device has no recovery expression, and should be manually disabled.\r\nYou can configure the \"new device\" trigger disabled for initial run.\r\nAfter that you could disable each trigger mannualy when you have\r\nrecognized the new device as not beeing a rogue one.\r\nIn the zabbix template, \"Allowed hosts\" variable should be configured\r\n for your environment in item prototypes and in discovery rule.",
        "tls_connect": "1",
        "tls_accept": "1",
        "tls_issuer": "",
        "tls_subject": "",
        "tls_psk_identity": "",
        "tls_psk": "",
        "proxy_address": "",
        "auto_compress": "1",
        "parentTemplates": [],
        "items": [],
        "triggers": [],
        "graphs": [],
        "httpTests": [],
        "macros": [],
        "screens": [],
        "discoveries": [
            {
                "itemid": "61154",
                "type": "2",
                "snmp_oid": "",
                "hostid": "11239",
                "name": "Address discovery",
                "key_": "arp.discovery",
                "delay": "0",
                "history": "90d",
                "trends": "0",
                "status": "0",
                "value_type": "4",
                "trapper_hosts": "10.0.0.0/8,192.168.0.0/16,127.0.0.0/8",
                "units": "",
                "logtimefmt": "",
                "templateid": "0",
                "valuemapid": "0",
                "params": "",
                "ipmi_sensor": "",
                "authtype": "0",
                "username": "",
                "password": "",
                "publickey": "",
                "privatekey": "",
                "flags": "1",
                "interfaceid": "0",
                "description": "",
                "inventory_link": "0",
                "lifetime": "30d",
                "jmx_endpoint": "",
                "master_itemid": "0",
                "timeout": "3s",
                "url": "",
                "query_fields": [],
                "posts": "",
                "status_codes": "200",
                "follow_redirects": "1",
                "post_type": "0",
                "http_proxy": "",
                "headers": [],
                "retrieve_mode": "0",
                "request_method": "0",
                "ssl_cert_file": "",
                "ssl_key_file": "",
                "ssl_key_password": "",
                "verify_peer": "0",
                "verify_host": "0",
                "allow_traps": "0",
                "discover": "0",
                "state": "0",
                "error": "",
                "items": [
                    {
                        "itemid": "61155",
                        "type": "2",
                        "snmp_oid": "",
                        "hostid": "11239",
                        "name": "Ip address count for mac {#HWADDRESS}",
                        "key_": "arp.ipCount[{#HWADDRESS}]",
                        "delay": "0",
                        "history": "7d",
                        "trends": "365d",
                        "status": "0",
                        "value_type": "3",
                        "trapper_hosts": "10.0.0.0/8,192.168.0.0/16,127.0.0.0/8",
                        "units": "IP",
                        "formula": "",
                        "logtimefmt": "",
                        "templateid": "0",
                        "valuemapid": "0",
                        "params": "",
                        "ipmi_sensor": "",
                        "authtype": "0",
                        "username": "",
                        "password": "",
                        "publickey": "",
                        "privatekey": "",
                        "flags": "2",
                        "interfaceid": "0",
                        "description": "",
                        "inventory_link": "0",
                        "lifetime": "30d",
                        "evaltype": "0",
                        "jmx_endpoint": "",
                        "master_itemid": "0",
                        "timeout": "3s",
                        "url": "",
                        "query_fields": [],
                        "posts": "",
                        "status_codes": "200",
                        "follow_redirects": "1",
                        "post_type": "0",
                        "http_proxy": "",
                        "headers": [],
                        "retrieve_mode": "0",
                        "request_method": "0",
                        "output_format": "0",
                        "ssl_cert_file": "",
                        "ssl_key_file": "",
                        "ssl_key_password": "",
                        "verify_peer": "0",
                        "verify_host": "0",
                        "allow_traps": "0",
                        "discover": "0"
                    },
                    {
                        "itemid": "61156",
                        "type": "2",
                        "snmp_oid": "",
                        "hostid": "11239",
                        "name": "Mac(s) associated with IP {#IPADDRESS}",
                        "key_": "arp.ipMacs[{#IPADDRESS}]",
                        "delay": "0",
                        "history": "7d",
                        "trends": "0",
                        "status": "0",
                        "value_type": "4",
                        "trapper_hosts": "10.0.0.0/8,192.168.0.0/16,127.0.0.0/8",
                        "units": "",
                        "formula": "",
                        "logtimefmt": "",
                        "templateid": "0",
                        "valuemapid": "0",
                        "params": "",
                        "ipmi_sensor": "",
                        "authtype": "0",
                        "username": "",
                        "password": "",
                        "publickey": "",
                        "privatekey": "",
                        "flags": "2",
                        "interfaceid": "0",
                        "description": "",
                        "inventory_link": "0",
                        "lifetime": "30d",
                        "evaltype": "0",
                        "jmx_endpoint": "",
                        "master_itemid": "0",
                        "timeout": "3s",
                        "url": "",
                        "query_fields": [],
                        "posts": "",
                        "status_codes": "200",
                        "follow_redirects": "1",
                        "post_type": "0",
                        "http_proxy": "",
                        "headers": [],
                        "retrieve_mode": "0",
                        "request_method": "0",
                        "output_format": "0",
                        "ssl_cert_file": "",
                        "ssl_key_file": "",
                        "ssl_key_password": "",
                        "verify_peer": "0",
                        "verify_host": "0",
                        "allow_traps": "0",
                        "discover": "0"
                    },
                    {
                        "itemid": "61157",
                        "type": "2",
                        "snmp_oid": "",
                        "hostid": "11239",
                        "name": "Mac address count for IP {#IPADDRESS}",
                        "key_": "arp.macCount[{#IPADDRESS}]",
                        "delay": "0",
                        "history": "7d",
                        "trends": "365d",
                        "status": "0",
                        "value_type": "3",
                        "trapper_hosts": "10.0.0.0/8,192.168.0.0/16,127.0.0.0/8",
                        "units": "mac",
                        "formula": "",
                        "logtimefmt": "",
                        "templateid": "0",
                        "valuemapid": "0",
                        "params": "",
                        "ipmi_sensor": "",
                        "authtype": "0",
                        "username": "",
                        "password": "",
                        "publickey": "",
                        "privatekey": "",
                        "flags": "2",
                        "interfaceid": "0",
                        "description": "",
                        "inventory_link": "0",
                        "lifetime": "30d",
                        "evaltype": "0",
                        "jmx_endpoint": "",
                        "master_itemid": "0",
                        "timeout": "3s",
                        "url": "",
                        "query_fields": [],
                        "posts": "",
                        "status_codes": "200",
                        "follow_redirects": "1",
                        "post_type": "0",
                        "http_proxy": "",
                        "headers": [],
                        "retrieve_mode": "0",
                        "request_method": "0",
                        "output_format": "0",
                        "ssl_cert_file": "",
                        "ssl_key_file": "",
                        "ssl_key_password": "",
                        "verify_peer": "0",
                        "verify_host": "0",
                        "allow_traps": "0",
                        "discover": "0"
                    },
                    {
                        "itemid": "61158",
                        "type": "2",
                        "snmp_oid": "",
                        "hostid": "11239",
                        "name": "Ip address(es) associated with mac {#HWADDRESS}",
                        "key_": "arp.macIps[{#HWADDRESS}]",
                        "delay": "0",
                        "history": "7d",
                        "trends": "0",
                        "status": "0",
                        "value_type": "4",
                        "trapper_hosts": "10.0.0.0/8,192.168.0.0/16,127.0.0.0/8",
                        "units": "",
                        "formula": "",
                        "logtimefmt": "",
                        "templateid": "0",
                        "valuemapid": "0",
                        "params": "",
                        "ipmi_sensor": "",
                        "authtype": "0",
                        "username": "",
                        "password": "",
                        "publickey": "",
                        "privatekey": "",
                        "flags": "2",
                        "interfaceid": "0",
                        "description": "",
                        "inventory_link": "0",
                        "lifetime": "30d",
                        "evaltype": "0",
                        "jmx_endpoint": "",
                        "master_itemid": "0",
                        "timeout": "3s",
                        "url": "",
                        "query_fields": [],
                        "posts": "",
                        "status_codes": "200",
                        "follow_redirects": "1",
                        "post_type": "0",
                        "http_proxy": "",
                        "headers": [],
                        "retrieve_mode": "0",
                        "request_method": "0",
                        "output_format": "0",
                        "ssl_cert_file": "",
                        "ssl_key_file": "",
                        "ssl_key_password": "",
                        "verify_peer": "0",
                        "verify_host": "0",
                        "allow_traps": "0",
                        "discover": "0"
                    }
                ],
                "triggers": [
                    {
                        "triggerid": "28813",
                        "expression": "{34938}>1 and {34939}=0",
                        "description": "IP  {#IPADDRESS} in use in more than one mac detected by {HOST.HOST} arp table. Adresses found {ITEM.LASTVALUE2}",
                        "url": "",
                        "status": "0",
                        "value": "0",
                        "priority": "1",
                        "lastchange": "0",
                        "comments": "",
                        "error": "",
                        "templateid": "0",
                        "type": "0",
                        "state": "0",
                        "flags": "2",
                        "recovery_mode": "0",
                        "recovery_expression": "",
                        "correlation_mode": "0",
                        "correlation_tag": "",
                        "manual_close": "0",
                        "opdata": "",
                        "discover": "0"
                    },
                    {
                        "triggerid": "28814",
                        "expression": "{34940}>1 and {34941}=0",
                        "description": "Mac  {#HWADDRESS} in use in more than one IP detected by {HOST.HOST} arp table. Adresses found {ITEM.LASTVALUE2}",
                        "url": "",
                        "status": "0",
                        "value": "0",
                        "priority": "1",
                        "lastchange": "0",
                        "comments": "",
                        "error": "",
                        "templateid": "0",
                        "type": "0",
                        "state": "0",
                        "flags": "2",
                        "recovery_mode": "0",
                        "recovery_expression": "",
                        "correlation_mode": "0",
                        "correlation_tag": "",
                        "manual_close": "0",
                        "opdata": "",
                        "discover": "0"
                    },
                    {
                        "triggerid": "28815",
                        "expression": "{34942}<>0",
                        "description": "New device using mac {#HWADDRESS} and IP {#IPADDRESS} detected by {HOST.HOST} arp table.",
                        "url": "",
                        "status": "0",
                        "value": "0",
                        "priority": "1",
                        "lastchange": "0",
                        "comments": "Identify new physical addresses in the same network as your host. Triggers should be disabled mannualy. Recommended to create triggers disabled on the first run.",
                        "error": "",
                        "templateid": "0",
                        "type": "0",
                        "state": "0",
                        "flags": "2",
                        "recovery_mode": "0",
                        "recovery_expression": "",
                        "correlation_mode": "0",
                        "correlation_tag": "",
                        "manual_close": "0",
                        "opdata": "",
                        "discover": "0"
                    }
                ],
                "graphs": [],
                "hostPrototypes": [],
                "filter": {
                    "evaltype": "0",
                    "formula": "",
                    "conditions": [],
                    "eval_formula": ""
                }
            }
        ]
    }
]