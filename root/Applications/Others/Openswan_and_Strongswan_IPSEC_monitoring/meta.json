{"link_name": "Openswan and Strongswan IPSEC monitoring", "type": "Template", "OS": "", "vendor": "Others", "minZabbVer": "2.4.x", "link_desc": "<p>Zabbix template for monitoring Openswan and Strongswan IPSEC connections<br /><br />Written by andre@schild.ws<br /><br />The configuration files and scripts have to be placed in the correct<br />directories as shown in the repository.<br />The locations are for Debian Wheezy with Zabbix 2.4.x installed.<br /><br />######\"Template App IPSEC VPN.xml\"<br />    -> Import this template on your Zabbix server and assign it to your<br />       monitored IPSEC gateways<br /><br />######\"/etc/zabbix/ipsec.conf\"<br />    -> Place this file on your IPSEC gateway and modify it accordingly.<br />       This is the tunnel definition to be monitored.<br />       It is used for autodiscovery.<br /><br />######\"/etc/zabbix/zabbix_agentd.d/ipsec_checks.conf\"<br />    -> Place in the file on your IPSEC gateway no modification needed, <br />       unless you place the external script in another location.<br /><br />######\"/etc/sudoers.d/zabbix_ipsec\"<br />    -> Make sure to have sudo installed on your IPSEC gateway.<br />       The Zabbix agent does not have the required privileges to monitor<br />       the ipsec status. With this sudo config we allow it.<br /><br />######\"/usr/local/lib/zabbix/externalscripts/check_ipsec.sh\"<br />    -> The script doing the actual ipsec tests.<br />       If you place this script in another location, you will have to<br />       change sudoers.d and the zabbix files accordingly<br /><br />######Format of ipsec.conf file:<br /><br />It has to be a valid JSON file, so don't forget the , at the end of the lines<br /><br />```<br />{<br />    \"data\":[<br />        { \"{#TUNNEL}\":\"tunnel1\",\"{#TARGETIP}\":\"192.168.35.1\",\"{#SOURCEIP}\":\"192.168.230.4\",\"{#RTT_TIME_WARN}\":\"80\",\"{#RTT_TIME_ERR}\":\"150\" },<br />        { \"{#TUNNEL}\":\"tunnel2\",\"{#TARGETIP}\":\"172.18.5.1\",\"{#SOURCEIP}\":\"192.168.230.4\",\"{#RTT_TIME_WARN}\":\"80\",\"{#RTT_TIME_ERR}\":\"150\"}<br />        ]<br />}<br />```<br /><br />   #TUNNEL        is the name of your ipsec tunnel,<br />                  it has to match the name used in your ipsec config<br /><br />   #TARGETIP      Use this IP as ping target to check if the tunnel is running<br />                  and for monitoring the RTT<br /><br />   #SOURCEIP      Use this IP as ping source IP to check if the tunnel is running<br />                  and for monitoring the RTT<br />                  Since VPN gateways ususally have multiple interfaces and<br />                  IP addresses assigned, you have to define the source IP<br /><br />   #RTT_TIME_WARN Trigger a warning if the round trip times between <br />                  #SOURCEIP and #TARGETIP are higher than this value<br /><br />   #RTT_TIME_WERR Trigger a error if the round trip times between <br />                  #SOURCEIP and #TARGETIP are higher than this value<br /><br /></p>", "features": "Low Level Discovery (LLD)|Zabbix Agent Active", "address": "", "city": "", "state": "", "country": "", "postcode": "", "telephone": "", "fax": "", "email": "", "website": "https://github.com/a-schild/zabbix-ipsec", "price": 0, "link_hits": 9337, "link_votes": null, "link_rating": 0, "link_featured": null, "link_created": "2016-02-11 18:01:29", "link_modified": "0000-00-00 00:00:00", "link_visited": 1571, "publish_up": "2016-02-11 18:01:29", "publish_down": "0000-00-00 00:00:00", "metakey": "", "metadesc": "", "1.8": "", "2.0": "", "2.2": "", "2.4": "", "3.0": "", "3.2": "", "3.4": "", "4.0": "", "4.2": "", "4.4": "", "5.0": "", "5.2": "", "tags": "ipsec, openswan, strongswan", "author": "Andr\u00e9 Schild", "user_id": 459, "link_id": 428, "cat_id": "124", "internal_notes": "", "lat": 0, "lng": 0, "zoom": ""}