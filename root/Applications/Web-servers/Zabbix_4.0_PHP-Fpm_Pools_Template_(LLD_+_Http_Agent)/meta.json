{"link_name": "Zabbix 4.0 PHP-Fpm Pools Template (LLD + Http Agent)", "type": "Template", "OS": "", "vendor": "Others", "minZabbVer": "4.0.x", "link_desc": "<p>(Check the latest version and updates to this doc at the repo: <span style=\"font-size: 12.16px;\"><a href=\"https://github.com/vigrai/zabbix-template-php-fpm\">https://github.com/vigrai/zabbix-template-php-fpm</a> )</span></p>\n<p># Zabbix 4.0 Template for PHP-FPM Pools</p>\n<p> </p>\n<p>This is a template for monitoring php-fpm and it's pools with [Zabbix](www.zabbix.com).</p>\n<p> </p>\n<p>What's special about this template, is that it *automatically* detects (using LLD) the running php-fpm pools and creates items for measuring metrics from each pool. It uses Http Agent type check in zabbix in order to parse the php status information into useful metrics.</p>\n<p> </p>\n<p>So, if you are running a server with multiple php-fpm pools, this may be a better alternative for monitoring php than other templates available.</p>\n<p> </p>\n<p># Compatibility</p>\n<p> </p>\n<p>This template was tested using:</p>\n<p> </p>\n<p>| Software | Vesion |</p>\n<p>| ------ | ------ |</p>\n<p>| Zabbix Server | 4.0.3 |</p>\n<p>| Debian | Stretch (9.8) |</p>\n<p>| Php-fpm | 7.2 |</p>\n<p> </p>\n<p>It might also work with other combination of versions.</p>\n<p> </p>\n<p># Metrics</p>\n<p> </p>\n<p>This are the metrics created for each php-fpm pool:</p>\n<p> </p>\n<p>![N|Solid](https://github.com/vigrai/zabbix-template-php-fpm/blob/master/img/metrics.png)</p>\n<p> </p>\n<p># Requirements</p>\n<p> </p>\n<p> - Php-status should be enabled in the php-fpm pools.</p>\n<p> - Php-status should be accessible and located in /php-status_POOLNAME for each pool (see step 4 of Setup).</p>\n<p> </p>\n<p># Setup</p>\n<p> </p>\n<p>Even though this template is made with automation in mind, there's still some manual steps to be done in the client (where php-fpm and zabbix-agent are running) in order to get it working:</p>\n<p> </p>\n<p> 1. Clone this template into a temporary directory.</p>\n<p> </p>\n<p>    ```</p>\n<p>    # git clone https://github.com/vigrai/zabbix-template-php-fpm.git /tmp/zabbix-template</p>\n<p>    ```</p>\n<p> </p>\n<p> 2. Put the file `php-fpm.discover_pools.pl` into the /etc/zabbix directory and make it executable.</p>\n<p> </p>\n<p>    ```</p>\n<p>    # cp /tmp/zabbix-template/php-fpm.discover_pools.pl /etc/zabbix</p>\n<p>    # chmod +x /etc/zabbix/php-fpm.discover_pools.pl</p>\n<p>    # chown zabbix.zabbix /etc/zabbix/php-fpm.discover_pools.pl</p>\n<p>    ```</p>\n<p>3. Copy the file userparameter_php-fpm.conf into /etc/zabbix/zabbix_agentd.d.</p>\n<p>    ```</p>\n<p>    # cp /tmp/zabbix-template/userparameter_php-fpm.conf /etc/zabbix/zabbix_agentd.d</p>\n<p>    ```</p>\n<p>4. Make sure that your php-fpm is correctly setup:</p>\n<p> </p>\n<p>     [x] The pools should have php-status enabled.</p>\n<p> </p>\n<p>     [x] Php-status should be available in the path /fpm-status_[NAME-OF-THE-POOL]</p>\n<p> </p>\n<p>     Example configuration file for pool called *nms* (/etc/php/7.2/fpm/pool.d/nms.conf):</p>\n<p> </p>\n<p>     ```[nms]```</p>\n<p>     </p>\n<p>     `", "features": "Low Level Discovery (LLD)|Zabbix Agent|HTTP Agent", "address": "", "city": "", "state": "", "country": "", "postcode": "", "telephone": "", "fax": "", "email": "", "website": "", "price": 0, "link_hits": 4469, "link_votes": null, "link_rating": 0, "link_featured": null, "link_created": "2019-02-20 19:31:53", "link_modified": "0000-00-00 00:00:00", "link_visited": null, "publish_up": "2019-02-20 19:31:53", "publish_down": "0000-00-00 00:00:00", "metakey": "", "metadesc": "", "1.8": "", "2.0": "", "2.2": "", "2.4": "", "3.0": "", "3.2": "", "3.4": "", "4.0": "Zabbix_Template_Php-Fpm.xml", "4.2": "", "4.4": "", "5.0": "", "5.2": "", "tags": "php, php-fpm, pool, pools, lld, http agent", "author": "Fabio Gallese", "user_id": 9245, "link_id": 1559, "cat_id": "119", "internal_notes": "", "lat": 0, "lng": 0, "zoom": ""}