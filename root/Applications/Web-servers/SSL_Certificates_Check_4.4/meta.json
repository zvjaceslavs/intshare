{"link_name": "SSL Certificates Check 4.4", "type": "Template", "OS": "", "vendor": "Others", "minZabbVer": "4.4.x", "link_desc": "<p>This is originally based on http://aperto.fr/cms/en/blog/15-blog-en/15-ssl-certificate-expiration-monitoring-with-zabbix.html with modifications to the script and template by <a href=\"mailto:racooper@tamu.edu\">racooper@tamu.edu</a> and the modifications done by Roman (<a href=\"cat-app/web-servers/ssl-certificates-check\">https://share.zabbix.com/cat-app/web-servers/ssl-certificates-check</a>).</p>\n<p><strong>Installation:</strong></p>\n<p>Download the Zip-file added to this share. Extract the Zip-file. Import the 'zext_ssl_cert_checker.xml' file as a Template in Zabbix (Configuration -> Templates -> Import). Locate you own correct Externalscripts folder by searching for the folder in the zabbix_server.conf file. Copy the 'zext_ssl_cert.sh' to your own Externalscripts folder and make it executable with the 'chmod +x ./zext_ssl_cert.sh' command. Test the template by linking it to a configured host and change the {$SNI} macro to the correct website name like for example 'www.google.nl' or make sure the hostname of the configured host is set to the exact website name. Then enjoy the data from the SSL certificate! ;-)</p>\n<p><strong>Information:</strong></p>\n<p>There is a basic HTTPS down check and trigger. There are no triggers for the issuer check.<br />The basic HTTPS check fires every 90 seconds. Issuer and validity check every 6 hours (21600 seconds). This script is modified with suggestions from the comments at Romans version of the script and to make it as simple as possible. The following macro's are added to tweak the triggers of this template. Especially for certificates from LetsEncrypt is usefull to tweak these macro's:</p>\n<p>{$SNI_TIME_AVG} = Average Trigger (Default value: 14 days)</p>\n<p>{$SNI_TIME_HIGH} = High Trigger (Defaut value: 7 days)</p>\n<p>{$SNI_TIME_INF} = Information Trigger (Default value: 45 days)</p>\n<p>{$SNI_TIME_NC} = Not Classified Trigger (Default value: 60 days)</p>\n<p>{$SNI_TIME_WARN} = Warning Trigger (Default value: 30 days)</p>\n<p>{$SSL_PORT} = SSL port (Default value: 443)</p>\n<p>{$SNI} = Hostname or website name to check (Default value: {HOST.NAME} (Zabbix hostname macro)</p>\n<p><strong>Script usage (for testing at the command line):</strong></p>\n<p>zext_ssl_cert.sh [-i|-d] hostname port (optional: starttls protocol)<br /> -i  Show Issuer\"<br /> -d Show valid days remaining\"</p>\n<p> </p>", "features": "Custom Script", "address": "", "city": "", "state": "", "country": "", "postcode": "", "telephone": "", "fax": "", "email": "", "website": "", "price": 0, "link_hits": 12422, "link_votes": 1, "link_rating": 5, "link_featured": null, "link_created": "2019-12-17 09:02:01", "link_modified": "2019-12-17 09:12:43", "link_visited": null, "publish_up": "2019-12-17 09:02:01", "publish_down": "0000-00-00 00:00:00", "metakey": "", "metadesc": "", "1.8": "", "2.0": "", "2.2": "", "2.4": "", "3.0": "", "3.2": "", "3.4": "", "4.0": "", "4.2": "", "4.4": "zext_ssl_cert_checker.zip", "5.0": "", "5.2": "", "tags": "ssl, check, issuer, https", "author": "Stdnwbeheer", "user_id": 11190, "link_id": 1900, "cat_id": "119", "internal_notes": "", "lat": 0, "lng": 0, "zoom": ""}