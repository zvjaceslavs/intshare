{"link_name": "SSL Certificates Check", "type": "Template", "OS": "", "vendor": "Others", "minZabbVer": "2.2.x", "link_desc": "<div id=\"write\" class=\"is-node\">\n<h1>Zabbix Template: External Website SSL Utilities</h1>\n<h2>References</h2>\n<p>This has been adopted from the great work by <a href=\"owner/github_631895\">Roman</a> on the <a href=\"cat-app/web-servers/ssl-certificates-check\">Zabbix Share</a> site. I wasn't able to get his precise methodology working on my environment, so I split the <code>.sh</code> file out into two separate ones and this is working well for me. <a href=\"owner/github_631895\">Roman's</a> work was based off of <a href=\"owner/github_631895\">racooper@tamu.edu's</a> work that was originally posted <a href=\"http://aperto.fr/cms/en/blog/15-blog-en/15-ssl-certificate-expiration-monitoring-with-zabbix.html\">here</a>.</p>\n<h2>Installation</h2>\n<p><strong>Note:</strong> I've only tested this on Zabbix 3.4.0. I'm not sure if this will work well/at all for any other versions.</p>\n<h3>Zabbix Template</h3>\n<p>Import <code>template_SSL_Cert_Check_External.xml</code> into your Zabbix installation. Assign this profile to required Hosts.</p>\n<h4>Host Requirements</h4>\n<p>Host Name must be the name of the website to be monitored. <em>Ex: <a href=\"www.zabbix.com\" target=\"_blank\">www.zabbix.com</a></em></p>\n<h5>Macros</h5>\n<table>\n<thead>\n<tr><th>Macro</th><th>Default Value</th><th>Description</th></tr>\n</thead>\n<tbody>\n<tr>\n<td>{$SNI}</td>\n<td>{HOSTNAME}</td>\n<td>Allows you to pass a different SNI to <code>openssl</code> on the Zabbix server for site certificate monitoring</td>\n</tr>\n<tr>\n<td>{$SSL_EXPIRY_NOTCLASSIFIED}</td>\n<td>90</td>\n<td>Threshold of remaining days until expiration to throw a trigger of 'Not Classified' severity</td>\n</tr>\n<tr>\n<td>{$SSL_EXPIRY_INFO}</td>\n<td>60</td>\n<td>Threshold of remaining days until expiration to throw a trigger of 'Information' severity</td>\n</tr>\n<tr>\n<td>{$SSL_EXPIRY_AVG}</td>\n<td>30</td>\n<td>Threshold of remaining days until expiration to throw a trigger of 'Average' severity</td>\n</tr>\n<tr>\n<td>{$SSL_EXPIRY_WARN}</td>\n<td>15</td>\n<td>Threshold of remaining days until expiration to throw a trigger of 'Warning' severity</td>\n</tr>\n<tr>\n<td>{$SSL_EXPIRY_HIGH}</td>\n<td>7</td>\n<td>Threshold of remaining days until expiration to throw a trigger of 'High' severity</td>\n</tr>\n<tr>\n<td>{$SSL_HOST}</td>\n<td>{HOSTNAME}</td>\n<td>Hostname (\"Website\") to monitor.</td>\n</tr>\n<tr>\n<td>{$SSL_PORT}</td>\n<td>443</td>\n<td>Port on which to test certificate.</td>\n</tr>\n</tbody>\n</table>\n<h3>Recommended Modifications</h3>\n<p>I strongly recommend modifiying the {$SSL_EXPIRY_*} macros for the sites that you're using <em>LetsEncrypt</em> certificates for as they are much shorter lived and don't renew until they are set to expire in a few weeks <em>(Depending on how you've configured it)</em>.</p>\n<h3> </h3>\n</div>\n<p>External Scripts</p>\n<p>Place <code>zext_ssl_expiry.sh</code> and <code>zext_ssl_issuer.sh</code> into your Zabbix Server's <em>External Scripts</em> folder. <em>(In my i", "features": "Custom Script", "address": "", "city": "", "state": "", "country": "", "postcode": "", "telephone": "", "fax": "", "email": "", "website": "", "price": 0, "link_hits": 44973, "link_votes": 5, "link_rating": 5, "link_featured": null, "link_created": "2017-09-13 12:52:08", "link_modified": "2017-09-25 19:24:40", "link_visited": null, "publish_up": "2017-09-13 12:52:08", "publish_down": "0000-00-00 00:00:00", "metakey": "", "metadesc": "", "1.8": "", "2.0": "", "2.2": "", "2.4": "", "3.0": "", "3.2": "", "3.4": "template_SSL_Detections.zip", "4.0": "", "4.2": "", "4.4": "", "5.0": "", "5.2": "", "tags": "SSL, openssl", "author": "", "user_id": 3383, "link_id": 943, "cat_id": "119", "internal_notes": "", "lat": 0, "lng": 0, "zoom": ""}