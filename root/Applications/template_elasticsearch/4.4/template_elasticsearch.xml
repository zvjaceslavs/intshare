<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.2</version>
    <date>2020-01-06T17:42:38Z</date>
    <groups>
        <group>
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template - App Elasticsearch Cluster new</template>
            <name>Template - App Elasticsearch Cluster new</name>
            <description/>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>ES Cluster</name>
                </application>
                <application>
                    <name>ES Data</name>
                </application>
                <application>
                    <name>ES General status</name>
                </application>
                <application>
                    <name>ES Health</name>
                </application>
                <application>
                    <name>ES JVM Stats</name>
                </application>
                <application>
                    <name>ES Key performance indicators</name>
                </application>
                <application>
                    <name>ES Shards</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Elasticsearch Memory (Average per Node)</name>
                    <type>15</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster.memory[total,pernode]</key>
                    <delay>5m</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>b</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params>last(&quot;elasticsearch.memory[total,cluster]&quot;) / last(&quot;elasticsearch.cluster[number_of_nodes]&quot;)</params>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Total memory (sum of all nodes)</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES General status</name>
                        </application>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Elasticsearch - Number of active primary shards</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[active_primary_shards]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                        <application>
                            <name>ES Shards</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.active_primary_shards</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Number of active shards</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[active_shards]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                        <application>
                            <name>ES Shards</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.active_shards</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch Cluster Health</name>
                    <type>19</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[all,health]</key>
                    <delay>1m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>10s</timeout>
                    <url>{$ELASTICSEARCH_PROTOCOL}://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_cluster/health</url>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Elasticsearch Cluster Global Status</name>
                    <type>19</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[all,stats]</key>
                    <delay>1m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>5s</timeout>
                    <url>{$ELASTICSEARCH_PROTOCOL}://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_cluster/stats</url>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Elasticsearch - Number of data nodes</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[cluster,number_of_data_nodes]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.number_of_data_nodes</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Master instance connection status</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[discovered_master]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Master instance connection status.&#13;
&#13;
Indicates whether data nodes can reach the master node. Failures are usually the result of a network connectivity problem.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Boolean</name>
                    </valuemap>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.discovered_master</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>5</type>
                            <params>true
1</params>
                            <error_handler>3</error_handler>
                            <error_handler_params>0</error_handler_params>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Number of initializing shards</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[initializing_shards]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                        <application>
                            <name>ES Shards</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.initializing_shards</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Cluster Name</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[name]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.cluster_name</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Number of nodes</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[number_of_nodes]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.number_of_nodes</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Number of relocating shards</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[relocating_shards]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                        <application>
                            <name>ES Shards</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.relocating_shards</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Cluster Size</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[size]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units>b</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Total cluster size in bytes</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.indices.store.size_in_bytes</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Cluster Status</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[status]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.status</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Number of unassigned shards</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[unassigned_shards]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                        <application>
                            <name>ES Shards</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.unassigned_shards</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,health]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch Cluster UUID</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cluster[uuid]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                        <application>
                            <name>ES General status</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.cluster_uuid</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch CPU Usage</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.cpu</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>%</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>CPU Usage in percent on Cluster. It checks all node.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Cluster</name>
                        </application>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.nodes.process.cpu.percent</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Deleted documents</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.deleted</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Total Number of Records marked for deletion</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Data</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.indices.docs.deleted</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch Disk Volume</name>
                    <type>19</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.disk[all]</key>
                    <delay>10m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES General status</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>10s</timeout>
                    <url>{$ELASTICSEARCH_PROTOCOL}://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_nodes/stats/fs</url>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Elasticsearch Disk Free (%)</name>
                    <type>15</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.disk[free,percent]</key>
                    <delay>5m</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>%</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params>( last(&quot;elasticsearch.disk[free]&quot;) / last(&quot;elasticsearch.disk[total]&quot;) ) * 100</params>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Free disk volume (in percent)</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES General status</name>
                        </application>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Elasticsearch Disk Volume Free</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.disk[free]</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units>b</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.nodes.fs.total.free_in_bytes</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.disk[all]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch Disk Volume Total</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.disk[total]</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units>b</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.nodes.fs.total.total_in_bytes</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.disk[all]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch Indices Global Status</name>
                    <type>19</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.indices[all,stats]</key>
                    <delay>1m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Indices level stats provide statistics on different operations happening on an index. The API provides statistics on the index level scope (though most stats can also be retrieved using node level scope).&#13;
&#13;
Base for key performance indicator&#13;
&#13;
https://www.elastic.co/guide/en/elasticsearch/reference/6.4/indices-stats.html</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES General status</name>
                        </application>
                        <application>
                            <name>ES Key performance indicators</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>10s</timeout>
                    <url>{$ELASTICSEARCH_PROTOCOL}://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_stats</url>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Elasticsearch JVM Heap (Max)</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.jvm[heap,max]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units>b</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>https://www.elastic.co/guide/en/elasticsearch/reference/current/heap-size.html</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES JVM Stats</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.nodes.jvm.mem.heap_max_in_bytes</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch JVM Heap (Used, Percent)</name>
                    <type>15</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.jvm[heap,usedp]</key>
                    <delay>5m</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>%</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params>(  last(&quot;elasticsearch.jvm[heap,used]&quot;) / last(&quot;elasticsearch.jvm[heap,max]&quot;) ) *100</params>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>https://www.elastic.co/guide/en/elasticsearch/reference/current/heap-size.html</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES JVM Stats</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Elasticsearch JVM Heap (Used, bytes)</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.jvm[heap,used]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units>b</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>https://www.elastic.co/guide/en/elasticsearch/reference/current/heap-size.html</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES JVM Stats</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.nodes.jvm.mem.heap_used_in_bytes</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch JVM Version</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.jvm[version]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES JVM Stats</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.nodes.jvm.versions</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch Memory Free (%)</name>
                    <type>15</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.memory[free,cluster,percentage]</key>
                    <delay>5m</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>%</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params>( last(&quot;elasticsearch.memory[free,cluster]&quot;) / last(&quot;elasticsearch.memory[total,cluster]&quot;) ) * 100</params>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Free memory in cluster (in percent)</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES General status</name>
                        </application>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Elasticsearch Memory Free</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.memory[free,cluster]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>b</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Free memory on cluster (sum of all nodes)</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES General status</name>
                        </application>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.nodes.os.mem.free_in_bytes</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch Memory (Cluster)</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.memory[total,cluster]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>b</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Total memory (sum of all nodes)</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES General status</name>
                        </application>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.nodes.os.mem.total_in_bytes</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Indexing rate</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.performance[index]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>ops/min</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Number of index operations per minute.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                        <application>
                            <name>ES Key performance indicators</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$._all.primaries.indexing.index_total</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>9</type>
                            <params/>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.indices[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Indexing latency (ms)</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.performance[latency,index]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>ms</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Average time that it takes a shard to complete and indexing operation</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                        <application>
                            <name>ES Key performance indicators</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$._all.primaries.indexing.index_time_in_millis</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>10</type>
                            <params/>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.indices[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Search latency (ms)</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.performance[latency,search]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>ms</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Average time that takes a shard to complete a search operation</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                        <application>
                            <name>ES Key performance indicators</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$._all.primaries.search.query_time_in_millis</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>10</type>
                            <params/>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.indices[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch - Search rate</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.performance[search]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>0</value_type>
                    <allowed_hosts/>
                    <units>ops/min</units>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Search operations per minute.</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                        <application>
                            <name>ES Key performance indicators</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$._all.primaries.search.query_total</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>9</type>
                            <params/>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.indices[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Searchable documents</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.records</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Total Number of Records</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Data</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.indices.docs.count</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch Well-done Snapshots in last {$ELASTICSEARCH_SNAPSHOTP_DAYS} days</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.snapshots[ok]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Total snapshots in the last {$ELASTICSEARCH_SNAPSHOTP_DAYS} days that has been succeed</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Boolean</name>
                    </valuemap>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>5</type>
                            <params>,([0-9]+)
\0</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>4</type>
                            <params>,</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.snapshots[stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>ES Snapshot Status</name>
                    <type>19</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.snapshots[stats]</key>
                    <delay>1h</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>A snapshot is a backup taken from a running Elasticsearch cluster.&#13;
&#13;
This presents how many snapshots exists in the last 3 days and how many has been succeed.&#13;
&#13;
https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-snapshots.html</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES General status</name>
                        </application>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>21</type>
                            <params>var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
//Date
var days = {$ELASTICSEARCH_SNAPSHOTP_DAYS}
days = 86400 * days
//daysAgo = 86400 //3 days
const now = new Date()  
const date = (Math.floor(Date.now() / 1000) - daysAgo)  
//Fetch last 3 days
var output = &quot; &quot;;
for (i = 0; i &lt; lines_num; i++)
{
  var line = lines[i].split(&quot; &quot;)[2];
  if (line &gt; date) {
    output = output + &quot;\n&quot; + lines[i];
  }
}//Regex
var re = /SUCCESS/g,
success = 0;
while (re.exec(output) !== null) {
    ++success;
}

var total = output.split(&quot;\n&quot;);
var total = total.length - 1;

result = total + &quot;,&quot; + success;
return result;</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>10s</timeout>
                    <url>{$ELASTICSEARCH_PROTOCOL}://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_cat/snapshots/{$ELASTICSEARCH_SNAPSHOT}</url>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
                <item>
                    <name>Elasticsearch Snapshots in last {$ELASTICSEARCH_SNAPSHOTP_DAYS} days</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.snapshots[total]</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description>Total snapshots in the last 3 days</description>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Boolean</name>
                    </valuemap>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>5</type>
                            <params>^([0-9]+),
\0</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>2</type>
                            <params>,</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.snapshots[stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch version</name>
                    <type>18</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.version</key>
                    <delay>0</delay>
                    <history>1w</history>
                    <trends>0</trends>
                    <status>0</status>
                    <value_type>4</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES General status</name>
                        </application>
                    </applications>
                    <valuemap/>
                    <logtimefmt/>
                    <preprocessing>
                        <step>
                            <type>12</type>
                            <params>$.nodes.versions[0]</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item>
                        <key>elasticsearch.cluster[all,stats]</key>
                    </master_item>
                </item>
                <item>
                    <name>Elasticsearch port listen</name>
                    <type>3</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>net.tcp.service[tcp,{$ELASTICSEARCH_HOST},{$ELASTICSEARCH_PORT}]</key>
                    <delay>1m</delay>
                    <history>1w</history>
                    <trends>365d</trends>
                    <status>0</status>
                    <value_type>3</value_type>
                    <allowed_hosts/>
                    <units/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <description/>
                    <inventory_link>0</inventory_link>
                    <applications>
                        <application>
                            <name>ES Health</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <logtimefmt/>
                    <preprocessing/>
                    <jmx_endpoint/>
                    <timeout>3s</timeout>
                    <url/>
                    <query_fields/>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>1</request_method>
                    <output_format>0</output_format>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <master_item/>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>ES Indexes discovery</name>
                    <type>19</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.discovery.indexes</key>
                    <delay>1m</delay>
                    <status>0</status>
                    <allowed_hosts/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <filter>
                        <evaltype>0</evaltype>
                        <formula/>
                        <conditions>
                            <condition>
                                <macro>{#ELASTICSEARCH_INDEX}</macro>
                                <value>^(?!\s*$).+</value>
                                <operator>8</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-indices.html</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Elasticsearch index full info [ {#ELASTICSEARCH_INDEX} ]</name>
                            <type>19</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.index[all,{#ELASTICSEARCH_INDEX}]</key>
                            <delay>1m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>4</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>ES General status</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>21</type>
                                    <params>var lld = [];
var data = value.split(&quot; &quot;);

var row = {};
row[&quot;ELASTICSEARCH_INDEX_HEALTH&quot;] = data[0];
row[&quot;ELASTICSEARCH_INDEX_STATUS&quot;] = data[1];
row[&quot;ELASTICSEARCH_INDEX_NAME&quot;] = data[2];
row[&quot;ELASTICSEARCH_INDEX_UUID&quot;] = data[3];
row[&quot;ELASTICSEARCH_INDEX_DOCSCOUNT&quot;] = data[6];
row[&quot;ELASTICSEARCH_INDEX_DOCSDELETED&quot;] = data[7];
row[&quot;ELASTICSEARCH_INDEX_SIZE&quot;] = data[8];
row[&quot;ELASTICSEARCH_INDEX_PSIZE&quot;] = data[9];
lld.push(row);
return JSON.stringify(lld);</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                                <step>
                                    <type>5</type>
                                    <params>.*
{&quot;data&quot;:\0</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                                <step>
                                    <type>5</type>
                                    <params>.*
\0}</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>10s</timeout>
                            <url>http://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_cat/indices/{#ELASTICSEARCH_INDEX}</url>
                            <query_fields>
                                <query_field>
                                    <name>bytes</name>
                                    <value>b</value>
                                </query_field>
                            </query_fields>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Indexes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch index documents [ {#ELASTICSEARCH_INDEX} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.index[documents,{#ELASTICSEARCH_INDEX}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>12</type>
                                    <params>$.data[0].ELASTICSEARCH_INDEX_DOCSCOUNT</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Indexes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.index[all,{#ELASTICSEARCH_INDEX}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch index documents deleted [ {#ELASTICSEARCH_INDEX} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.index[documentsdeleted,{#ELASTICSEARCH_INDEX}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>12</type>
                                    <params>$.data[0].ELASTICSEARCH_INDEX_DOCSDELETED</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Indexes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.index[all,{#ELASTICSEARCH_INDEX}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch index health [ {#ELASTICSEARCH_INDEX} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.index[health,{#ELASTICSEARCH_INDEX}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>4</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>12</type>
                                    <params>$.data[0].ELASTICSEARCH_INDEX_HEALTH</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Indexes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.index[all,{#ELASTICSEARCH_INDEX}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch index latency [ {#ELASTICSEARCH_INDEX} ]  (ms)</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.index[latency,{#ELASTICSEARCH_INDEX}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>0</value_type>
                            <allowed_hosts/>
                            <units>ms</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Average time that takes a shard to complete a search operation.&#13;
Specific for a index.</description>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>ES Key performance indicators</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>12</type>
                                    <params>$.indices.{#ELASTICSEARCH_INDEX}.indexing.index_time_in_millis</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                                <step>
                                    <type>10</type>
                                    <params/>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Indexes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.indices[all,stats]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch queries [ {#ELASTICSEARCH_INDEX} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.index[queries,{#ELASTICSEARCH_INDEX}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>0</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Number of queries on this index</description>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>ES Key performance indicators</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>12</type>
                                    <params>$.indices.{#ELASTICSEARCH_INDEX}.search.query_total</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                                <step>
                                    <type>9</type>
                                    <params/>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Indexes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.indices[all,stats]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch index query latency [ {#ELASTICSEARCH_INDEX} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.index[querylatency,{#ELASTICSEARCH_INDEX}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>0</value_type>
                            <allowed_hosts/>
                            <units>ms</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Search time in this index</description>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>ES Key performance indicators</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>12</type>
                                    <params>$.indices.{#ELASTICSEARCH_INDEX}.search.query_time_in_millis</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                                <step>
                                    <type>10</type>
                                    <params/>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Indexes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.indices[all,stats]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch index size [ {#ELASTICSEARCH_INDEX} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.index[size,{#ELASTICSEARCH_INDEX}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>b</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>12</type>
                                    <params>$.data[0].ELASTICSEARCH_INDEX_SIZE</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Indexes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.index[all,{#ELASTICSEARCH_INDEX}]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes/>
                    <graph_prototypes/>
                    <host_prototypes/>
                    <jmx_endpoint/>
                    <timeout>10s</timeout>
                    <url>{$ELASTICSEARCH_PROTOCOL}://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_cat/indices</url>
                    <query_fields>
                        <query_field>
                            <name>h</name>
                            <value>index</value>
                        </query_field>
                    </query_fields>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <lld_macro_paths/>
                    <preprocessing>
                        <step>
                            <type>21</type>
                            <params>
var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#ELASTICSEARCH_INDEX}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>5</type>
                            <params>.*
{&quot;data&quot;:\0</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>5</type>
                            <params>.*
\0}</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <master_item/>
                </discovery_rule>
                <discovery_rule>
                    <name>ES Node discovery</name>
                    <type>19</type>
                    <snmp_community/>
                    <snmp_oid/>
                    <key>elasticsearch.discovery.nodes</key>
                    <delay>1m</delay>
                    <status>0</status>
                    <allowed_hosts/>
                    <snmpv3_contextname/>
                    <snmpv3_securityname/>
                    <snmpv3_securitylevel>0</snmpv3_securitylevel>
                    <snmpv3_authprotocol>0</snmpv3_authprotocol>
                    <snmpv3_authpassphrase/>
                    <snmpv3_privprotocol>0</snmpv3_privprotocol>
                    <snmpv3_privpassphrase/>
                    <params/>
                    <ipmi_sensor/>
                    <authtype>0</authtype>
                    <username/>
                    <password/>
                    <publickey/>
                    <privatekey/>
                    <port/>
                    <filter>
                        <evaltype>0</evaltype>
                        <formula/>
                        <conditions>
                            <condition>
                                <macro>{#ELASTICSEARCH_NODE}</macro>
                                <value>^(?!\s*$).+</value>
                                <operator>8</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-nodes.html</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Elasticsearch full allocation info [ {#ELASTICSEARCH_NODE} ]</name>
                            <type>19</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.node.disk[all,{#ELASTICSEARCH_NODE}]</key>
                            <delay>1m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>4</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Provides a snapshot of the number of shards allocated to each data node and their disk space.&#13;
&#13;
https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-allocation.html</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>1m</timeout>
                            <url>http://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_cat/allocation/{#ELASTICSEARCH_NODE}</url>
                            <query_fields>
                                <query_field>
                                    <name>bytes</name>
                                    <value>b</value>
                                </query_field>
                            </query_fields>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Nodes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch node [ {#ELASTICSEARCH_NODE} ] is master?</name>
                            <type>19</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.node.master[{#ELASTICSEARCH_NODE}]</key>
                            <delay>1m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>4</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Get information about master node.&#13;
https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-master.html</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>5</type>
                                    <params>{#ELASTICSEARCH_NODE}
1</params>
                                    <error_handler>2</error_handler>
                                    <error_handler_params>0</error_handler_params>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>1m</timeout>
                            <url>http://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_cat/master</url>
                            <query_fields>
                                <query_field>
                                    <name>h</name>
                                    <value>node</value>
                                </query_field>
                            </query_fields>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Nodes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch full stats for node [ {#ELASTICSEARCH_NODE} ]</name>
                            <type>19</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.node.query_cache[all,{#ELASTICSEARCH_NODE}]</key>
                            <delay>1m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>4</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>Full stats for specific node as seen on&#13;
https://www.elastic.co/guide/en/elasticsearch/reference/6.2/cluster-nodes-stats.html</description>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>ES General status</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing/>
                            <jmx_endpoint/>
                            <timeout>1m</timeout>
                            <url>http://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_nodes/{#ELASTICSEARCH_NODE}/stats</url>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Nodes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item/>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch CPU Load (1min)  [ {#ELASTICSEARCH_NODE} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.node[cpu1m,{#ELASTICSEARCH_NODE}]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <status>0</status>
                            <value_type>4</value_type>
                            <allowed_hosts/>
                            <units/>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description/>
                            <inventory_link>0</inventory_link>
                            <applications>
                                <application>
                                    <name>ES Health</name>
                                </application>
                            </applications>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>12</type>
                                    <params>$.nodes</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Nodes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.node.query_cache[all,{#ELASTICSEARCH_NODE}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch Storage Total [ {#ELASTICSEARCH_NODE} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.node[disk,{#ELASTICSEARCH_NODE},total]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>3</value_type>
                            <allowed_hosts/>
                            <units>b</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-allocation.html</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>5</type>
                                    <params>(?:(\d+)( )(\d+)( )((\d+|x)\.))
\0</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                                <step>
                                    <type>5</type>
                                    <params>^([0-9]+)
\0</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Nodes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.node.disk[all,{#ELASTICSEARCH_NODE}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch Storage Used (in %) [ {#ELASTICSEARCH_NODE} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.node[disk,{#ELASTICSEARCH_NODE},usedp]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>0</value_type>
                            <allowed_hosts/>
                            <units>%</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-allocation.html</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>5</type>
                                    <params>(?:(\d+)( )(\d+)( )((\d+|x)\.))
\0</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                                <step>
                                    <type>5</type>
                                    <params>(( )[0-9]+)
\0</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Nodes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.node.disk[all,{#ELASTICSEARCH_NODE}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>Elasticsearch Storage Used [ {#ELASTICSEARCH_NODE} ]</name>
                            <type>18</type>
                            <snmp_community/>
                            <snmp_oid/>
                            <key>elasticsearch.node[disk,{#ELASTICSEARCH_NODE},used]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>365d</trends>
                            <status>0</status>
                            <value_type>0</value_type>
                            <allowed_hosts/>
                            <units>b</units>
                            <snmpv3_contextname/>
                            <snmpv3_securityname/>
                            <snmpv3_securitylevel>0</snmpv3_securitylevel>
                            <snmpv3_authprotocol>0</snmpv3_authprotocol>
                            <snmpv3_authpassphrase/>
                            <snmpv3_privprotocol>0</snmpv3_privprotocol>
                            <snmpv3_privpassphrase/>
                            <params/>
                            <ipmi_sensor/>
                            <authtype>0</authtype>
                            <username/>
                            <password/>
                            <publickey/>
                            <privatekey/>
                            <port/>
                            <description>https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-allocation.html</description>
                            <inventory_link>0</inventory_link>
                            <applications/>
                            <valuemap/>
                            <logtimefmt/>
                            <preprocessing>
                                <step>
                                    <type>5</type>
                                    <params>(?:( )(\d+)( )(\d+))
\0</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                                <step>
                                    <type>5</type>
                                    <params>([0-9]+)$
\0</params>
                                    <error_handler>0</error_handler>
                                    <error_handler_params/>
                                </step>
                            </preprocessing>
                            <jmx_endpoint/>
                            <timeout>3s</timeout>
                            <url/>
                            <query_fields/>
                            <posts/>
                            <status_codes>200</status_codes>
                            <follow_redirects>1</follow_redirects>
                            <post_type>0</post_type>
                            <http_proxy/>
                            <headers/>
                            <retrieve_mode>0</retrieve_mode>
                            <request_method>0</request_method>
                            <output_format>0</output_format>
                            <allow_traps>0</allow_traps>
                            <ssl_cert_file/>
                            <ssl_key_file/>
                            <ssl_key_password/>
                            <verify_peer>0</verify_peer>
                            <verify_host>0</verify_host>
                            <application_prototypes>
                                <application_prototype>
                                    <name>ES Nodes</name>
                                </application_prototype>
                            </application_prototypes>
                            <master_item>
                                <key>elasticsearch.node.disk[all,{#ELASTICSEARCH_NODE}]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes/>
                    <graph_prototypes/>
                    <host_prototypes/>
                    <jmx_endpoint/>
                    <timeout>10s</timeout>
                    <url>{$ELASTICSEARCH_PROTOCOL}://{$ELASTICSEARCH_HOST}:{$ELASTICSEARCH_PORT}/_cat/nodes</url>
                    <query_fields>
                        <query_field>
                            <name>h</name>
                            <value>name</value>
                        </query_field>
                    </query_fields>
                    <posts/>
                    <status_codes>200</status_codes>
                    <follow_redirects>1</follow_redirects>
                    <post_type>0</post_type>
                    <http_proxy/>
                    <headers/>
                    <retrieve_mode>0</retrieve_mode>
                    <request_method>0</request_method>
                    <allow_traps>0</allow_traps>
                    <ssl_cert_file/>
                    <ssl_key_file/>
                    <ssl_key_password/>
                    <verify_peer>0</verify_peer>
                    <verify_host>0</verify_host>
                    <lld_macro_paths/>
                    <preprocessing>
                        <step>
                            <type>21</type>
                            <params>
var lld = [];
var lines = value.split(&quot;\n&quot;);
var lines_num = lines.length;
for (i = 0; i &lt; lines_num; i++)
{
  var row = {};
  row[&quot;{#ELASTICSEARCH_NODE}&quot;] = lines[i]
  lld.push(row);
}
return JSON.stringify(lld);</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>5</type>
                            <params>.*
{&quot;data&quot;:\0</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                        <step>
                            <type>5</type>
                            <params>.*
\0}</params>
                            <error_handler>0</error_handler>
                            <error_handler_params/>
                        </step>
                    </preprocessing>
                    <master_item/>
                </discovery_rule>
            </discovery_rules>
            <httptests/>
            <macros>
                <macro>
                    <macro>{$ELASTICSEARCH_HEAPMEM_P2}</macro>
                    <value>75</value>
                </macro>
                <macro>
                    <macro>{$ELASTICSEARCH_HOST}</macro>
                    <value>localhost</value>
                </macro>
                <macro>
                    <macro>{$ELASTICSEARCH_PORT}</macro>
                    <value>9200</value>
                </macro>
                <macro>
                    <macro>{$ELASTICSEARCH_PROTOCOL}</macro>
                    <value>http</value>
                </macro>
                <macro>
                    <macro>{$ELASTICSEARCH_SNAPSHOT}</macro>
                    <value>cs-automated-enc</value>
                </macro>
                <macro>
                    <macro>{$ELASTICSEARCH_SNAPSHOTP_DAYS}</macro>
                    <value>3</value>
                </macro>
            </macros>
            <templates/>
            <screens/>
            <tags/>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{Template - App Elasticsearch Cluster new:elasticsearch.cluster[status].iregexp(green,3)}=0</expression>
            <recovery_mode>1</recovery_mode>
            <recovery_expression>{Template - App Elasticsearch Cluster new:elasticsearch.cluster[status].iregexp(green,3)}=1</recovery_expression>
            <name>[ {HOST.NAME} ] - Elasticsearch Cluster in {ITEM.LASTVALUE} state</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>2</priority>
            <description>The cluster health status is: green, yellow or red. On the shard level, a red status indicates that the specific shard is not allocated in the cluster, yellow means that the primary shard is allocated but replicas are not, and green means that all shards are allocated. The index level status is controlled by the worst shard status. The cluster status is controlled by the worst index status.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies>
                <dependency>
                    <name>[ {HOST.NAME} ] - Elasticsearch Cluster in {ITEM.LASTVALUE} state</name>
                    <expression>{Template - App Elasticsearch Cluster new:elasticsearch.cluster[status].iregexp(green,5)}=0</expression>
                    <recovery_expression>{Template - App Elasticsearch Cluster new:elasticsearch.cluster[status].iregexp(green,3)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template - App Elasticsearch Cluster new:elasticsearch.cluster[status].iregexp(green,5)}=0</expression>
            <recovery_mode>1</recovery_mode>
            <recovery_expression>{Template - App Elasticsearch Cluster new:elasticsearch.cluster[status].iregexp(green,3)}=1</recovery_expression>
            <name>[ {HOST.NAME} ] - Elasticsearch Cluster in {ITEM.LASTVALUE} state</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>3</priority>
            <description>The cluster health status is: green, yellow or red. On the shard level, a red status indicates that the specific shard is not allocated in the cluster, yellow means that the primary shard is allocated but replicas are not, and green means that all shards are allocated. The index level status is controlled by the worst shard status. The cluster status is controlled by the worst index status.</description>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template - App Elasticsearch Cluster new:elasticsearch.jvm[heap,usedp].avg(#3)}&gt;{$ELASTICSEARCH_HEAPMEM_P2}</expression>
            <recovery_mode>0</recovery_mode>
            <recovery_expression/>
            <name>[ {HOST.NAME} ] - Elasticsearch Heap Memory Used is over {$ELASTICSEARCH_HEAPMEM_P2}</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>3</priority>
            <description/>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template - App Elasticsearch Cluster new:elasticsearch.cluster[status].nodata(5m)}=1</expression>
            <recovery_mode>1</recovery_mode>
            <recovery_expression>{Template - App Elasticsearch Cluster new:elasticsearch.cluster[status].nodata(3m)}=0</recovery_expression>
            <name>[ {HOST.NAME} ] - Elasticsearch Monitoring is not collecting data</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>3</priority>
            <description/>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies>
                <dependency>
                    <name>[ {HOST.NAME} ] - Elasticsearch Port is unavailable</name>
                    <expression>{Template - App Elasticsearch Cluster new:net.tcp.service[tcp,{$ELASTICSEARCH_HOST},{$ELASTICSEARCH_PORT}].sum(#3)}=0</expression>
                    <recovery_expression>{Template - App Elasticsearch Cluster new:net.tcp.service[tcp,{$ELASTICSEARCH_HOST},{$ELASTICSEARCH_PORT}].avg(#3)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags/>
        </trigger>
        <trigger>
            <expression>{Template - App Elasticsearch Cluster new:net.tcp.service[tcp,{$ELASTICSEARCH_HOST},{$ELASTICSEARCH_PORT}].sum(#3)}=0</expression>
            <recovery_mode>1</recovery_mode>
            <recovery_expression>{Template - App Elasticsearch Cluster new:net.tcp.service[tcp,{$ELASTICSEARCH_HOST},{$ELASTICSEARCH_PORT}].avg(#3)}=1</recovery_expression>
            <name>[ {HOST.NAME} ] - Elasticsearch Port is unavailable</name>
            <correlation_mode>0</correlation_mode>
            <correlation_tag/>
            <url/>
            <status>0</status>
            <priority>3</priority>
            <description/>
            <type>0</type>
            <manual_close>0</manual_close>
            <dependencies/>
            <tags/>
        </trigger>
    </triggers>
    <value_maps>
        <value_map>
            <name>Boolean</name>
            <mappings>
                <mapping>
                    <value>False</value>
                    <newvalue>0</newvalue>
                </mapping>
                <mapping>
                    <value>false</value>
                    <newvalue>0</newvalue>
                </mapping>
                <mapping>
                    <value>True</value>
                    <newvalue>1</newvalue>
                </mapping>
                <mapping>
                    <value>true</value>
                    <newvalue>1</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
