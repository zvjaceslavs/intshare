{"link_name": "Automatically check DNS Blackhole Lists (DNSBL)", "type": "Template", "OS": "", "vendor": "Others", "minZabbVer": "2.0.x", "link_desc": "<p>If you are providing services like SMTP, DNS or similar to your customers, those services might be misused and you could end up getting your servers IP addresses blacklisted on various <span class=\"body_sub_body\">Domain Name System Blackhole Lists (<a href=\"https://en.wikipedia.org/wiki/DNSBL\">DNSBL</a>).<br /></span></p>\n<p><strong>Requirements</strong></p>\n<ul>\n<li>CentOS/RHEL\n<ul>\n<li>\n<pre># yum install bind-utils</pre>\n</li>\n</ul>\n</li>\n<li>Debian/Ubuntu\n<ul>\n<li>\n<pre># apt-get install dnsutils</pre>\n</li>\n</ul>\n</li>\n</ul>\n<h2><strong>How it works</strong></h2>\n<p>This template utilizes <a href=\"https://www.zabbix.com/documentation/3.0/manual/config/items/itemtypes/external\">External Checks</a>. The script \"check_dnsbl.sh\" is run with parameters for the hostname of the server you wish to check and which DNSBL you wish to check against. It simply returns \"0\" if the server is not listed and \"1\" if it is.</p>\n<p>The template has 5 pre-made items and corresponding triggers. The items should be pretty self-explanatory. Example: check_dnsbl.sh[{HOST.DNS},zen.spamhaus.org]</p>\n<p>You can change the existing DNSBL servers in the template or add your own, although the ones already added should cover most users quite well.</p>\n<p>\"{HOST.DNS}\" is a <a href=\"https://www.zabbix.com/documentation/3.0/manual/config/macros\">macro</a> that uses the DNS name you have specified for your hosts on their interfaces. The script requires the use of DNS names for it to function, however the script and template can be modified to use IP addresses only. I wouldn't recommended this though, since not using host names is bad practice anyway.</p>\n<p>The default DNSBL's used are: b.barracudacentral.org, bl.spamcop.net, cbl.abuseat.org, dnsbl.sorbs.net and zen.spamhaus.org.</p>\n<h2><strong>Disclaimer</strong></h2>\n<p>Verifying if your servers are indeed blacklisted doesn't just require you to initiate a DNS question towards any DNSBL. It requires you to use a <em>reputable</em> one. Otherwise you might end up with false-positives or outdated answers. Always research your DNSBL provider and read through their documentation to find out exactly how they populate and update their database.</p>\n<h2><strong>Instructions - Are your servers Blacklisted?</strong></h2>\n<ol>\n<li>Copy \"check_dnsbl.sh\" to your Zabbix Servers and Proxies and place it in \"/usr/local/share/zabbix/externalscripts\" *\n<ol>\n<li>* Check your server and proxy configuration file for the correct folder, look for the tag \"ExternalScripts\"</li>\n</ol>\n</li>\n<li>Make the script executable: chmod +x /usr/local/share/zabbix/externalscripts/check_dnsbl.sh</li>\n<li>Create the following value map (Administration -> General -> Value mapping: Create value map)\n<ol>\n<li>Name: IP Blacklist<br /> 0 -> Not listed<br /> 1 -> Listed</li>\n</ol>\n</li>\n<li>Import the template and assign it to your host(s).</li>\n</ol>", "features": "Custom Script", "address": "", "city": "", "state": "", "country": "", "postcode": "", "telephone": "", "fax": "", "email": "", "website": "https://zabbix.tips/are-your-servers-blacklisted/", "price": 0, "link_hits": 17718, "link_votes": 1, "link_rating": 5, "link_featured": null, "link_created": "2016-04-08 21:22:16", "link_modified": "2016-04-24 21:23:45", "link_visited": 2482, "publish_up": "2016-04-08 21:22:16", "publish_down": "0000-00-00 00:00:00", "metakey": "", "metadesc": "", "1.8": "", "2.0": "template_ip_blacklist.zip", "2.2": "", "2.4": "", "3.0": "", "3.2": "", "3.4": "", "4.0": "", "4.2": "", "4.4": "", "5.0": "", "5.2": "", "tags": "dns, dnsbl, blacklist, blackhole, spam, external check, spamlist", "author": "Zabbix.tips", "user_id": 527, "link_id": 511, "cat_id": "229", "internal_notes": "", "lat": 0, "lng": 0, "zoom": ""}