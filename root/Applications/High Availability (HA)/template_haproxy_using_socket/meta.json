{"link_name": "HAProxy using socket", "type": "Template", "OS": "", "vendor": "Linux", "minZabbVer": "4.0.x", "link_desc": "\t<p><span class=\"tlid-translation translation\" lang=\"en\">How to install:</span></p>\n<p><span class=\"tlid-translation translation\" lang=\"en\">1. Add in HAProxy (or make sure that you have) next rules to enable statistics on socket</span></p>\n<p><span class=\"tlid-translation translation\" lang=\"en\">vi /etc/haproxy/haproxy.cfg<br />stats socket /var/lib/haproxy/stats  mode 666 level admin<br />stats timeout 30s<br /></span></p>\n<p><span class=\"tlid-translation translation\" lang=\"en\">2. Install socat and nc: yum install nc socat -yum</span></p>\n<p><span class=\"tlid-translation translation\" lang=\"en\">3. Make sure that HAProxy user can read from socket :sudo -uhaproxy echo \"show info;show stat\" | socat stdio unix-connect:/var/lib/haproxy/stats</span></p>\n<p><span class=\"tlid-translation translation\" lang=\"en\">4. Copy files:</span></p>\n<p><span class=\"tlid-translation translation\" lang=\"en\">a) `userparameter_haproxy.conf` in `/etc/zabbix/zabbix_agentd.d/`</span></p>\n<p><span class=\"tlid-translation translation\" lang=\"en\">b) </span><span class=\"tlid-translation translation\" lang=\"en\"><span class=\"tlid-translation translation\" lang=\"en\">haproxy_discovery.sh in </span>/etc/zabbix/scripts/</span></p>\n<p><span class=\"tlid-translation translation\" lang=\"en\">c) haproxy_stats.sh in /etc/zabbix/scripts/<br /><br />Make b and c scripts executable with chmod +x script_name<br /><br />Note: Make sure that /etc/zabbix/scripts/ exist, if not, create it: mkdir -p /etc/zabbix/scripts/<br /><br />5. Add host for HAProxy in Zabbix, add template, wait some time for get data<br /><br />(You can change LLD discovery time to get data more faster, but after change to initial)<br /><br />This template is based on:<br /><br />a) Solution by Anastas Dancha <anapsix@random.io> - https://github.com/anapsix/zabbix-haproxy<br /><br />b) Official template from Zabbix for Zabbix > 4.4 - https://www.zabbix.com/integrations/haproxy<br /><br />The reason why I create this template was to have official zabbix template logic in Zabbix under 4.4<br /><br />Files are there<br /><br />a) https://cloud.mail.ru/public/D2M5%2F7ZEamjnVF<br /><br />b) https://drive.google.com/open?id=16xoJyWut9R_EudcRyAf2Ui8WuPyTxw6D<br /><br />Write to tudorticau@mail.ru if something is not clear<br /><br />Have a nice day</span></p>", "features": "Low Level Discovery (LLD)|Zabbix Agent Active", "address": "", "city": "", "state": "", "country": "", "postcode": "", "telephone": "", "fax": "", "email": "", "website": "", "price": 0, "link_hits": 2097, "link_votes": 3, "link_rating": 5, "link_featured": null, "link_created": "2020-03-26 08:41:34", "link_modified": "2020-07-20 10:52:51", "link_visited": null, "publish_up": "2020-03-26 08:41:34", "publish_down": "0000-00-00 00:00:00", "metakey": "", "metadesc": "", "1.8": "", "2.0": "", "2.2": "", "2.4": "", "3.0": "", "3.2": "", "3.4": "", "4.0": "HAProxy v4.xml", "4.2": "", "4.4": "", "5.0": "", "5.2": "", "tags": "", "author": "Tudor Ticau", "user_id": 11569, "link_id": 2021, "cat_id": "193", "internal_notes": "", "lat": 0, "lng": 0, "zoom": ""}