<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2020-11-03T09:41:30Z</date>
    <groups>
        <group>
            <name>Templates/Network devices</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template Net Cisco Small Business 2.4 and 2.5 SNMPv2</template>
            <name>Template Net Cisco Small Business 2.4 and 2.5 SNMPv2</name>
            <description>Template for Cisco Small Business image 2.4 and 2.5&#13;
&#13;
. To additionally exclude stack and user defined interfaces, create host macro&#13;
.. Macro: {$NET.IF.IFNAME.NOT_MATCHES}&#13;
.. Value: (^Logical-int|^loopback|^[[:digit:]]+$|^stack-port|^User Defined Port)&#13;
.. Description: Logical, loopback, VLAN, stack and user defined interfaces&#13;
&#13;
Tested on 2.4.0.94, 2.4.5.71 and 2.5.0.92&#13;
&#13;
Created by full clone of Net Cisco IOS SNMPv2 then:&#13;
. Unlinked Template Module Cisco CISCO-ENVMON-MIB SNMPv2&#13;
. Unlinked Template Module Cisco CISCO-MEMORY-POOL-MIB SNMPv2&#13;
. Unlinked Template Module Cisco CISCO-PROCESS-MIB SNMPv2&#13;
. Unlinked Template Module Cisco Inventory SNMPv2&#13;
. Unlinked Template Module Generic SNMPv2&#13;
. Linked Template Module ICMP Ping&#13;
. Added Application System&#13;
. Added Items:&#13;
.. SNMP agent availability&#13;
.. System contact&#13;
.. System image&#13;
.. System location&#13;
.. System name&#13;
.. System product ID&#13;
.. System serial number&#13;
.. Uptime&#13;
&#13;
12 Aug 2020&#13;
. Fixed trigger &quot;SNMP agent availability&quot;&#13;
. Fixed trigger &quot;has been restarted&quot;&#13;
. Fixed missing macro $SNMP.TIMEOUT&#13;
&#13;
20 Aug 2020&#13;
. Changed trigger &quot;has been restarted&quot; from Information to Warning&#13;
&#13;
27 Oct 2020&#13;
. Added macro $NET.IF.IFNAME.NOT_MATCHES&#13;
  To exclude Logical, loopback and VLAN interfaces&#13;
&#13;
Known Issues: no CPU, fan or memory items&#13;
&#13;
Template tooling version used: 0.34</description>
            <templates>
                <template>
                    <name>Template Module EtherLike-MIB SNMPv2</name>
                </template>
                <template>
                    <name>Template Module ICMP Ping</name>
                </template>
                <template>
                    <name>Template Module Interfaces SNMPv2</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Network devices</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>System</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>System contact</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.2.1.1.4.0</snmp_oid>
                    <key>system.contact</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System image</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.2.1.47.1.1.1.1.10.67109120</snmp_oid>
                    <key>system.image</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System name</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.2.1.1.5.0</snmp_oid>
                    <key>system.name</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System product ID</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.2.1.47.1.1.1.1.13.67109120</snmp_oid>
                    <key>system.productID</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>System serial number</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.2.1.47.1.1.1.1.11.67109120</snmp_oid>
                    <key>system.serialNo</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1d</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System location</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.2.1.1.6.0</snmp_oid>
                    <key>system.sysLocation</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>System</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Uptime</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>1.3.6.1.2.1.1.3.0</snmp_oid>
                    <key>system.uptime</key>
                    <delay>5m</delay>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.01</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;10m</expression>
                            <name>{HOST.NAME} has been restarted (uptime &lt; 10m)</name>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>No SNMP data collection</name>
                                    <expression>{Template Net Cisco Small Business 2.4 and 2.5 SNMPv2:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SNMP agent availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,snmp,available]</key>
                    <delay>5m</delay>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>zabbix.host.available</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max({$SNMP.TIMEOUT})}=0</expression>
                            <name>No SNMP data collection</name>
                            <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Unavailable by ICMP ping</name>
                                    <expression>{Template Net Cisco Small Business 2.4 and 2.5 SNMPv2:icmpping.max(#3)}=0</expression>
                                </dependency>
                            </dependencies>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$NET.IF.IFNAME.NOT_MATCHES}</macro>
                    <value>(^Logical-int|^loopback|^[[:digit:]]+$)</value>
                    <description>Logical, loopback and VLAN interfaces</description>
                </macro>
                <macro>
                    <macro>{$SNMP.TIMEOUT}</macro>
                    <value>5m</value>
                </macro>
            </macros>
        </template>
    </templates>
    <value_maps>
        <value_map>
            <name>zabbix.host.available</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>not available</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>available</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>unknown</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
