<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2020-10-29T13:50:01Z</date>
    <groups>
        <group>
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template_Sophos XG FW 18 SNMPv2</template>
            <name>Template_Sophos XG FW 18 SNMPv2</name>
            <description>Template for SOPHOS XG (Version 18) series Firewall.&#13;
(Tested on XG260 with Zabbix 5.0)&#13;
Used MIB:&#13;
SFOS-FIREWALL-MIB</description>
            <templates>
                <template>
                    <name>Template Module Generic SNMP</name>
                </template>
                <template>
                    <name>Template Module HOST-RESOURCES-MIB CPU SNMP</name>
                </template>
                <template>
                    <name>Template Module Interfaces SNMP</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Alerts</name>
                </application>
                <application>
                    <name>Inventory</name>
                </application>
                <application>
                    <name>License</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>Services</name>
                </application>
                <application>
                    <name>Statistic</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Service apache status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosApacheService.0</snmp_oid>
                    <key>apacheService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service apache status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Device serial number</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDeviceAppKey.0</snmp_oid>
                    <key>applianceKey</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Device name</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDeviceName.0</snmp_oid>
                    <key>applianceName</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Device type</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDeviceType.0</snmp_oid>
                    <key>applianceType</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Service AS status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosASService.0</snmp_oid>
                    <key>asService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3 and {last()}&lt;&gt;7</expression>
                            <name>Service as status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service AV status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosAVService.0</snmp_oid>
                    <key>avService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service av status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Base license expire date</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosBaseFWLicExpiryDate.0</snmp_oid>
                    <key>baseFWLicExpiryDate</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Base Firewall protection license expiry date.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Base license reg status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosBaseFWLicRegStatus.0</snmp_oid>
                    <key>baseFWLicRegStatus</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <description>Base Firewall protection license status.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType</name>
                    </valuemap>
                </item>
                <item>
                    <name>HA current status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDeviceCurrentHAState.0</snmp_oid>
                    <key>currentHAStatus</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>150d</trends>
                    <description>Textual Convention: HaStatus&#13;
Values: 	notapplicable( 0 ), auxiliary( 1 ), standAlone( 2 ), primary( 3 ), faulty( 4 ), ready ( 5 )</description>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::haStatus</name>
                    </valuemap>
                </item>
                <item>
                    <name>Service database status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDatabaseservice.0</snmp_oid>
                    <key>databaseService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service database status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service Dgd status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDgdService.0</snmp_oid>
                    <key>dgdService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service dgd status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Disk capacity</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDiskCapacity.0</snmp_oid>
                    <key>diskCapacity</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>150d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1048576</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Disk utilization</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDiskPercentUsage.0</snmp_oid>
                    <key>diskPercentUsage</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>150d</trends>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;{$DISK_UTIL_MAX}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{avg(5m)}&lt;({$DISK_UTIL_MAX}-5)</recovery_expression>
                            <name>Disk utilization high</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service dns status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDNSService.0</snmp_oid>
                    <key>dnsService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service dns status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service drouting status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDroutingService.0</snmp_oid>
                    <key>droutingService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service drouting status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Firmware version</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosDeviceFWVersion.0</snmp_oid>
                    <key>firewallVersion</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Version of Intrusion Detection and Prevention (IDP)</description>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Firmware version changed</name>
                            <priority>INFO</priority>
                            <description>Ack to manual close</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service FTP status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosFtpService.0</snmp_oid>
                    <key>ftpService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service ftp status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service garner status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosGarnerService.0</snmp_oid>
                    <key>garnerService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service garner status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>HA mode</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosHAStatus.0</snmp_oid>
                    <key>haMode</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>150d</trends>
                    <description>Textual Convention: HaStatusType&#13;
Values: disabled(0), enabled(1)</description>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::haStatusType</name>
                    </valuemap>
                </item>
                <item>
                    <name>Service HA status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosHAService.0</snmp_oid>
                    <key>haService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3 and {last()}&lt;&gt;0</expression>
                            <name>Service ha status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>HTTP Hits</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosHTTPHits.0</snmp_oid>
                    <key>httpHits</key>
                    <delay>3m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Statistic</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Service HTTP status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosHttpService.0</snmp_oid>
                    <key>httpService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service http status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service IMAP4 status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosImap4Service.0</snmp_oid>
                    <key>imap4Service</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service imap4 status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>IMAP Hits</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosImapHits.0</snmp_oid>
                    <key>imapHits</key>
                    <delay>3m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Statistic</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Service IP-Sec VPN status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosIPSecVpnService.0</snmp_oid>
                    <key>ipSecVpnService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service IP-Sec VPN status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service IPS status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosIPSService.0</snmp_oid>
                    <key>ipsService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service IPS status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>IDS version</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosIPSVersion.0</snmp_oid>
                    <key>ipsVersion</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Version of Intrusion Detection and Prevention (IDP)</description>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Live user count</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosLiveUsersCount.0</snmp_oid>
                    <key>liveUserCount</key>
                    <delay>3m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Statistic</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Mail Protection license expire date</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosMailProtectionLicExpiryDate.0</snmp_oid>
                    <key>mailProtectionLicExpiryDate</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>EMail Protection Iicense Expiry Date.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Mail Protection license reg status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosMailProtectionLicRegStatus.0</snmp_oid>
                    <key>mailProtectionLicRegStatus</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <description>EMail Protection license status.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}=4</expression>
                            <name>Mail Protection license reg status</name>
                            <url>https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&amp;filter_hostids%5B%5D={HOST.ID}&amp;filter_application=License&amp;select=&amp;filter_set=1</url>
                            <priority>AVERAGE</priority>
                            <description>Mail Protection license is expired.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Memory capacity</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosMemoryCapacity.0</snmp_oid>
                    <key>memoryCapacity</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>150d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1048576</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Memory utilization</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosMemoryPercentUsage.0</snmp_oid>
                    <key>memoryPercentUsage</key>
                    <history>45d</history>
                    <trends>150d</trends>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(15m)}&gt;{$MEMORY_UTIL_MAX}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{avg(5m)}&lt;({$MEMORY_UTIL_MAX}-5)</recovery_expression>
                            <name>Memory utilization high</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Network Protection license expire date</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosNetProtectionLicExpiryDate.0</snmp_oid>
                    <key>netProtectionLicExpiryDate</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Network Protection Iicense Expiry Date.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Network Protection reg license status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosNetProtectionLicRegStatus.0</snmp_oid>
                    <key>netProtectionLicRegStatus</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <description>Network Protection registration license status</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}=4</expression>
                            <name>Network Protection reg license status</name>
                            <url>https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&amp;filter_hostids%5B%5D={HOST.ID}&amp;filter_application=License&amp;select=&amp;filter_set=1</url>
                            <priority>AVERAGE</priority>
                            <description>Network Protection reg status is expired.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service network status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosNetworkService.0</snmp_oid>
                    <key>networkService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service network status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service NTP status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosNtpService.0</snmp_oid>
                    <key>ntpService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3 and {last()}&lt;&gt;7</expression>
                            <name>Service ntp status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>POP3 Hits</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosPOP3Hits.0</snmp_oid>
                    <key>pop3Hits</key>
                    <delay>3m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Statistic</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Service POP3 status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB:sfosPoP3Service.0</snmp_oid>
                    <key>pop3Service</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service pop3 status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Sandstrom license expire date</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosSandstromLicExpiryDate.0</snmp_oid>
                    <key>sandstromLicExpiryDate</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Sandstrom Protection Iicense Expiry Date.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Sandstrom license reg status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosSandstromLicRegStatus.0</snmp_oid>
                    <key>sandstromLicRegStatus</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <description>Sandstrom Protection Iicense status.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}=4</expression>
                            <name>Sandstrom license reg status</name>
                            <url>https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&amp;filter_hostids%5B%5D={HOST.ID}&amp;filter_application=License&amp;select=&amp;filter_set=1</url>
                            <priority>AVERAGE</priority>
                            <description>Sandstrom Protection licensereg status is expired.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SMTP Hits</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosSmtpHits.0</snmp_oid>
                    <key>smtpHits</key>
                    <delay>3m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Statistic</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Service SMTP status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosSmtpService.0</snmp_oid>
                    <key>smtpService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service smtp status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service sshd status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosSSHdService.0</snmp_oid>
                    <key>sshdService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3 and {last()}&lt;&gt;0</expression>
                            <name>Service sshd status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service SSL-VPN status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB:sfosSSLVpnService.0</snmp_oid>
                    <key>sslvpnService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3 and {last()}&lt;&gt;7</expression>
                            <name>Service sslvpn status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Swap capacity</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosSwapCapacity.0</snmp_oid>
                    <key>swapCapacity</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>150d</trends>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1048576</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Swap utilization</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosSwapPercentUsage.0</snmp_oid>
                    <key>swapPercentUsage</key>
                    <delay>5m</delay>
                    <history>45d</history>
                    <trends>150d</trends>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;{$SWAP_UTIL_MAX}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{avg(5m)}&lt;({$SWAP_UTIL_MAX}-5)</recovery_expression>
                            <name>Swap utilization high</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Service tomcat status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosTomcatService.0</snmp_oid>
                    <key>tomcatService</key>
                    <delay>5m</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Services</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;&gt;3</expression>
                            <name>Service tomcat status is not running</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Webcat version</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosWebcatVersion.0</snmp_oid>
                    <key>webcatVersion</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Version of Webcat</description>
                    <applications>
                        <application>
                            <name>Inventory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Web Protection license expire date</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosWebProtectionLicExpiryDate.0</snmp_oid>
                    <key>webProtectionLicExpiryDate</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Web Protection license expiry date.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Web Protection license reg status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosWebProtectionLicRegStatus.0</snmp_oid>
                    <key>webProtectionLicRegStatus</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <description>Web Protection registration license status.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}=4</expression>
                            <name>Web Protection license reg status</name>
                            <url>https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&amp;filter_hostids%5B%5D={HOST.ID}&amp;filter_application=License&amp;select=&amp;filter_set=1</url>
                            <priority>AVERAGE</priority>
                            <description>Web Protection license reg staus is expired.</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>WebServer Protection license expire date</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosWebServerProtectionLicExpiryDate.0</snmp_oid>
                    <key>webServerProtectionLicExpiryDate</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>WebServer Protection Iicense Expiry Date.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>WebServer Protection license reg status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SFOS-FIREWALL-MIB::sfosWebServerProtectionLicRegStatus.0</snmp_oid>
                    <key>webServerProtectionLicRegStatus</key>
                    <delay>1h</delay>
                    <history>2w</history>
                    <description>WebServer Protection license status.</description>
                    <applications>
                        <application>
                            <name>License</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}=4</expression>
                            <name>WebServer Protection license reg status</name>
                            <url>https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&amp;filter_hostids%5B%5D={HOST.ID}&amp;filter_application=License&amp;select=&amp;filter_set=1</url>
                            <priority>AVERAGE</priority>
                            <description>WebServer Protection license reg status is expired.</description>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$CPU_UTIL_MAX}</macro>
                    <value>95</value>
                </macro>
                <macro>
                    <macro>{$DISK_UTIL_MAX}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$MEMORY_UTIL_MAX}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$SNMP_COMMUNITY}</macro>
                    <value>public</value>
                </macro>
                <macro>
                    <macro>{$SWAP_UTIL_MAX}</macro>
                    <value>90</value>
                </macro>
            </macros>
            <screens>
                <screen>
                    <name>Network interfaces</name>
                    <hsize>1</hsize>
                    <vsize>1</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>20</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>Interface {#IFNAME}({#IFALIAS}): Network traffic</name>
                                <host>Template_Sophos XG FW 18 SNMPv2</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>25</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
    </templates>
    <value_maps>
        <value_map>
            <name>SOPHOS SFOS-FIREWALL-MIB::haStatus</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>notapplicable</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>auxiliary</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>standAlone</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>primary</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>faulty</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>ready</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>SOPHOS SFOS-FIREWALL-MIB::haStatusType</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>disabled</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>enabled</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>SOPHOS SFOS-FIREWALL-MIB::serviceStatus</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>untouched</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>stopped</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>initializing</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>running</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>exiting</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>dead</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>frozen</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>unregistered</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>trial</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>unsubscribed</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>subscribed</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>expired</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
