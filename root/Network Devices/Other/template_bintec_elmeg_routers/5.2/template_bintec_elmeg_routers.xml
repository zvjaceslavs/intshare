<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.2</version>
    <date>2021-05-28T18:04:38Z</date>
    <groups>
        <group>
            <name>Templates/Network devices</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>bintec Router</template>
            <name>bintec Router</name>
            <description>Template for routers from bintec elmeg

Tested with RS353jv, be.IP plus and R1202</description>
            <templates>
                <template>
                    <name>ICMP Ping</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Templates/Network devices</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>Memory</name>
                </application>
                <application>
                    <name>Network interfaces</name>
                </application>
                <application>
                    <name>PPPoE</name>
                </application>
                <application>
                    <name>SIF</name>
                </application>
                <application>
                    <name>System</name>
                </application>
                <application>
                    <name>VoIP</name>
                </application>
                <application>
                    <name>VPN</name>
                </application>
                <application>
                    <name>xDSL</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>CPU utilization</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.272.4.17.4.1.1.18.1.0</snmp_oid>
                    <key>cpu.utilization</key>
                    <units>%</units>
                    <description>LoadIDLE60s: Percentage of idle time measured for the last 60 seconds.</description>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>return 100 - value</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{last(5m)}&gt;80</expression>
                            <name>High CPU usage</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Flash Memory</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.272.4.17.4.2.1.4.1</snmp_oid>
                    <key>memory.flash</key>
                    <delay>15m</delay>
                    <units>byte</units>
                    <description>Onboard Flash memory</description>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Memory in use</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.272.4.17.4.2.1.5.2</snmp_oid>
                    <key>memory.inuse</key>
                    <units>byte</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Memory total</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.272.4.17.4.2.1.4.2</snmp_oid>
                    <key>memory.total</key>
                    <delay>15m</delay>
                    <units>byte</units>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Memory utilization</name>
                    <type>CALCULATED</type>
                    <key>memory.utilization</key>
                    <units>%</units>
                    <params>100*last(&quot;memory.inuse&quot;)/last(&quot;memory.total&quot;)</params>
                    <applications>
                        <application>
                            <name>Memory</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>return parseInt(value);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{last(5m)}&gt;80</expression>
                            <name>High memory usage</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Current sessions</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.272.4.5.46.1.0</snmp_oid>
                    <key>sif.currsessions</key>
                    <applications>
                        <application>
                            <name>SIF</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Max sessions</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.272.4.5.37.9.0</snmp_oid>
                    <key>sif.maxsessions</key>
                    <delay>1h</delay>
                    <applications>
                        <application>
                            <name>SIF</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>SIF Status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.272.4.5.37.1.0</snmp_oid>
                    <key>sif.status</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Status of the Stateful inspection firewall (SIF)</description>
                    <applications>
                        <application>
                            <name>SIF</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>1</parameter>
                                <parameter>enabled</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>2</parameter>
                                <parameter>disabled</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>System description</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.1.1.0</snmp_oid>
                    <key>system.description</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>HARDWARE</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Software version</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.272.4.1.26.0</snmp_oid>
                    <key>system.swversion</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <inventory_link>OS</inventory_link>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Uptime</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.2.1.1.3.0</snmp_oid>
                    <key>system.uptime</key>
                    <trends>0</trends>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Status</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <parameters>
                                <parameter>0.01</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>xDSL interfaces</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IFID},.1.3.6.1.4.1.272.4.30.1.1.1.1.1]</snmp_oid>
                    <key>dsl.if.discovery</key>
                    <delay>1h</delay>
                    <description>Discover xDSL Interfaces on bintec Router</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>xDSL Downstream Attenuation</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.30.1.1.2.1.8.{#IFID}.0</snmp_oid>
                            <key>xdsl.downstream.attenuation[{#IFID}]</key>
                            <delay>1h</delay>
                            <units>dB</units>
                            <applications>
                                <application>
                                    <name>xDSL</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>0.1</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>xDSL Downstream Max. attainable rate</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.30.1.1.2.1.6.{#IFID}.0</snmp_oid>
                            <key>xdsl.downstream.max[{#IFID}]</key>
                            <delay>1h</delay>
                            <units>bps</units>
                            <description>xDSL Max attainable downstream rate</description>
                            <applications>
                                <application>
                                    <name>xDSL</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>xDSL Downstream</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.16.10.1.24.{#SNMPINDEX}</snmp_oid>
                            <key>xdsl.downstream[{#IFID}]</key>
                            <delay>5m</delay>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>xDSL</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>xDSL Operational Status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.16.10.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>xdsl.operstatus[{#IFID}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>xDSL</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>1</parameter>
                                        <parameter>up</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>2</parameter>
                                        <parameter>down</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}=&quot;down&quot;</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}=&quot;up&quot;</recovery_expression>
                                    <name>DSL interface went down</name>
                                    <priority>HIGH</priority>
                                    <description>The DSL interface is down</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>xDSL Type</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.16.10.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>xdsl.type[{#IFID}]</key>
                            <delay>1h</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>xDSL</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>1</parameter>
                                        <parameter>other</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>2</parameter>
                                        <parameter>adsl</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>3</parameter>
                                        <parameter>shdsl</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>4</parameter>
                                        <parameter>vdsl</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>xDSL Upstream Attenuation</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.30.1.1.3.1.6.{#IFID}.0</snmp_oid>
                            <key>xdsl.upstream.attenuation[{#IFID}]</key>
                            <delay>1h</delay>
                            <units>dB</units>
                            <applications>
                                <application>
                                    <name>xDSL</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>0.1</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>xDSL Upstream Max. attainable rate</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.30.1.1.3.1.9.{#IFID}.0</snmp_oid>
                            <key>xdsl.upstream.max[{#IFID}]</key>
                            <delay>1h</delay>
                            <units>bps</units>
                            <description>Max attainable upstream rate</description>
                            <applications>
                                <application>
                                    <name>xDSL</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>xDSL Upstream</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.16.10.1.25.{#SNMPINDEX}</snmp_oid>
                            <key>xdsl.upstream[{#IFID}]</key>
                            <delay>5m</delay>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>xDSL</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>DSL sync speed</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>FILLED_REGION</drawtype>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>bintec Router</host>
                                        <key>xdsl.downstream[{#IFID}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <drawtype>FILLED_REGION</drawtype>
                                    <color>F63100</color>
                                    <item>
                                        <host>bintec Router</host>
                                        <key>xdsl.upstream[{#IFID}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>VPN License discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#LICID},.1.3.6.1.4.1.272.4.1.32.1.3,{#LICTYPE},.1.3.6.1.4.1.272.4.1.32.1.1,{#LICSTATUS},.1.3.6.1.4.1.272.4.1.32.1.2]</snmp_oid>
                    <key>lic.vpn.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#LICTYPE}</macro>
                                <value>^[33]{2}$</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <name>IPSec Current Connections</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.1.32.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>vpn.ipsec.currconn[{#LICID}]</key>
                            <applications>
                                <application>
                                    <name>VPN</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>IPSec Max Connections</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.1.32.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>vpn.ipsec.maxconn[{#LICID}]</key>
                            <delay>1h</delay>
                            <trends>0</trends>
                            <applications>
                                <application>
                                    <name>VPN</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{bintec Router:vpn.ipsec.currconn[{#LICID}].last()}={bintec Router:vpn.ipsec.maxconn[{#LICID}].last()}</expression>
                            <name>All IPSec connections in use</name>
                            <priority>INFO</priority>
                            <description>All licensed connections are in use!</description>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>VPN License usage</name>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <ymax_type_1>ITEM</ymax_type_1>
                            <ymax_item_1>
                                <host>bintec Router</host>
                                <key>vpn.ipsec.maxconn[{#LICID}]</key>
                            </ymax_item_1>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0040FF</color>
                                    <item>
                                        <host>bintec Router</host>
                                        <key>vpn.ipsec.currconn[{#LICID}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Network interfaces</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IFDESCR},IF-MIB::ifDescr,{#IFTYPE},IF-MIB::ifType,{#IFPHYSADDRESS},IF-MIB::ifPhysAddress,{#IFID},IF-MIB::ifIndex]</snmp_oid>
                    <key>net.if.discovery</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#IFTYPE}</macro>
                                <value>^[1]{1}$</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <name>Incoming traffic on interface {#IFDESCR}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifInOctets[{#IFDESCR}]</key>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Network interfaces</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface {#IFDESCR}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutOctets[{#IFDESCR}]</key>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Network interfaces</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>IP Address {#IFDESCR}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IP-MIB::ipAdEntAddr[&quot;index&quot;,&quot;ipAdEntIfIndex&quot;,{#IFID}]</snmp_oid>
                            <key>network.ip[{#IFDESCR}]</key>
                            <delay>5m</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>Network interfaces</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface {#IFDESCR}</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>bintec Router</host>
                                        <key>ifInOctets[{#IFDESCR}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>bintec Router</host>
                                        <key>ifOutOctets[{#IFDESCR}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>PPPoE Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#PPPOEDESCR},.1.3.6.1.4.1.272.4.24.1.1.15]</snmp_oid>
                    <key>pppoe.discovery</key>
                    <delay>10m</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>PPPoE Age {#PPPOEDESCR}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.24.1.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>pppoe.age[{#PPPOEDESCR}]</key>
                            <units>s</units>
                            <applications>
                                <application>
                                    <name>PPPoE</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>0.01</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>PPPoE State {#PPPOEDESCR}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.24.1.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>pppoe.state[{#PPPOEDESCR}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>PPPoE</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>1</parameter>
                                        <parameter>idle</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>2</parameter>
                                        <parameter>wait-pado</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>3</parameter>
                                        <parameter>wait-padr</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>4</parameter>
                                        <parameter>wait-pads</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>5</parameter>
                                        <parameter>established</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>6</parameter>
                                        <parameter>terminated</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>7</parameter>
                                        <parameter>close</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>8</parameter>
                                        <parameter>delete</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Sensors discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SENSORDESCR},.1.3.6.1.4.1.272.4.17.7.1.1.1.3,{#SENSORTYPE},.1.3.6.1.4.1.272.4.17.7.1.1.1.4,{#SENSORNR},.1.3.6.1.4.1.272.4.17.7.1.1.1.2]</snmp_oid>
                    <key>sensors.discovery</key>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#SENSORDESCR}-Sensor</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.17.7.1.1.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>sensors[{#SENSORID}.{#SENSORDESCR}]</key>
                            <applications>
                                <application>
                                    <name>System</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>{SENSORDESCR}</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0080FF</color>
                                    <item>
                                        <host>bintec Router</host>
                                        <key>sensors[{#SENSORID}.{#SENSORDESCR}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>VoIP Provider Discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#IDX},.1.3.6.1.4.1.272.4.53.3.4.1.1,{#DESCR},.1.3.6.1.4.1.272.4.53.3.4.1.4]</snmp_oid>
                    <key>voip.provider.discovery</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Operational Status VoIP Trunk Line {#DESCR}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.53.3.4.1.15.{#IDX}</snmp_oid>
                            <key>voip.provider.operstat[{#DESCR}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>VoIP</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>1</parameter>
                                        <parameter>not registered</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>2</parameter>
                                        <parameter>registering</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>3</parameter>
                                        <parameter>registered</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>4</parameter>
                                        <parameter>reregistering</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>VPN peers discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#PEERID},.1.3.6.1.4.1.272.4.26.5.1.1,{#PEERDESCR},.1.3.6.1.4.1.272.4.26.5.1.3]</snmp_oid>
                    <key>vpn.peers.discovery</key>
                    <delay>1h</delay>
                    <description>Discover IPSec Peers</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Status of VPN connection {#PEERDESCR}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.272.4.26.28.1.20.{#PEERID}</snmp_oid>
                            <key>vpn.peers.status[{#PEERDESCR}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>VPN</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>1</parameter>
                                        <parameter>up</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>2</parameter>
                                        <parameter>down</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>5</parameter>
                                        <parameter>dormant</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>6</parameter>
                                        <parameter>blocked</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>33</parameter>
                                        <parameter>awaiting callback</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>35</parameter>
                                        <parameter>ip lookup</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>36</parameter>
                                        <parameter>going up</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>37</parameter>
                                        <parameter>wait-if</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>38</parameter>
                                        <parameter>wait-publish</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>39</parameter>
                                        <parameter>wait-localip</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>40</parameter>
                                        <parameter>going-up-trans</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$WANINTERFACE}</macro>
                    <description>The Wan interface</description>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <name>bintec Router Dashboard</name>
                    <widgets>
                        <widget>
                            <type>GRAPH_PROTOTYPE</type>
                            <y>6</y>
                            <width>24</width>
                            <height>20</height>
                            <fields>
                                <field>
                                    <type>INTEGER</type>
                                    <name>columns</name>
                                    <value>3</value>
                                </field>
                                <field>
                                    <type>INTEGER</type>
                                    <name>rows</name>
                                    <value>6</value>
                                </field>
                                <field>
                                    <type>GRAPH_PROTOTYPE</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Traffic on interface {#IFDESCR}</name>
                                        <host>bintec Router</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <x>16</x>
                            <width>8</width>
                            <height>6</height>
                            <fields>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>SIF sessions</name>
                                        <host>bintec Router</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <width>8</width>
                            <height>6</height>
                            <fields>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>CPU utilization</name>
                                        <host>bintec Router</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                        <widget>
                            <type>GRAPH_CLASSIC</type>
                            <x>8</x>
                            <width>8</width>
                            <height>6</height>
                            <fields>
                                <field>
                                    <type>GRAPH</type>
                                    <name>graphid</name>
                                    <value>
                                        <name>Memory usage</name>
                                        <host>bintec Router</host>
                                    </value>
                                </field>
                            </fields>
                        </widget>
                    </widgets>
                </dashboard>
            </dashboards>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{bintec Router:sif.currsessions.last()} &gt;= {bintec Router:sif.maxsessions.last()}*0.8</expression>
            <name>Current sessions reach 80 percent of Max sessions</name>
            <priority>WARNING</priority>
            <description>The sessions counter has reached 80 percent of max sessions value</description>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <name>CPU utilization</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>FF0000</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>bintec Router</host>
                        <key>cpu.utilization</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory usage</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>ITEM</ymax_type_1>
            <ymax_item_1>
                <host>bintec Router</host>
                <key>memory.total</key>
            </ymax_item_1>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>0040FF</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>bintec Router</host>
                        <key>memory.inuse</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>SIF sessions</name>
            <ymax_type_1>ITEM</ymax_type_1>
            <ymax_item_1>
                <host>bintec Router</host>
                <key>sif.maxsessions</key>
            </ymax_item_1>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>FF8000</color>
                    <item>
                        <host>bintec Router</host>
                        <key>sif.currsessions</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
