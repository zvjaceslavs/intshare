<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2020-10-10T08:13:18Z</date>
    <groups>
        <group>
            <name>Templates/Modules</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>MyTemplate Module Linux tcp port status</template>
            <name>MyTemplate Module Linux tcp port status</name>
            <groups>
                <group>
                    <name>Templates/Modules</name>
                </group>
            </groups>
            <discovery_rules>
                <discovery_rule>
                    <name>listen_port_discovery</name>
                    <key>tcp_listen_port.discovery</key>
                    <delay>5m</delay>
                    <lifetime>1d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>port {#LISTENPORT} status</name>
                            <key>port_netstat_status[{#LISTENPORT}]</key>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} CLOSED COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_closed[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.CLOSED</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} CLOSE_WAIT COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_closewait[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.CLOSE_WAIT</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} CLOSING COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_closing[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.CLOSING</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} ESTABLISHED COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_established[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.ESTABLISHED</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} FIN_WAIT1 COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_finwait1[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.FIN_WAIT1</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} FIN_WAIT2 COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_finwait2[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.FIN_WAIT2</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} LAST_ACK COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_lastack[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.LAST_ACK</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} LISTEN COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_listen[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.LISTEN</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} SYN_RECV COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_synrecv[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.SYN_RECV</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} SYN_SENT COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_synsent[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.SYN_SENT</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} TIME_WAIT COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_timewait[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.TIME_WAIT</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>port {#LISTENPORT} UNKNOWN COUNT</name>
                            <type>DEPENDENT</type>
                            <key>tcp_unknown[{#LISTENPORT}]</key>
                            <delay>0</delay>
                            <application_prototypes>
                                <application_prototype>
                                    <name>port {#LISTENPORT}</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.UNKNOWN</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>port_netstat_status[{#LISTENPORT}]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>port {#LISTENPORT} netstat</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_closed[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_closewait[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_closing[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_established[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>FC6EA3</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_finwait1[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>6</sortorder>
                                    <color>6C59DC</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_finwait2[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>7</sortorder>
                                    <color>AC8C14</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_lastack[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>8</sortorder>
                                    <color>611F27</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_listen[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>9</sortorder>
                                    <color>F230E0</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_synrecv[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>10</sortorder>
                                    <color>5CCD18</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_synsent[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>11</sortorder>
                                    <color>BB2A02</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_timewait[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>12</sortorder>
                                    <color>5A2B57</color>
                                    <item>
                                        <host>MyTemplate Module Linux tcp port status</host>
                                        <key>tcp_unknown[{#LISTENPORT}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
    </templates>
</zabbix_export>
