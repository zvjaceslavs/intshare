<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-11-09T08:43:38Z</date>
  <groups>
    <group>
      <name>Templates/Conditioners</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>SBR01</template>
      <name>SBR01</name>
      <description>## Overview This template for **SBR01 air conditioner controller** Template for 3 conditioners, the rest you can add. Because MIB structure not good for low discovery. Protocol SNMP v2 Items 95 with low discovery Graphs 1 **Triggers:** All the air conditioning's stopped Error on conditioner No data on {HOST.NAME} Temperature is above warning threshold in {HOST.NAME} room Template on my [GitHub](https://github.com/pgalonza/Notes/blob/master/administration/zabbix/templates/SBR01.xml) repository MIBs on my [GitHub](https://github.com/pgalonza/Notes/tree/master/administration/sbr01) repository ## Author P.V. Galonza</description>
      <groups>
        <group>
          <name>Templates/Conditioners</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Conditioners</name>
        </application>
        <application>
          <name>System</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Conditioner1 control</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.1.6.0</snmp_oid>
          <key>sbr01.conditioners.conditioner1.autoOn</key>
          <delay>15m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <valuemap>
            <name>SBR01::AutoOn</name>
          </valuemap>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{diff()}&lt;>0</expression>
              <name>Auto ON {ITEM.LASTVALUE} has been changed on conditioner 1</name>
              <status>DISABLED</status>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Conditioner1 uptime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.1.7.0</snmp_oid>
          <key>sbr01.conditioners.conditioner1.coolTime</key>
          <delay>10m</delay>
          <history>30d</history>
          <units>uptime</units>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Сonditioner1 error</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.1.2.0</snmp_oid>
          <key>sbr01.conditioners.conditioner1.error</key>
          <delay>3m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>15m</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{last()}&lt;>0</expression>
              <name>Error on conditioner 1</name>
              <priority>HIGH</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Conditioner1 state</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.1.5.0</snmp_oid>
          <key>sbr01.conditioners.conditioner1.state</key>
          <delay>3m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <valuemap>
            <name>SBR01::State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>15m</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{diff()}&lt;>0</expression>
              <name>Status {ITEM.LASTVALUE} has been changed on conditioner 1</name>
              <status>DISABLED</status>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Conditioner1 temperature IN</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.1.3.0</snmp_oid>
          <key>sbr01.conditioners.conditioner1.tempIn</key>
          <delay>2m</delay>
          <history>30d</history>
          <units>°C</units>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Conditioner1 temperature OUT</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.1.4.0</snmp_oid>
          <key>sbr01.conditioners.conditioner1.tempOut</key>
          <delay>2m</delay>
          <history>30d</history>
          <units>°C</units>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Conditioner2 control</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.2.6.0</snmp_oid>
          <key>sbr01.conditioners.conditioner2.autoOn</key>
          <delay>15m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <valuemap>
            <name>SBR01::AutoOn</name>
          </valuemap>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{diff()}&lt;>0</expression>
              <name>Auto ON {ITEM.LASTVALUE} has been changed on conditioner 2</name>
              <status>DISABLED</status>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Conditioner2 uptime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.2.7.0</snmp_oid>
          <key>sbr01.conditioners.conditioner2.coolTime</key>
          <delay>10m</delay>
          <history>30d</history>
          <units>uptime</units>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Сonditioner2 error</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.2.2.0</snmp_oid>
          <key>sbr01.conditioners.conditioner2.error</key>
          <delay>3m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>15m</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{last()}&lt;>0</expression>
              <name>Error on conditioner 2</name>
              <priority>HIGH</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Conditioner2 state</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.2.5.0</snmp_oid>
          <key>sbr01.conditioners.conditioner2.state</key>
          <delay>3m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <valuemap>
            <name>SBR01::State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>15m</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{diff()}&lt;>0</expression>
              <name>Status {ITEM.LASTVALUE} has been changed on conditioner 2</name>
              <status>DISABLED</status>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Conditioner2 temperature IN</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.2.3.0</snmp_oid>
          <key>sbr01.conditioners.conditioner2.tempIn</key>
          <delay>2m</delay>
          <history>30d</history>
          <units>°C</units>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Conditioner2 temperature OUT</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.2.4.0</snmp_oid>
          <key>sbr01.conditioners.conditioner2.tempOut</key>
          <delay>2m</delay>
          <history>30d</history>
          <units>°C</units>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Conditioner3 control</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.3.6.0</snmp_oid>
          <key>sbr01.conditioners.conditioner3.autoOn</key>
          <delay>15m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <valuemap>
            <name>SBR01::AutoOn</name>
          </valuemap>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{diff()}&lt;>0</expression>
              <name>Auto ON {ITEM.LASTVALUE} has been changed on conditioner 3</name>
              <status>DISABLED</status>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Conditioner3 uptime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.3.7.0</snmp_oid>
          <key>sbr01.conditioners.conditioner3.coolTime</key>
          <delay>10m</delay>
          <history>30d</history>
          <units>uptime</units>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Сonditioner3 error</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.3.2.0</snmp_oid>
          <key>sbr01.conditioners.conditioner3.error</key>
          <delay>3m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>15m</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{last()}&lt;>0</expression>
              <name>Error on conditioner 3</name>
              <priority>HIGH</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Conditioner3 state</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.3.5.0</snmp_oid>
          <key>sbr01.conditioners.conditioner3.state</key>
          <delay>3m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <valuemap>
            <name>SBR01::State</name>
          </valuemap>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>15m</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{diff()}&lt;>0</expression>
              <name>Status {ITEM.LASTVALUE} has been changed on conditioner 3</name>
              <status>DISABLED</status>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Conditioner3 temperature IN</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.3.3.0</snmp_oid>
          <key>sbr01.conditioners.conditioner3.tempIn</key>
          <delay>2m</delay>
          <history>30d</history>
          <units>°C</units>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Conditioner3 temperature OUT</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.2.3.4.0</snmp_oid>
          <key>sbr01.conditioners.conditioner3.tempOut</key>
          <delay>2m</delay>
          <history>30d</history>
          <units>°C</units>
          <applications>
            <application>
              <name>Conditioners</name>
            </application>
          </applications>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Emergency temperature</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.1.4.0</snmp_oid>
          <key>sbr01.system.alarmTemp</key>
          <delay>10m</delay>
          <history>30d</history>
          <units>°C</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>3h</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Error</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.1.1.0</snmp_oid>
          <key>sbr01.system.error</key>
          <delay>15m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Uptime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.1.8.0</snmp_oid>
          <key>sbr01.system.localTimeSec</key>
          <delay>3h</delay>
          <history>30d</history>
          <value_type>FLOAT</value_type>
          <units>uptime</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Count of conditioners in operation</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.1.5.0</snmp_oid>
          <key>sbr01.system.minCondCnt</key>
          <delay>10m</delay>
          <history>30d</history>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>3h</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Rotation time</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.1.6.0</snmp_oid>
          <key>sbr01.system.rotTime</key>
          <delay>10m</delay>
          <history>30d</history>
          <units>h</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>3h</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Activation threshold</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.1.3.0</snmp_oid>
          <key>sbr01.system.setTemp</key>
          <delay>10m</delay>
          <history>30d</history>
          <units>°C</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>3h</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
        </item>
        <item>
          <name>Room temperature</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.1.2.0</snmp_oid>
          <key>sbr01.system.tempRoom</key>
          <delay>2m</delay>
          <history>30d</history>
          <value_type>FLOAT</value_type>
          <units>°C</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <request_method>POST</request_method>
          <triggers>
            <trigger>
              <expression>{nodata(3m)}=1</expression>
              <name>No data on {HOST.NAME}</name>
              <priority>DISASTER</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Error response time</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.47777.1.1.1.7.0</snmp_oid>
          <key>sbr01.system.timeError</key>
          <delay>10m</delay>
          <history>30d</history>
          <units>m</units>
          <applications>
            <application>
              <name>System</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>3h</params>
            </step>
          </preprocessing>
          <request_method>POST</request_method>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>Conditioners</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.4.1.47777.1.1.2]</snmp_oid>
          <key>sbr01.conditioners</key>
          <status>DISABLED</status>
          <item_prototypes>
            <item_prototype>
              <name>Conditioner number</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.47777.1.1.2.3[index,,addr]</snmp_oid>
              <key>sbr01.conditioners.conditioner[{#SNMPINDEX}]</key>
              <delay>30s</delay>
              <applications>
                <application>
                  <name>Conditioners</name>
                </application>
              </applications>
              <request_method>POST</request_method>
            </item_prototype>
          </item_prototypes>
          <request_method>POST</request_method>
        </discovery_rule>
      </discovery_rules>
    </template>
  </templates>
  <triggers>
    <trigger>
      <expression>{SBR01:sbr01.conditioners.conditioner1.state.last()}=3 and {SBR01:sbr01.conditioners.conditioner2.state.last()}=3 and {SBR01:sbr01.conditioners.conditioner3.state.last()}=3</expression>
      <name>All the air conditioning's stopped</name>
      <priority>DISASTER</priority>
    </trigger>
    <trigger>
      <expression>{SBR01:sbr01.system.tempRoom.last()}>{SBR01:sbr01.system.alarmTemp.last()}</expression>
      <name>Temperature is above warning threshold in {HOST.NAME} room</name>
      <priority>HIGH</priority>
    </trigger>
  </triggers>
  <graphs>
    <graph>
      <name>Temperature</name>
      <graph_items>
        <graph_item>
          <drawtype>GRADIENT_LINE</drawtype>
          <color>9999FF</color>
          <item>
            <host>SBR01</host>
            <key>sbr01.system.tempRoom</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>FF3333</color>
          <item>
            <host>SBR01</host>
            <key>sbr01.conditioners.conditioner1.tempIn</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <color>00DD00</color>
          <item>
            <host>SBR01</host>
            <key>sbr01.conditioners.conditioner1.tempOut</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>3</sortorder>
          <color>EE0000</color>
          <item>
            <host>SBR01</host>
            <key>sbr01.conditioners.conditioner2.tempIn</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>4</sortorder>
          <color>00DD00</color>
          <item>
            <host>SBR01</host>
            <key>sbr01.conditioners.conditioner2.tempOut</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>5</sortorder>
          <color>FF3333</color>
          <item>
            <host>SBR01</host>
            <key>sbr01.conditioners.conditioner3.tempIn</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>6</sortorder>
          <color>00DD00</color>
          <item>
            <host>SBR01</host>
            <key>sbr01.conditioners.conditioner3.tempOut</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
  </graphs>
  <value_maps>
    <value_map>
      <name>SBR01::AutoOn</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>manual</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>auto</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>SBR01::State</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>auto</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>cool</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>stop</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>