zabbix_export:
  version: '5.4'
  date: '2021-10-26T04:46:04Z'
  groups:
    -
      uuid: 51be25b0145a4beca811de24a62b5cb4
      name: Kafka
  templates:
    -
      uuid: d2e2fcc6d7c0404c8825cc67e67c4ed9
      template: 'Kafka Connector'
      name: 'Kafka Connector'
      groups:
        -
          name: Kafka
      discovery_rules:
        -
          uuid: 9e6f4b440653480d9ec899d06500a1c1
          name: 'Connector discovery'
          key: connector.discovery
          delay: 5m
          lifetime: '0'
          item_prototypes:
            -
              uuid: 0f3c8b84e7d3413cbbc95a9ec3031c1a
              name: 'State of {#CONNECTOR}  connector'
              key: 'state[{#CONNECTOR}]'
              delay: 5m
              trends: '0'
              value_type: TEXT
              description: |
                Check the state of a Kafka connector.
                Value's PAUSED RUNNING or FAILED.
              tags:
                -
                  tag: Application
                  value: Kafka-Connector
              trigger_prototypes:
                -
                  uuid: fb319aae909844da8783e9b346dd4ddd
                  expression: 'find(/Kafka Connector/state[{#CONNECTOR}],,"like","FAILED")=1'
                  name: 'Kafka Connector {#CONNECTOR} on {HOST.NAME} is FAILED'
                -
                  uuid: ed932821ebec4cbf851523850c64f2a1
                  expression: 'find(/Kafka Connector/state[{#CONNECTOR}],6h,"like","RUNNING")=0 and find(/Kafka Connector/state[{#CONNECTOR}],,"like","FAILED")=1'
                  name: 'Kafka Connector {#CONNECTOR} on {HOST.NAME} is not RUNNING'
                  priority: WARNING
                  description: 'Update this issue to the OC Team'
            -
              uuid: 4c4f4f3c5dc34536aeadb177ded185be
              name: 'State of {#CONNECTOR_ID} task'
              key: 'task[{#CONNECTOR_ID}]'
              delay: 5m
              trends: '0'
              value_type: TEXT
              description: |
                Check the state of a Kafka connector task.
                Value's PAUSED RUNNING or FAILED.
              tags:
                -
                  tag: Application
                  value: Kafka-Connector
              trigger_prototypes:
                -
                  uuid: bfbb72aa14a94669a6771c54473d860c
                  expression: 'find(/Kafka Connector/task[{#CONNECTOR_ID}],,"like","FAILED")=1'
                  name: 'Kafka Connector task {#CONNECTOR_ID} on {HOST.NAME} is FAILED'
                  url: 'http://{#CONNECTOR_ID}'
                  description: |
                    Needed for restart a connector task.
                    NEVER EVER CHANGE URL ABOVE !!
                    Used by remote action "Restart Kafka Connector Task"
                    The conector task should get the state RUNNING.
                  tags:
                    -
                      tag: Kafka
                      value: 'RESTART TASK'
                -
                  uuid: 70cbe231125748389f731f753d6bb715
                  expression: 'find(/Kafka Connector/task[{#CONNECTOR_ID}],6h,"like","RUNNING")=0 and find(/Kafka Connector/task[{#CONNECTOR_ID}],,"like","FAILED")=1'
                  name: 'Kafka Connector task {#CONNECTOR_ID} on {HOST.NAME} is not RUNNING'
                  priority: WARNING
                  description: 'Update this issue to the OC Team'
