<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export><version>5.0</version><date>2021-11-21T21:52:56Z</date><groups><group><name>Exchange Servers</name></group></groups><templates><template><template>Microsoft Exchange Server 2016 - Services</template><name>Microsoft Exchange Server 2016 - Services</name><description>## Overview


```
The &quot;Exchange 2016 - Services&quot; is mostly used to restart critical services by using &quot;ACTIONS&quot; and has discovery rules (Which Are Disabled by Default)

This template is based on using the {EVENT.TAGS} as a execute command within Actions.
(Note: The whole Trigger will execute all alerts and do with them as you specify but independently execute based on 5m run-times)
So if there are three (3) services out, it may take fifteen (15) to twenty (20) mins to restart them.


To create an &quot;ACTION&quot; do the following.

Add &quot;All Services&quot; and tag them as (Trigger equals XXX)

See Example: Trigger equals Template Microsoft Exchange Server 2016 - Services: Service: MSExchangeUMCR on Template Microsoft Exchange Server 2016 - Services

If done correctly, you will have A~AE Trigger equals, about (31 Objects)

Once done, under &quot;Operations&quot; to Execute a command on the windows server use the following configuration.

Operation Type: Remote Command (Note: Zabbix Agent must be set to &quot;Allow Remote Commands)
Target list: Current Host
Type: Custom Script
Execute on: Zabbix Agent
Commands: net start {EVENT.TAGS}

Yes, it a &quot;Vague&quot; tutorial (Sorry)
```


## Author

Route Packets

</description><groups><group><name>Exchange Servers</name></group></groups><applications><application><name>Exchange 2016 Client Access</name></application><application><name>Exchange 2016 Mailbox</name></application><application><name>Exchange 2016 Transport</name></application></applications><items><item><name>Service Status Microsoft Exchange Search Host Controller</name><key>service_state[HostControllerService]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: HostControllerService on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>HIGH</priority><tags><tag><tag>HostControllerService</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Compliance Audit</name><key>service_state[MSComplianceAudit]</key><delay>5m</delay><applications><application><name>Exchange 2016 Transport</name></application></applications><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSComplianceAudit on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>INFO</priority><tags><tag><tag>MSComplianceAudit</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Active Directory Topology</name><key>service_state[MSExchangeADTopology]</key><delay>5m</delay><applications><application><name>Exchange 2016 Client Access</name></application><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeADTopology on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>AVERAGE</priority><tags><tag><tag>MSExchangeADTopology</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Anti-spam update</name><key>service_state[MSExchangeAntispamUpdate]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeAntispamUpdate on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>WARNING</priority><tags><tag><tag>MSExchangeAntispamUpdate</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Compliance Service</name><key>service_state[MSExchangeCompliance]</key><delay>5m</delay><applications><application><name>Exchange 2016 Transport</name></application></applications><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeCompliance on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>WARNING</priority><tags><tag><tag>MSExchangeCompliance</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange DAG Management</name><key>service_state[MSExchangeDagMgmt]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeDagMgmt on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>DISASTER</priority><tags><tag><tag>MSExchangeDagMgmt</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Transport Delivery</name><key>service_state[MSExchangeDelivery]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeDelivery on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>DISASTER</priority><tags><tag><tag>MSExchangeDelivery</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Diagnostics</name><key>service_state[MSExchangeDiagnostics]</key><delay>5m</delay><applications><application><name>Exchange 2016 Client Access</name></application><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeDiagnostics on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>AVERAGE</priority><tags><tag><tag>MSExchangeDiagnostics</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange EdgeSync</name><key>service_state[MSExchangeEdgeSync]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeEdgeSync on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>WARNING</priority><tags><tag><tag>MSExchangeEdgeSync</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Search</name><key>service_state[MSExchangeFastSearch]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeFastSearch on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>HIGH</priority><tags><tag><tag>MSExchangeFastSearch</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Frontend Transport</name><key>service_state[MSExchangeFrontEndTransport]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(,0)}&lt;&gt;0</expression><name>Service: MSExchangeFrontEndTransport on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>HIGH</priority><tags><tag><tag>MSExchangeFrontEndTransport</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Health Manager Recovery</name><key>service_state[MSExchangeHMRecovery]</key><applications><application><name>Exchange 2016 Client Access</name></application><application><name>Exchange 2016 Mailbox</name></application></applications><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeHMRecovery on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>DISASTER</priority><tags><tag><tag>MSExchangeHMRecovery</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Health Manager</name><key>service_state[MSExchangeHM]</key><delay>5m</delay><applications><application><name>Exchange 2016 Client Access</name></application><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeHM on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>HIGH</priority><tags><tag><tag>MSExchangeHM</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange IMAP4 Backend</name><key>service_state[MSExchangeIMAP4BE]</key><delay>5m</delay><applications><application><name>Exchange 2016 Client Access</name></application></applications><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeIMAP4BE on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>DISASTER</priority><tags><tag><tag>MSExchangeIMAP4BE</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange IMAP4</name><key>service_state[MSExchangeImap4]</key><delay>5m</delay><applications><application><name>Exchange 2016 Client Access</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeImap4 on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>HIGH</priority><tags><tag><tag>MSExchangeImap4</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Information Store</name><key>service_state[MSExchangeIS]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeIS on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>DISASTER</priority><tags><tag><tag>MSExchangeIS</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Mailbox Assistants</name><key>service_state[MSExchangeMailboxAssistants]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeMailboxAssistants on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>AVERAGE</priority><tags><tag><tag>MSExchangeMailboxAssistants</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Mailbox Replication</name><key>service_state[MSExchangeMailboxReplication]</key><delay>5m</delay><applications><application><name>Exchange 2016 Client Access</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeMailboxReplication on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>AVERAGE</priority><tags><tag><tag>MSExchangeMailboxReplication</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Notifications Broker</name><key>service_state[MSExchangeNotificationsBroker]</key><delay>5m</delay><status>DISABLED</status><applications><application><name>Exchange 2016 Client Access</name></application><application><name>Exchange 2016 Mailbox</name></application><application><name>Exchange 2016 Transport</name></application></applications><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeNotificationsBroker on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><status>DISABLED</status><priority>WARNING</priority><tags><tag><tag>MSExchangeNotificationsBroker</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange POP3 Backend</name><key>service_state[MSExchangePOP3BE]</key><delay>5m</delay><applications><application><name>Exchange 2016 Client Access</name></application></applications><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangePOP3BE on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>DISASTER</priority><tags><tag><tag>MSExchangePOP3BE</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange POP3</name><key>service_state[MSExchangePop3]</key><delay>5m</delay><applications><application><name>Exchange 2016 Client Access</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangePop3 on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>HIGH</priority><tags><tag><tag>MSExchangePop3</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Replication</name><key>service_state[MSExchangeRepl]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeRepl on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>AVERAGE</priority><tags><tag><tag>MSExchangeRepl</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange RPC Client Access</name><key>service_state[MSExchangeRPC]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeRPC on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>AVERAGE</priority><tags><tag><tag>MSExchangeRPC</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Service Host</name><key>service_state[MSExchangeServiceHost]</key><delay>5m</delay><applications><application><name>Exchange 2016 Client Access</name></application><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeServiceHost on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>AVERAGE</priority><tags><tag><tag>MSExchangeServiceHost</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Transport Submission</name><key>service_state[MSExchangeSubmission]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeSubmission on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>DISASTER</priority><tags><tag><tag>MSExchangeSubmission</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Throttling</name><key>service_state[MSExchangeThrottling]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeThrottling on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>AVERAGE</priority><tags><tag><tag>MSExchangeThrottling</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Transport Log Search</name><key>service_state[MSExchangeTransportLogSearch]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeTransportLogSearch on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>AVERAGE</priority><tags><tag><tag>MSExchangeTransportLogSearch</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Transport</name><key>service_state[MSExchangeTransport]</key><delay>5m</delay><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeTransport on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><priority>DISASTER</priority><tags><tag><tag>MSExchangeTransport</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Unified Messaging Call Router</name><key>service_state[MSExchangeUMCR]</key><delay>5m</delay><status>DISABLED</status><applications><application><name>Exchange 2016 Client Access</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeUMCR on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><status>DISABLED</status><priority>AVERAGE</priority><tags><tag><tag>MSExchangeUMCR</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Unified Messaging</name><key>service_state[MSExchangeUM]</key><delay>5m</delay><status>DISABLED</status><applications><application><name>Exchange 2016 Mailbox</name></application></applications><request_method>POST</request_method><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: MSExchangeUM on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><status>DISABLED</status><priority>AVERAGE</priority><tags><tag><tag>MSExchangeUM</tag></tag></tags></trigger></triggers></item><item><name>Service Status Microsoft Exchange Server Extension for Windows Server Backup</name><key>service_state[wsbexchange]</key><status>DISABLED</status><applications><application><name>Exchange 2016 Mailbox</name></application></applications><triggers><trigger><expression>{last(0)}&lt;&gt;0</expression><name>Service: wsbexchange on {HOST.NAME}</name><opdata>{EVENT.TAGS}</opdata><status>DISABLED</status><priority>AVERAGE</priority><tags><tag><tag>wsbexchange</tag></tag></tags></trigger></triggers></item></items><discovery_rules><discovery_rule><name>{#SERVICE.NAME}</name><key>service_state</key><item_prototypes><item_prototype><name>State of service &quot;{#SERVICE.NAME}&quot; ({#SERVICE.DISPLAYNAME})</name><key>service_state[{#SERVICE.NAME},state]</key><history>1w</history><applications><application><name>Exchange 2016 Client Access</name></application><application><name>Exchange 2016 Mailbox</name></application><application><name>Exchange 2016 Transport</name></application></applications><valuemap><name>Windows service state</name></valuemap><trigger_prototypes><trigger_prototype><expression>{last()}&lt;&gt;0</expression><recovery_mode>RECOVERY_EXPRESSION</recovery_mode><recovery_expression>{last()}&lt;&gt;0</recovery_expression><name>{#SERVICE.DISPLAYNAME} ({#SERVICE.NAME}) {#SERVICE.STATENAME} on {HOST.NAME} and be able to extract {#SERVICE.NAME} from it</name><status>DISABLED</status><manual_close>YES</manual_close><tags><tag><tag>{#SERVICE.NAME}</tag></tag></tags></trigger_prototype></trigger_prototypes></item_prototype></item_prototypes></discovery_rule></discovery_rules></template></templates><value_maps><value_map><name>Windows service state</name><mappings><mapping><value>0</value><newvalue>Running</newvalue></mapping><mapping><value>1</value><newvalue>Paused</newvalue></mapping><mapping><value>2</value><newvalue>Start pending</newvalue></mapping><mapping><value>3</value><newvalue>Pause pending</newvalue></mapping><mapping><value>4</value><newvalue>Continue pending</newvalue></mapping><mapping><value>5</value><newvalue>Stop pending</newvalue></mapping><mapping><value>6</value><newvalue>Stopped</newvalue></mapping><mapping><value>7</value><newvalue>Unknown</newvalue></mapping><mapping><value>255</value><newvalue>No such service</newvalue></mapping></mappings></value_map></value_maps></zabbix_export>
