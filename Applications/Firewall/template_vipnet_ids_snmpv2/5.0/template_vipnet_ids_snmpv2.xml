<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-19T21:24:02Z</date>
  <groups>
    <group>
      <name>Templates</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>ViPNet IDS SNMPv2 template</template>
      <name>ViPNet IDS SNMPv2 template</name>
      <description>ViPNet IDS SNMPv2 template</description>
      <groups>
        <group>
          <name>Templates</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>ViPNet IDS</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Attacks count for day period</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.1.1.0</snmp_oid>
          <key>attacks.day</key>
          <delay>1h</delay>
          <description>IDS attacks count for day period</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for day period (high severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.1.2.0</snmp_oid>
          <key>attacks.high.day</key>
          <delay>5m</delay>
          <description>IDS attacks count for day period (high severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{change()}>={$ATCKS.HIGH}</expression>
              <name>{HOST.NAME} high growth of high severity attacks (>{$ATCKS.HIGH} events from last time)</name>
              <priority>WARNING</priority>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Attacks count for month period (high severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.2.2.0</snmp_oid>
          <key>attacks.high.month</key>
          <delay>1h</delay>
          <description>IDS attacks count for month period (high severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for year period (high severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.3.2.0</snmp_oid>
          <key>attacks.high.year</key>
          <delay>1h</delay>
          <description>IDS attacks count for year period (high severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for day period (information severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.1.5.0</snmp_oid>
          <key>attacks.information.day</key>
          <delay>1h</delay>
          <description>IDS attacks count for day period (information severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for month period (information severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.2.5.0</snmp_oid>
          <key>attacks.information.month</key>
          <delay>1h</delay>
          <description>IDS attacks count for month period (information severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for year period (information severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.3.5.0</snmp_oid>
          <key>attacks.information.year</key>
          <delay>1h</delay>
          <description>IDS attacks count for year period (information severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for day period (low severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.1.4.0</snmp_oid>
          <key>attacks.low.day</key>
          <delay>1h</delay>
          <description>IDS attacks count for day period (low severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for month period (low severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.2.4.0</snmp_oid>
          <key>attacks.low.month</key>
          <delay>1h</delay>
          <description>IDS attacks count for month period (low severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for year period (low severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.3.4.0</snmp_oid>
          <key>attacks.low.year</key>
          <delay>1h</delay>
          <description>IDS attacks count for year period (low severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for day period (medium severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.1.3.0</snmp_oid>
          <key>attacks.medium.day</key>
          <delay>1h</delay>
          <description>IDS attacks count for day period (medium severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{change()}>={$ATCKS.MED}</expression>
              <name>{HOST.NAME} high growth of medium severity attacks (>{$ATCKS.MED} events from last time)</name>
              <priority>WARNING</priority>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Attacks count for month period (medium severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.2.3.0</snmp_oid>
          <key>attacks.medium.month</key>
          <delay>1h</delay>
          <description>IDS attacks count for month period (medium severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for year period (medium severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.3.3.0</snmp_oid>
          <key>attacks.medium.year</key>
          <delay>1h</delay>
          <description>IDS attacks count for year period (medium severity)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for month period</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.2.1.0</snmp_oid>
          <key>attacks.month</key>
          <delay>1d</delay>
          <description>IDS attacks count for day period</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Attacks count for year period</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.9.3.1.0</snmp_oid>
          <key>attacks.year</key>
          <delay>1d</delay>
          <description>IDS attacks count for year period</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>CPU load</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.8.5.0</snmp_oid>
          <key>CPU.load</key>
          <delay>30s</delay>
          <units>%</units>
          <description>IDS CPU load</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{avg(5m)}>={$CPU.LOAD}</expression>
              <name>{HOST.NAME} high CPU load (over {$CPU.LOAD}% for 5 min)</name>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Database free space</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.8.10.0</snmp_oid>
          <key>DB.space</key>
          <delay>1h</delay>
          <units>Gb</units>
          <description>IDS Database free space</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Hardware version</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.7.2.0</snmp_oid>
          <key>hardware.version</key>
          <delay>1d</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>IDS hardware version (platform)</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>License expiration date</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.5.1.0</snmp_oid>
          <key>license.expdate</key>
          <delay>1d</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>IDS license expiration date</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>License days before expiration</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.5.5.0</snmp_oid>
          <key>license.expdays</key>
          <delay>1d</delay>
          <units>days</units>
          <description>IDS license days before expiration</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{last()}&lt;={$LIC.DAYS}</expression>
              <name>{HOST.NAME} license expire soon ({#SNMPVALUE} days left)</name>
              <priority>WARNING</priority>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Loader service status</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.6.4.0</snmp_oid>
          <key>loader.status</key>
          <delay>120s</delay>
          <description>IDS Loader service status</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <valuemap>
            <name>ViPNet IDS services state</name>
          </valuemap>
        </item>
        <item>
          <name>RAM usage</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.8.6.0</snmp_oid>
          <key>RAM.usage</key>
          <delay>30s</delay>
          <units>%</units>
          <description>IDS RAM usage</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{avg(5m)}>={$RAM.USAGE}</expression>
              <name>{HOST.NAME} high RAM usage (over {$RAM.USAGE}% for 5 min)</name>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Detection rules date</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.5.3.0</snmp_oid>
          <key>rules.date</key>
          <delay>1d</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>IDS Detection rules date</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Sensor ID</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.1.0</snmp_oid>
          <key>sensor.ID</key>
          <delay>1h</delay>
          <description>IDS sensor ID</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Sensor service status</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.6.5.0</snmp_oid>
          <key>sensor.status</key>
          <delay>120s</delay>
          <description>IDS Sensor service status</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <valuemap>
            <name>ViPNet IDS services state</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{change()}=-1</expression>
              <name>{HOST.NAME} Sensor service status changed to down</name>
              <priority>WARNING</priority>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Serial number</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.5.2.0</snmp_oid>
          <key>serial.number</key>
          <delay>1d</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>IDS Serial number</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Services status</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.6.3.0</snmp_oid>
          <key>services.status</key>
          <delay>120s</delay>
          <description>IDS services status</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <valuemap>
            <name>ViPNet IDS services state</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{change()}=-1</expression>
              <name>{HOST.NAME} services down</name>
              <priority>WARNING</priority>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Software version build</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.7.6.0</snmp_oid>
          <key>software.build</key>
          <delay>1d</delay>
          <trends>0</trends>
          <description>IDS software version build</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Software version hotfix</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.7.5.0</snmp_oid>
          <key>software.hotfix</key>
          <delay>1d</delay>
          <trends>0</trends>
          <description>IDS software version hotfix</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Software version major</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.7.3.0</snmp_oid>
          <key>software.major</key>
          <delay>1d</delay>
          <trends>0</trends>
          <description>IDS software version major</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Software version minor</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.7.4.0</snmp_oid>
          <key>software.minor</key>
          <delay>1d</delay>
          <trends>0</trends>
          <description>IDS software version minor</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Software version</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.7.1.0</snmp_oid>
          <key>software.version</key>
          <delay>1d</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>IDS software version</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Uptime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.3.0</snmp_oid>
          <key>system.uptime[sysUpTime.0]</key>
          <delay>30s</delay>
          <trends>0</trends>
          <units>uptime</units>
          <description>MIB: SNMPv2-MIB The time (in hundredths of a second) since the network management portion of the system was last re-initialized.</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{last()}&lt;10m</expression>
              <name>{HOST.NAME} has been restarted (uptime &lt; 10m)</name>
              <priority>WARNING</priority>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>System partition free space</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.8.9.0</snmp_oid>
          <key>systempartition.freespace</key>
          <delay>1h</delay>
          <units>Gb</units>
          <description>IDS system partition free space</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
        <item>
          <name>System partition usage</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.8.8.0</snmp_oid>
          <key>systempartition.usage</key>
          <delay>1h</delay>
          <units>%</units>
          <description>IDS system partition usage</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{last()}>={$CPU.LOAD}</expression>
              <name>{HOST.NAME} high system partition usage (over {$CPU.LOAD}%)</name>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Total attacks</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.10812.3.1.4.0</snmp_oid>
          <key>total.attacks</key>
          <delay>15m</delay>
          <description>IDS DB total attacks</description>
          <applications>
            <application>
              <name>ViPNet IDS</name>
            </application>
          </applications>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>Detection interface</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.10812.3.10.1.2]</snmp_oid>
          <key>detection.interface</key>
          <delay>1h</delay>
          <lifetime>1h</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>Detection interface name {#SNMPVALUE}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.10812.3.10.1.2.{#SNMPINDEX}</snmp_oid>
              <key>detection.interface.name.[{#SNMPVALUE}]</key>
              <delay>1h</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>ViPNet IDS</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Detection interface state discription {#SNMPVALUE}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.10812.3.10.1.4.{#SNMPINDEX}</snmp_oid>
              <key>detection.interface.state.discription.[{#SNMPVALUE}]</key>
              <delay>2m</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>ViPNet IDS</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Detection interface state {#SNMPVALUE}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.10812.3.10.1.3.{#SNMPINDEX}</snmp_oid>
              <key>detection.interface.state.[{#SNMPVALUE}]</key>
              <delay>2m</delay>
              <applications>
                <application>
                  <name>ViPNet IDS</name>
                </application>
              </applications>
              <valuemap>
                <name>ViPNet IDS detection interface state</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{change()}>0</expression>
                  <name>{HOST.NAME} {#SNMPVALUE} detection interface state changed to down</name>
                  <priority>HIGH</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Last day attacks (attacked ip addresses)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.10812.3.5.1.2.{$SENSOR.ID}]</snmp_oid>
          <key>lastday.attacks.attacked.ip</key>
          <delay>15m</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPINDEX}</macro>
                <value>^(?:[1-9]|0[1-9]|10)$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <lifetime>1h</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>Last day attacks (attacked ip address №{#SNMPINDEX})</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.10812.3.5.1.2.{$SENSOR.ID}.{#SNMPINDEX}</snmp_oid>
              <key>lastday.attacks.attacked.ip[{#SNMPINDEX}]</key>
              <delay>15m</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>ViPNet IDS</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Last day attacks (attacker ip addresses)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.10812.3.6.1.2.{$SENSOR.ID}]</snmp_oid>
          <key>lastday.attacks.attacker.ip</key>
          <delay>15m</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPINDEX}</macro>
                <value>^(?:[1-9]|0[1-9]|10)$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <lifetime>1h</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>Last day attacks (attacker ip addresses №{#SNMPINDEX})</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.10812.3.6.1.2.{$SENSOR.ID}.{#SNMPINDEX}</snmp_oid>
              <key>lastday.attacks.attacker.ip[{#SNMPINDEX}]</key>
              <delay>15m</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>ViPNet IDS</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Last day attacks (events count)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.10812.3.4.1.6.{$SENSOR.ID}]</snmp_oid>
          <key>lastday.attacks.events.count</key>
          <delay>15m</delay>
          <filter>
            <evaltype>OR</evaltype>
          </filter>
          <lifetime>1h</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>Last day attacks (events count) №{#SNMPINDEX}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.10812.3.4.1.6.{$SENSOR.ID}.{#SNMPINDEX}</snmp_oid>
              <key>lastday.attacks.events.count[{#SNMPINDEX}]</key>
              <delay>15m</delay>
              <applications>
                <application>
                  <name>ViPNet IDS</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Last day attacks (events name)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.10812.3.4.1.4.{$SENSOR.ID}]</snmp_oid>
          <key>lastday.attacks.events.name</key>
          <delay>15m</delay>
          <lifetime>1h</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>Last day events name №{#SNMPINDEX}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.10812.3.4.1.4.{$SENSOR.ID}.{#SNMPINDEX}</snmp_oid>
              <key>lastdayevents.events.name[{#SNMPINDEX}]</key>
              <delay>15m</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>ViPNet IDS</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Last day attacks (events severity)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.10812.3.4.1.5.{$SENSOR.ID}]</snmp_oid>
          <key>lastday.attacks.events.severity</key>
          <delay>15m</delay>
          <lifetime>1h</lifetime>
        </discovery_rule>
        <discovery_rule>
          <name>Last day attacks (events URL)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.10812.3.4.1.7.{$SENSOR.ID}]</snmp_oid>
          <key>lastday.attacks.events.url</key>
          <delay>15m</delay>
          <lifetime>1h</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>Last day events URL №{#SNMPINDEX}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.10812.3.4.1.7.{$SENSOR.ID}.{#SNMPINDEX}</snmp_oid>
              <key>lastday.attacks.events.url[{#SNMPINDEX}]</key>
              <delay>15m</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>ViPNet IDS</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
      </discovery_rules>
      <macros>
        <macro>
          <macro>{$ATCKS.HIGH}</macro>
          <value>25</value>
          <description>count of attacks to inform high count of attacks trigger</description>
        </macro>
        <macro>
          <macro>{$ATCKS.MED}</macro>
          <value>125</value>
          <description>count of attacks to inform medium count of attacks trigger</description>
        </macro>
        <macro>
          <macro>{$CPU.LOAD}</macro>
          <value>75</value>
          <description>high cpu load value</description>
        </macro>
        <macro>
          <macro>{$LIC.DAYS}</macro>
          <value>30</value>
          <description>days of license time to inform</description>
        </macro>
        <macro>
          <macro>{$RAM.USAGE}</macro>
          <value>75</value>
          <description>max RAM usage</description>
        </macro>
        <macro>
          <macro>{$SENSOR.ID}</macro>
          <value>357810809</value>
          <description>paste item Sensor ID here</description>
        </macro>
      </macros>
    </template>
  </templates>
  <triggers>
    <trigger>
      <expression>{ViPNet IDS SNMPv2 template:software.build.diff()}=1 or {ViPNet IDS SNMPv2 template:software.hotfix.diff()}=1 or {ViPNet IDS SNMPv2 template:software.major.diff()}=1 or {ViPNet IDS SNMPv2 template:software.minor.diff()}=1</expression>
      <name>{HOST.NAME} software version changed</name>
      <priority>INFO</priority>
      <manual_close>YES</manual_close>
    </trigger>
  </triggers>
  <graphs>
    <graph>
      <name>CPU load</name>
      <show_triggers>NO</show_triggers>
      <graph_items>
        <graph_item>
          <drawtype>FILLED_REGION</drawtype>
          <color>00FF00</color>
          <calc_fnc>ALL</calc_fnc>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>CPU.load</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>Day attacks count</name>
      <height>500</height>
      <yaxismax>0</yaxismax>
      <show_work_period>NO</show_work_period>
      <show_triggers>NO</show_triggers>
      <type>PIE</type>
      <show_3d>YES</show_3d>
      <graph_items>
        <graph_item>
          <color>F63100</color>
          <calc_fnc>LAST</calc_fnc>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.high.day</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>FF8000</color>
          <calc_fnc>LAST</calc_fnc>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.medium.day</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <color>80FF00</color>
          <calc_fnc>LAST</calc_fnc>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.low.day</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>3</sortorder>
          <color>2774A4</color>
          <calc_fnc>LAST</calc_fnc>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.information.day</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>Month attacks count</name>
      <height>500</height>
      <yaxismax>0</yaxismax>
      <show_work_period>NO</show_work_period>
      <show_triggers>NO</show_triggers>
      <type>PIE</type>
      <show_3d>YES</show_3d>
      <graph_items>
        <graph_item>
          <color>FF4000</color>
          <calc_fnc>LAST</calc_fnc>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.high.month</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>F7941D</color>
          <calc_fnc>LAST</calc_fnc>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.medium.month</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <color>80FF00</color>
          <calc_fnc>LAST</calc_fnc>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.low.month</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>3</sortorder>
          <color>00BFFF</color>
          <calc_fnc>LAST</calc_fnc>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.information.month</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>Year attacks count</name>
      <height>500</height>
      <yaxismax>0</yaxismax>
      <show_work_period>NO</show_work_period>
      <show_triggers>NO</show_triggers>
      <type>PIE</type>
      <show_3d>YES</show_3d>
      <graph_items>
        <graph_item>
          <color>FF0000</color>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.high.year</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>FF8000</color>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.medium.year</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <color>80FF00</color>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.low.year</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>3</sortorder>
          <color>00BFFF</color>
          <item>
            <host>ViPNet IDS SNMPv2 template</host>
            <key>attacks.information.year</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
  </graphs>
  <value_maps>
    <value_map>
      <name>ViPNet IDS detection interface state</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>up</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>down</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>ViPNet IDS services state</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>down</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>up</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>