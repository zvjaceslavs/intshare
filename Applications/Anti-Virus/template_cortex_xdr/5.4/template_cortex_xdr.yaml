zabbix_export:
  version: '5.4'
  date: '2021-10-22T10:58:56Z'
  groups:
    -
      uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
    -
      uuid: a571c0d144b14fd4a87a9d9b2aa9fcd6
      name: Templates/Applications
  templates:
    -
      uuid: 882bf6447ac744afa52d925d4c468385
      template: 'Template App Cortex XDR'
      name: 'Template App Cortex XDR'
      groups:
        -
          name: Templates
        -
          name: Templates/Applications
      items:
        -
          uuid: 7a95f5c7aa9e4ff3bb1642214d126349
          name: 'Cortex XDR Service'
          key: 'service.info[cyserver,state]'
          delay: 5m
          description: 'Service state of Cortex XDR'
          triggers:
            -
              uuid: d36f440e65c343d18e049d77c936785a
              expression: 'last(/Template App Cortex XDR/service.info[cyserver,state])>0'
              name: 'Cortex XDR Service is not running on {HOSTNAME}'
              priority: HIGH
        -
          uuid: e842ddbca578468eb932b5a02a4e8be9
          name: 'Cortex Service Path'
          key: 'service.info[{$CORTEX.SERVICE},path]'
          delay: 1h
          trends: '0'
          value_type: TEXT
          description: 'Path of Cortex XDR service. Depends on service name in macro'
          preprocessing:
            -
              type: TRIM
              parameters:
                - '"'
          triggers:
            -
              uuid: 2ea4839f3d4448f2b5ee90bc9efa4238
              expression: 'change(/Template App Cortex XDR/service.info[{$CORTEX.SERVICE},path])=1'
              name: 'Cortex XDR service path changed on {HOSTNAME}'
              priority: INFO
              manual_close: 'YES'
        -
          uuid: f3635ccdb37e473f85d78b4b3cb1c985
          name: 'Cortex Version'
          key: 'system.run[powershell.exe Get-ItemPropertyValue -Path ''HKLM:\Software\Cyvera\Client\'' -Name ''Product Version'']'
          delay: 1h
          trends: '0'
          value_type: TEXT
          triggers:
            -
              uuid: fdf523996d1848468987dc80f070c5bb
              expression: 'change(/Template App Cortex XDR/system.run[powershell.exe Get-ItemPropertyValue -Path ''HKLM:\Software\Cyvera\Client\'' -Name ''Product Version''])=1'
              name: 'Cortex XDR version changed on {HOSTNAME}'
              status: DISABLED
              priority: INFO
              manual_close: 'YES'
        -
          uuid: 04f8be4e13c14308974374e729bff988
          name: 'Cortex Protection Status'
          key: 'system.run[powershell.exe Get-ItemPropertyValue -Path ''HKLM:\Software\Palo Alto Networks\Traps\'' -Name ''ProtectionStatus'']'
          delay: 5m
          value_type: FLOAT
          description: |
            Protection Status of Cortex XDR
            
            Value
            Anti-Exploit Protection	Anti-Malware Protection
            3	Enabled	Enabled
            2	Disabled	Enabled
            1	Enabled	Disabled
            0	Disabled	Disabled
          valuemap:
            name: 'Cortex XDR Protection Status'
          triggers:
            -
              uuid: 9caf092216554fe4ae424615f1e9ea59
              expression: 'change(/Template App Cortex XDR/system.run[powershell.exe Get-ItemPropertyValue -Path ''HKLM:\Software\Palo Alto Networks\Traps\'' -Name ''ProtectionStatus''])=1'
              name: 'Cortex XDR Protection Status changed on {HOSTNAME}'
              priority: INFO
              manual_close: 'YES'
            -
              uuid: bca66f70357542d3bf530193fb04ef09
              expression: 'last(/Template App Cortex XDR/system.run[powershell.exe Get-ItemPropertyValue -Path ''HKLM:\Software\Palo Alto Networks\Traps\'' -Name ''ProtectionStatus''])=0'
              name: 'Cortex XDR Protection Status on {HOSTNAME} is disabled'
              priority: HIGH
      macros:
        -
          macro: '{$CORTEX.SERVICE}'
          value: '"cyserver"'
          description: 'Service name of Cortex XDR'
      valuemaps:
        -
          uuid: 16a6e7d6e447483da3cc30434fb7dc72
          name: 'Cortex XDR Protection Status'
          mappings:
            -
              value: '3'
              newvalue: 'Anti-Exploit Protection and Anti-Malware Protection Enabled'
            -
              value: '1'
              newvalue: 'Anti-Exploit Protection Enabled'
            -
              value: '2'
              newvalue: 'Anti-Malware Protection Enabled'
            -
              value: '0'
              newvalue: Disabled
