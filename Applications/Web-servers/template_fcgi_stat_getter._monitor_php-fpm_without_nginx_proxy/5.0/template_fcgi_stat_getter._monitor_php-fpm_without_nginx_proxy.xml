<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-19T21:19:34Z</date>
  <groups>
    <group>
      <name>Templates_Custom</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Template App PHP-FPM</template>
      <name>Template App PHP-FPM</name>
      <groups>
        <group>
          <name>Templates_Custom</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>PHP-FPM</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Php-fpm - latency</name>
          <type>EXTERNAL</type>
          <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","latency"]</key>
          <delay>60</delay>
          <value_type>FLOAT</value_type>
          <units>ms</units>
          <applications>
            <application>
              <name>PHP-FPM</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{min(#10)}>100</expression>
              <name>PHP-FPM - is slow to respond on {HOST.NAME}</name>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Php-fpm</name>
          <type>EXTERNAL</type>
          <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","ping"]</key>
          <delay>60</delay>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <applications>
            <application>
              <name>PHP-FPM</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{count(#5,"pong",ne)}>3</expression>
              <name>PHP-FPM on {HOST.NAME}</name>
              <priority>DISASTER</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Php-fpm - connections per sec</name>
          <type>EXTERNAL</type>
          <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","accepted conn"]</key>
          <delay>60</delay>
          <value_type>FLOAT</value_type>
          <applications>
            <application>
              <name>PHP-FPM</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>CHANGE_PER_SECOND</type>
              <params></params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>Php-fpm - active processes count</name>
          <type>EXTERNAL</type>
          <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","active processes"]</key>
          <delay>60</delay>
          <applications>
            <application>
              <name>PHP-FPM</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Php-fpm - idle processes count</name>
          <type>EXTERNAL</type>
          <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","idle processes"]</key>
          <delay>60</delay>
          <applications>
            <application>
              <name>PHP-FPM</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{avg(600)}&lt;3</expression>
              <name>PHP-FPM - child process count is small on {HOST.NAME}</name>
              <priority>INFO</priority>
              <description>Please, increase pm.max_children (if static) or pm.min_spare_servers and pm.max_spare_servers (if dynamic) in /etc/php-fpm.d/www.conf</description>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Php-fpm - length of listen queue</name>
          <type>EXTERNAL</type>
          <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","listen queue len"]</key>
          <delay>60</delay>
          <applications>
            <application>
              <name>PHP-FPM</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Php-fpm - max children reached</name>
          <type>EXTERNAL</type>
          <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","max children reached"]</key>
          <delay>60</delay>
          <applications>
            <application>
              <name>PHP-FPM</name>
            </application>
          </applications>
        </item>
      </items>
      <macros>
        <macro>
          <macro>{$AJAX_PORT}</macro>
          <value>3001</value>
        </macro>
        <macro>
          <macro>{$API_PORT}</macro>
          <value>3002</value>
        </macro>
        <macro>
          <macro>{$FERM_PORT}</macro>
          <value>3004</value>
        </macro>
        <macro>
          <macro>{$IMHO_PORT}</macro>
          <value>3000</value>
        </macro>
      </macros>
      <screens>
        <screen>
          <name>PHP-FPM</name>
          <hsize>2</hsize>
          <vsize>2</vsize>
          <screen_items>
            <screen_item>
              <resourcetype>0</resourcetype>
              <style>0</style>
              <resource>
                <name>PHP-FPM - latency</name>
                <host>Template App PHP-FPM</host>
              </resource>
              <width>700</width>
              <height>200</height>
              <x>0</x>
              <y>0</y>
              <colspan>1</colspan>
              <rowspan>1</rowspan>
              <elements>0</elements>
              <valign>0</valign>
              <halign>0</halign>
              <dynamic>0</dynamic>
              <sort_triggers>0</sort_triggers>
              <url></url>
              <application></application>
              <max_columns>3</max_columns>
            </screen_item>
            <screen_item>
              <resourcetype>0</resourcetype>
              <style>0</style>
              <resource>
                <name>PHP-FPM - workload</name>
                <host>Template App PHP-FPM</host>
              </resource>
              <width>700</width>
              <height>200</height>
              <x>1</x>
              <y>0</y>
              <colspan>1</colspan>
              <rowspan>1</rowspan>
              <elements>0</elements>
              <valign>0</valign>
              <halign>0</halign>
              <dynamic>0</dynamic>
              <sort_triggers>0</sort_triggers>
              <url></url>
              <application></application>
              <max_columns>3</max_columns>
            </screen_item>
            <screen_item>
              <resourcetype>0</resourcetype>
              <style>0</style>
              <resource>
                <name>PHP-FPM - listen queue</name>
                <host>Template App PHP-FPM</host>
              </resource>
              <width>700</width>
              <height>200</height>
              <x>0</x>
              <y>1</y>
              <colspan>1</colspan>
              <rowspan>1</rowspan>
              <elements>0</elements>
              <valign>0</valign>
              <halign>0</halign>
              <dynamic>0</dynamic>
              <sort_triggers>0</sort_triggers>
              <url></url>
              <application></application>
              <max_columns>3</max_columns>
            </screen_item>
            <screen_item>
              <resourcetype>0</resourcetype>
              <style>0</style>
              <resource>
                <name>PHP-FPM - processes</name>
                <host>Template App PHP-FPM</host>
              </resource>
              <width>700</width>
              <height>200</height>
              <x>1</x>
              <y>1</y>
              <colspan>1</colspan>
              <rowspan>1</rowspan>
              <elements>0</elements>
              <valign>0</valign>
              <halign>0</halign>
              <dynamic>0</dynamic>
              <sort_triggers>0</sort_triggers>
              <url></url>
              <application></application>
              <max_columns>3</max_columns>
            </screen_item>
          </screen_items>
        </screen>
      </screens>
    </template>
  </templates>
  <graphs>
    <graph>
      <name>PHP-FPM - latency</name>
      <ymin_type_1>FIXED</ymin_type_1>
      <graph_items>
        <graph_item>
          <drawtype>GRADIENT_LINE</drawtype>
          <color>009900</color>
          <item>
            <host>Template App PHP-FPM</host>
            <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","latency"]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>PHP-FPM - listen queue</name>
      <show_work_period>NO</show_work_period>
      <show_triggers>NO</show_triggers>
      <ymin_type_1>FIXED</ymin_type_1>
      <graph_items>
        <graph_item>
          <color>C80000</color>
          <item>
            <host>Template App PHP-FPM</host>
            <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","listen queue len"]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>00C800</color>
          <item>
            <host>Template App PHP-FPM</host>
            <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","max children reached"]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>PHP-FPM - processes</name>
      <show_work_period>NO</show_work_period>
      <show_triggers>NO</show_triggers>
      <type>STACKED</type>
      <ymin_type_1>FIXED</ymin_type_1>
      <graph_items>
        <graph_item>
          <color>C80000</color>
          <item>
            <host>Template App PHP-FPM</host>
            <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","active processes"]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>00EEEE</color>
          <item>
            <host>Template App PHP-FPM</host>
            <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","idle processes"]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>PHP-FPM - workload</name>
      <show_work_period>NO</show_work_period>
      <show_triggers>NO</show_triggers>
      <ymin_type_1>FIXED</ymin_type_1>
      <graph_items>
        <graph_item>
          <drawtype>BOLD_LINE</drawtype>
          <color>C80000</color>
          <item>
            <host>Template App PHP-FPM</host>
            <key>fcgi_stat_getter["-h","{HOST.CONN}","-p","3000","-c","stat","-k","accepted conn"]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
  </graphs>
</zabbix_export>