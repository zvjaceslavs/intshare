<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T10:10:12Z</date>
  <groups>
    <group>
      <name>Templates</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>App PowerDNS dnsdist</template>
      <name>App PowerDNS dnsdist</name>
      <description>Self-contained Zabbix template to get information about PowerDNS dnsdist. Source: https://github.com/frei-style/zabbix-powerdns-dnsdist-template/</description>
      <groups>
        <group>
          <name>Templates</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>PowerDNS dnsdist</name>
        </application>
      </applications>
      <items>
        <item>
          <name>API Statistics</name>
          <type>HTTP_AGENT</type>
          <key>pdns.dnsdist.api.statistics</key>
          <history>0</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <url>http://{$PDNS.DNSDIST.WEBSERVER.IP}:{$PDNS.DNSDIST.WEBSERVER.PORT}/api/v1/servers/localhost/statistics</url>
          <headers>
            <header>
              <name>X-API-Key</name>
              <value>{$PDNS.DNSDIST.APIKEY}</value>
            </header>
          </headers>
        </item>
        <item>
          <name>acl-drops</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[acl-drops]</key>
          <delay>0</delay>
          <description>The number of packets (or TCP messages) dropped because of the ACL. If a packet or message is dropped, it is not counted in the queries statistic.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "acl-drops")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>cache-hits</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[cache-hits]</key>
          <delay>0</delay>
          <description>Number of times a response was sent using data found in the packet cache.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "cache-hits")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>cache-misses</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[cache-misses]</key>
          <delay>0</delay>
          <description>Number of times an answer was not found in the packet cache. Only counted if a packet cache was setup for the selected pool.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "cache-misses")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>cpu-iowait</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[cpu-iowait]</key>
          <delay>0</delay>
          <description>Time spent waiting for I/O to complete by the whole system, in units of USER_HZ. New in version 1.5.0.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "cpu-iowait")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>cpu-steal</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[cpu-steal]</key>
          <delay>0</delay>
          <description>Stolen time, which is the time spent by the whole system in other operating systems when running in a virtualized environment, in units of USER_HZ. New in version 1.5.0.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "cpu-steal")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>cpu-sys-msec</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[cpu-sys-msec]</key>
          <delay>0</delay>
          <description>Milliseconds spent by dnsdist in the “system” state.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "cpu-sys-msec")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>cpu-user-msec</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[cpu-user-msec]</key>
          <delay>0</delay>
          <description>Milliseconds spent by dnsdist in the “user” state.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "cpu-user-msec")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>downstream-send-errors</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[downstream-send-errors]</key>
          <delay>0</delay>
          <description>Number of errors when sending a query to a backend.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "downstream-send-errors")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>downstream-timeouts</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[downstream-timeouts]</key>
          <delay>0</delay>
          <description>Number of queries not answer in time by a backend.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "downstream-timeouts")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>dyn-block-nmg-size</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[dyn-block-nmg-size]</key>
          <delay>0</delay>
          <description>Number of dynamic blocks entries.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "dyn-block-nmg-size")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>dyn-blocked</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[dyn-blocked]</key>
          <delay>0</delay>
          <description>Number of queries dropped because of a dynamic block.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "dyn-blocked")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>empty-queries</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[empty-queries]</key>
          <delay>0</delay>
          <description>Number of empty queries received from clients. Every empty-query is also counted as a query.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "empty-queries")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>fd-usage</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[fd-usage]</key>
          <delay>0</delay>
          <description>Number of currently used file descriptors.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "fd-usage")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>frontend-noerror</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[frontend-noerror]</key>
          <delay>0</delay>
          <description>Number of NoError answers sent to clients.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "frontend-noerror")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>frontend-nxdomain</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[frontend-nxdomain]</key>
          <delay>0</delay>
          <description>Number of NXDomain answers sent to clients.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "frontend-nxdomain")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>frontend-servfail</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[frontend-servfail]</key>
          <delay>0</delay>
          <description>Number of ServFail answers sent to clients.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "frontend-servfail")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency-avg100</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency-avg100]</key>
          <delay>0</delay>
          <description>Average response latency in microseconds of the last 100 packets.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency-avg100")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency-avg1000</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency-avg1000]</key>
          <delay>0</delay>
          <description>Average response latency in microseconds of the last 1'000 packets.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency-avg1000")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency-avg10000</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency-avg10000]</key>
          <delay>0</delay>
          <description>Average response latency in microseconds of the last 10'000 packets.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency-avg10000")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency-avg100000</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency-avg100000]</key>
          <delay>0</delay>
          <description>Average response latency in microseconds of the last 100'000 packets.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency-avg100000")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency-avg1000000</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency-avg1000000]</key>
          <delay>0</delay>
          <description>Average response latency in microseconds of the last 1'000'000 packets.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency-avg1000000")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency-bucket</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency-bucket]</key>
          <delay>0</delay>
          <description>Number of queries contributing to response time histogram per latency bucket.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency-bucket")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency-count</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency-count]</key>
          <delay>0</delay>
          <description>Number of queries contributing to response time histogram.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency-count")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency-slow</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency-slow]</key>
          <delay>0</delay>
          <description>Number of queries answered in more than 1 second.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency-slow")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency-sum</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency-sum]</key>
          <delay>0</delay>
          <description>Total response time of all queries combined in milliseconds since the start of dnsdist. Can be used to calculate the average response time over all queries.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency-slow")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency0-1</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency0-1]</key>
          <delay>0</delay>
          <description>Number of queries answered in less than 1 ms.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency0-1")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency1-10</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency1-10]</key>
          <delay>0</delay>
          <description>Number of queries answered in 1-10 ms.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency1-10")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency10-50</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency10-50]</key>
          <delay>0</delay>
          <description>Number of queries answered in 10-50 ms.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency10-50")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency50-100</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency50-100]</key>
          <delay>0</delay>
          <description>Number of queries answered in 50-100 ms.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency50-100")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>latency100-1000</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[latency100-1000]</key>
          <delay>0</delay>
          <description>Number of queries answered in 100-1000 ms.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "latency100-1000")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>no-policy</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[no-policy]</key>
          <delay>0</delay>
          <description>Number of queries dropped because no server was available.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "no-policy")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>noncompliant-queries</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[noncompliant-queries]</key>
          <delay>0</delay>
          <description>Number of queries dropped as non-compliant.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "noncompliant-queries")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>noncompliant-responses</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[noncompliant-responses]</key>
          <delay>0</delay>
          <description>Number of answers from a backend dropped as non-compliant.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "noncompliant-responses")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>queries</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[queries]</key>
          <delay>0</delay>
          <description>Number of received queries.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "queries")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>rdqueries</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[rdqueries]</key>
          <delay>0</delay>
          <description>Number of received queries with the recursion desired bit set.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "rdqueries")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>real-memory-usage</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[real-memory-usage]</key>
          <delay>0</delay>
          <description>Current memory usage.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "real-memory-usage")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>responses</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[responses]</key>
          <delay>0</delay>
          <description>Number of responses received from backends. Note! This is not the number of responses sent to clients. To get that number, add ‘cache-hits’ and ‘responses’.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "responses")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>rule-drop</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[rule-drop]</key>
          <delay>0</delay>
          <description>Number of queries dropped because of a rule.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "rule-drop")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>rule-nxdomain</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[rule-nxdomain]</key>
          <delay>0</delay>
          <description>Number of NXDomain answers returned because of a rule.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "rule-nxdomain")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>rule-refused</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[rule-refused]</key>
          <delay>0</delay>
          <description>Number of Refused answers returned because of a rule.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "rule-refused")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>rule-servfail</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[rule-servfail]</key>
          <delay>0</delay>
          <description>Number of ServFail answers returned because of a rule.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "rule-servfail")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>security-status</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[security-status]</key>
          <delay>0</delay>
          <description>The security status of dnsdist. This is regularly polled. 0 = Unknown status or unreleased version 1 = OK 2 = Upgrade recommended 3 = Upgrade required (most likely because there is a known security issue)</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "security-status")].value.first()</params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
          <triggers>
            <trigger>
              <expression>{last()}&lt;>1</expression>
              <name>Security status not OK</name>
              <priority>WARNING</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>self-answered</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[self-answered]</key>
          <delay>0</delay>
          <description>Number of self-answered responses.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "self-answered")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>servfail-responses</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[servfail-responses]</key>
          <delay>0</delay>
          <description>Number of servfail answers received from backends.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "servfail-responses")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>trunc-failures</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[trunc-failures]</key>
          <delay>0</delay>
          <description>Number of errors encountered while truncating an answer.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "trunc-failures")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>udp-in-errors</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[udp-in-errors]</key>
          <delay>0</delay>
          <description>From /proc/net/snmp InErrors. New in version 1.5.0.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "udp-in-errors")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>udp-noport-errors</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[udp-noport-errors]</key>
          <delay>0</delay>
          <description>From /proc/net/snmp NoPorts. New in version 1.5.0.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "udp-noport-errors")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>udp-recvbuf-errors</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[udp-recvbuf-errors]</key>
          <delay>0</delay>
          <description>From /proc/net/snmp RcvbufErrors. New in version 1.5.0.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "udp-recvbuf-errors")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>udp-sndbuf-errors</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[udp-sndbuf-errors]</key>
          <delay>0</delay>
          <description>From /proc/net/snmp SndbufErrors. New in version 1.5.0.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "udp-sndbuf-errors")].value.first()</params>
            </step>
            <step>
              <type>SIMPLE_CHANGE</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
        <item>
          <name>uptime</name>
          <type>DEPENDENT</type>
          <key>pdns.dnsdist.statistics[uptime]</key>
          <delay>0</delay>
          <units>unixtime</units>
          <description>Uptime of the dnsdist process, in seconds.</description>
          <applications>
            <application>
              <name>PowerDNS dnsdist</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>JSONPATH</type>
              <params>$[?(@.name == "uptime")].value.first()</params>
            </step>
          </preprocessing>
          <master_item>
            <key>pdns.dnsdist.api.statistics</key>
          </master_item>
        </item>
      </items>
      <macros>
        <macro>
          <macro>{$PDNS.DNSDIST.APIKEY}</macro>
          <value>changeme</value>
        </macro>
        <macro>
          <macro>{$PDNS.DNSDIST.WEBSERVER.IP}</macro>
          <value>127.0.0.1</value>
        </macro>
        <macro>
          <macro>{$PDNS.DNSDIST.WEBSERVER.PORT}</macro>
          <value>8083</value>
        </macro>
      </macros>
    </template>
  </templates>
  <graphs>
    <graph>
      <name>dnsdist Cache Hits/Misses</name>
      <type>STACKED</type>
      <graph_items>
        <graph_item>
          <color>2E7D32</color>
          <calc_fnc>MAX</calc_fnc>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[cache-hits]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>F4511E</color>
          <calc_fnc>MAX</calc_fnc>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[cache-misses]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>dnsdist Latency</name>
      <graph_items>
        <graph_item>
          <color>1A7C11</color>
          <calc_fnc>MAX</calc_fnc>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency0-1]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>F63100</color>
          <calc_fnc>MAX</calc_fnc>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency1-10]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <color>2774A4</color>
          <calc_fnc>MAX</calc_fnc>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency10-50]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>3</sortorder>
          <color>A54F10</color>
          <calc_fnc>MAX</calc_fnc>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency50-100]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>4</sortorder>
          <color>FC6EA3</color>
          <calc_fnc>MAX</calc_fnc>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency100-1000]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>dnsdist Latency Average</name>
      <graph_items>
        <graph_item>
          <color>1A7C11</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency-avg100]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>F63100</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency-avg1000]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <color>2774A4</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency-avg10000]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>3</sortorder>
          <color>A54F10</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency-avg100000]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>4</sortorder>
          <color>FC6EA3</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[latency-avg1000000]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>dnsdist Queries - Answers</name>
      <graph_items>
        <graph_item>
          <drawtype>FILLED_REGION</drawtype>
          <color>1A7C11</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[frontend-noerror]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <drawtype>FILLED_REGION</drawtype>
          <color>E91E63</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[frontend-nxdomain]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <drawtype>FILLED_REGION</drawtype>
          <color>2774A4</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[frontend-servfail]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>3</sortorder>
          <color>A54F10</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[queries]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>dnsdist Rules</name>
      <graph_items>
        <graph_item>
          <color>1A7C11</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[rule-drop]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>F63100</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[rule-nxdomain]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <color>2774A4</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[rule-refused]</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>3</sortorder>
          <color>A54F10</color>
          <item>
            <host>App PowerDNS dnsdist</host>
            <key>pdns.dnsdist.statistics[rule-servfail]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
  </graphs>
</zabbix_export>