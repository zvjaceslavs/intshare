zabbix_export:
  version: '5.4'
  date: '2021-11-09T04:29:40Z'
  groups:
    -
      uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
  templates:
    -
      uuid: 4832cc748adb4aedb5dd404baa59ddba
      template: HP_SNMP_Autodiscovery
      name: HP_SNMP_Autodiscovery
      description: |
        ## Overview
        
        For all HP servers with HP SNMP agents. Uses Zabbix Low-Level Discovery to spin up monitoring for serviceable items such as physical and logical drives, Drive Array Controllers, Drive Array Accelerators, Power Supplies, and firmware. Can also monitor individual memory modules but this is disabled by default because it is usually sufficient to monitor just the "Resilient Memory Condition" item. Similarly, things such as thermal problems are monitored using the top-level cpqHeThermalCondition item instead of monitoring individual temperature sensors.
        
        
        Newer HP servers (G8 and up) include HP SNMP Agents embedded in hardware at the iLO address; these can be monitored (with some reduced functionality) where the OS does not support HP SNMP agent installation (i.e. VMware).
        
        
        Tested with HP BL and DL series G7, G8, and G9 servers, using Zabbix 2.4.x
        
        
        No MIB files are required (only numeric OIDs are used).
        
        
        Update 2016-05-24: Added Zabbix Version 3.0 template (includes Zabbix value maps), thanks to "mrbbs" for converting. Also added Zabbix 2.0 version.
        
        
        Update 2017-02-27: Added Zabbix Version 3.2 template (Includes Zabbix value maps). Added value map item 4 (Flash-Backed Write Cache) under cpqDaAccelBackupPowerSource (used by G9 servers).
        
        
        This template uses Zabbix value mapping to provide meaningful data from SNMP queries. This means that the value maps must be entered before importing the template if you are using Zabbix 2.x. Although this is a bit tedious, it's worth the effort. Copy the value maps below and paste them into Zabbix:
        
        
        Zabbix Value Mapping for Template\_HP\_SNMP\_Autodiscovery
        
        
        cpqCondition
        
        
        1 other
        
        
        2 OK
        
        
        3 degraded
        
        
        4 failed
        
        
         
        
        
        cpqDaAccelBackupPowerSource
        
        
        1 other
        
        
        2 battery
        
        
        3 capacitor
        
        
        4 Flash-Backed Write Cache
        
        
         
        
        
        cpqDaAccelBatteryStatus
        
        
        1 other
        
        
        2 ok
        
        
        3 recharging
        
        
        4 failed
        
        
        5 degraded
        
        
        6 notPresent
        
        
        7 capacitorFailed
        
        
         
        
        
        cpqDaAccelStatus
        
        
        1 other
        
        
        2 invalid
        
        
        3 enabled
        
        
        4 tmpDisabled
        
        
        5 permDisabled
        
        
        6 cacheModFlashMemNotAttached
        
        
        7 cacheModDegradedFailsafeSpeed
        
        
        8 cacheModCriticalFailure
        
        
        9 cacheReadCacheNotMapped
        
        
         
        
        
        cpqDaCntlrDriveWriteCacheState
        
        
        1 other
        
        
        2 disabled
        
        
        3 enabled
        
        
         
        
        
        cpqDaLogDrvFaultTol
        
        
        1 other
        
        
        2 none
        
        
        3 mirroring
        
        
        4 dataGuard
        
        
        5 distribDataGuard
        
        
        7 advancedDataGuard
        
        
        8 raid50
        
        
        9 raid60
        
        
         
        
        
        cpqRedundant
        
        
        1 other
        
        
        2 notRedundant
        
        
        3 redundant
        
        
         
        
        
        
        
      groups:
        -
          name: Templates
      items:
        -
          uuid: e1285b4e6b7645249e16c6af4f8604eb
          name: 'HP ASR Condition'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.6.2.5.17.0
          key: cpqHeAsrCondition
          delay: '300'
          history: 7d
          description: |
            CPQHLTH-MIB::
                cpqHeAsrCondition OBJECT-TYPE
                    SYNTAX  INTEGER {
                        other(1),
                        ok(2),
                        degraded(3),
                        failed(4)
                        }
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "This value specifies the overall condition of the ASR feature."
                    ::= { cpqHeAsr 17 }
          valuemap:
            name: cpqCondition
          tags:
            -
              tag: Application
              value: 'HP Health'
          triggers:
            -
              uuid: 286bebb2c68d43e1b0cea0cdc6fa51bf
              expression: last(/HP_SNMP_Autodiscovery/cpqHeAsrCondition)>2
              name: '{HOST.NAME}: Server was restarted by ASR (HP Automatic Server Recovery)'
              priority: HIGH
              description: |
                HP Automatic Server Recovery (ASR) is reporting a "degraded" or "failed" state.  ASR is a watchdog timer which automatically restarts a server if the server hangs or crashes.
                
                When a server is restarted by ASR, a flag is set, and an alert is triggered until the flag is reset.
                
                To reset the ASR flag and clear this alert, go to the server's System Management Homepage, then select "Autorecovery" in the "Recovery" section.  There you can clear the ASR condition.
                
                HP System Management Homepage (may require starting service hpsmhd):
                https://{HOST.CONN}:2381
        -
          uuid: 68bc6c3ab6874b8a9f6fdd0435adfbbe
          name: 'HP Event Log Condition'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.6.2.11.2.0
          key: cpqHeEventLogCondition
          delay: '600'
          history: 7d
          trends: 30d
          description: |
            This event log item shows an error when there are IML log items which have not been marked as "repaired" in the System Management Homepage.  Because we monitor the individual subsystems, this item is redundant and we don't need to alert on it.
            
            CPQHLTH-MIB::
                cpqHeEventLogCondition OBJECT-TYPE
                    SYNTAX  INTEGER {
                        other(1),
                        ok(2),
                        degraded(3),
                        failed(4)
                        }
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "This value specifies the overall condition of the Integrated
                        Management Log feature."
                    ::= { cpqHeEventLog 2 }
          valuemap:
            name: cpqCondition
          tags:
            -
              tag: Application
              value: 'HP Health'
        -
          uuid: 1a525dbf1aa54b3c847eb1d90d887b01
          name: 'HP Fault Tolerant Power Supply Condition'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.6.2.9.1.0
          key: cpqHeFltTolPwrSupplyCondition
          delay: '300'
          history: 7d
          trends: 30d
          description: |
            Overall condition of power supplies.  Because we monitor the individual subsystems, this item is redundant and we don't need to alert on it.
            
            CPQHLTH-MIB::
                cpqHeFltTolPwrSupplyCondition OBJECT-TYPE
                    SYNTAX  INTEGER {
                        other(1),
                        ok(2),
                        degraded(3),
                        failed(4)
                        }
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "This value specifies the overall condition of the fault tolerant
                         power supply sub-system."
                    ::= { cpqHeFltTolPwrSupply 1 }
          valuemap:
            name: cpqCondition
          tags:
            -
              tag: Application
              value: 'HP Health'
        -
          uuid: a1bc61e51e3d48a896bf6d3b137a35dd
          name: 'HP Health MIB Condition'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.232.6.1.3.0
          key: cpqHeMibCondition
          delay: '600'
          history: 7d
          trends: 30d
          description: |
            This item shows an error when any underlying subsystem is not OK.  Because we monitor the individual subsystems, this item is redundant and we don't need to alert on it.
            
            CPQHLTH-MIB::
                cpqHeEventLogCondition OBJECT-TYPE
                    SYNTAX  INTEGER {
                        other(1),
                        ok(2),
                        degraded(3),
                        failed(4)
                        }
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "This value specifies the overall condition of the Integrated
                        Management Log feature."
                    ::= { cpqHeEventLog 2 }
          valuemap:
            name: cpqCondition
          tags:
            -
              tag: Application
              value: 'HP Health'
          triggers:
            -
              uuid: 15d879c558964de6abc2d30523fe69c4
              expression: 'nodata(/HP_SNMP_Autodiscovery/cpqHeMibCondition,3600s)=1'
              name: '{HOST.NAME}: HP SNMP Agents are not responding'
              priority: WARNING
              description: |
                The HP SNMP Agents for this host have not responded to SNMP queries for more than 1 hour.  If the host is otherwise operating properly, it can mean that the HP SNMP agents are not working properl, or that the SNMP service has stopped.  A less likely cause is a network issue - SNMP uses UDP port 161,
                
                To restart, as root:
                /sbin/service hp-snmp-agents restart
                /sbin/service snmpd restart
        -
          uuid: 78dc5565974341fdb53bee01d32f39c0
          name: 'HP Resilient Memory Condition'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.6.2.14.4.0
          key: cpqHeResilientMemCondition
          delay: '300'
          history: 7d
          description: |
            Overall status of memory system.  If we monitor the individual modules via discovery rule "Memory Modules", then this item is redundant and we don't need to alert on it.
            
            CPQHLTH-MIB::
                cpqHeResilientMemCondition OBJECT-TYPE
                    SYNTAX  INTEGER {
                        other(1),
                        ok(2),
                        degraded(3)
                        }
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "This value specifies the current condition of the Advanced
                        Memory Protection subsystem.
            
                        The following states are supported:
            
                        other(1)
                          The system does not support fault tolerant memory or the
                          state cannot be determined by the Management Agent.
            
                        ok(2)
                          This system is operating normally.
            
                        degraded(3)
                          The system is running in a degraded state because the
                          Advanced Memory Protection subsystem has been engaged."
                    ::= { cpqHeResilientMemory 4 }
          valuemap:
            name: cpqCondition
          tags:
            -
              tag: Application
              value: 'HP Health'
          triggers:
            -
              uuid: 658082bbeb1e474a86463ee23b083f9a
              expression: last(/HP_SNMP_Autodiscovery/cpqHeResilientMemCondition)=3
              name: '{HOST.NAME}: HP Resilient Memory condition is degraded'
              priority: AVERAGE
              description: |
                The Advanced Memory Protection, probably because of correctable memory errors.  The DIMM which had the errors should be replaced.  Check the iLO or system management homepage for more detail, and to find out which DIMM.
                
                HP System Management Homepage (may require starting service hpsmhd):
                https://{HOST.CONN}:2381
            -
              uuid: ea0232f73eb74c069630d1dc239acbe7
              expression: last(/HP_SNMP_Autodiscovery/cpqHeResilientMemCondition)=1
              name: '{HOST.NAME}: HP Resilient Memory condition is unknown'
              priority: WARNING
              description: |
                The condition of the resilient memory system cannot be determined (condition reported is "other").  Try, in this order:
                1) resetting the iLO from the iLO screen 
                2) restarting the HP SNMP agents:
                /sbin/service hp-snmp-agents restart
                3) restarting snmpd:
                /sbin/service snmpd restart
                
                HP System Management Homepage (may require starting service hpsmhd):
                https://{HOST.CONN}:2381
        -
          uuid: 9823e7a0e9a540ca958d0a1478b3e408
          name: 'HP Thermal Condition'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.6.2.6.1.0
          key: cpqHeThermalCondition
          delay: '300'
          history: 7d
          trends: 30d
          description: |
            This item is a combined status of all temperature and fan items present.  By monitoring this item, it's not necessary to monitor each individual fan and temperature item.
            
            CPQHLTH-MIB::
                cpqHeThermalCondition OBJECT-TYPE
                    SYNTAX  INTEGER {
                        other(1),
                        ok(2),
                        degraded(3),
                        failed(4)
                        }
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "This value specifies the overall condition of the system's
                        thermal environment."
                    ::= { cpqHeThermal 1 }
          valuemap:
            name: cpqCondition
          tags:
            -
              tag: Application
              value: 'HP Health'
          triggers:
            -
              uuid: 718535cefd534c05889c505227557a6c
              expression: last(/HP_SNMP_Autodiscovery/cpqHeThermalCondition)>2
              name: '{HOST.NAME}: HP Thermal Condition is Degraded'
              priority: HIGH
              description: |
                Something is wrong with this server's cooling system.  Either a non-required fan is not operating properly, or a temp sensor is outside of normal operating range.
                
                The server will automatically shutdown if a required fan is not operating properly, or if a temp sensor detects a condition that could permanently damage the system.
                
                Check server's iLO or or System Management Homepage for more detail.
                
                HP System Management Homepage (may require starting service hpsmhd):
                https://{HOST.CONN}:2381
        -
          uuid: 067a66c61fcf4a9f935739beb9f448e1
          name: 'HP Product Name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.232.2.2.4.2.0
          key: cpqSiProductName
          delay: '28800'
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            CPQSINFO-MIB::
            cpqSiProductName OBJECT-TYPE
                    SYNTAX  DisplayString (SIZE (0..255))
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "The machine product name.
            
                        The name of the machine used in this system."
                    ::= { cpqSiSystemBoard 2 }
          tags:
            -
              tag: Application
              value: 'HP System Info'
        -
          uuid: 652ad39f32fb47088bed7161b4b86980
          name: 'HP System Product ID'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.2.2.2.6.0
          key: cpqSiSysProductId
          delay: '28800'
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            CPQSINFO-MIB::
            cpqSiSysProductId OBJECT-TYPE
                    SYNTAX  DisplayString (SIZE (0..255))
                    DESCRIPTION
                        "The product id string of the system unit.
                        The string will be empty if the system does not report the
                        product id."
                    ::= { cpqSiAsset 6 }
          tags:
            -
              tag: Application
              value: 'HP System Info'
        -
          uuid: 93fe2bc8de3842bf8b7357ba53334099
          name: 'HP System Serial Number'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.2.2.2.1.0
          key: cpqSiSysSerialNum
          delay: '28800'
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            CPQSINFO-MIB::
            cpqSiSysSerialNum OBJECT-TYPE
                    SYNTAX  DisplayString (SIZE (0..255))
                    DESCRIPTION
                        "The serial number of the physical system unit.
                        The string will be empty if the system does not report the
                        serial number function."
                    ::= { cpqSiAsset 1 }
          tags:
            -
              tag: Application
              value: 'HP System Info'
      discovery_rules:
        -
          uuid: d94d9e22f7314f5abd98f9a5d118b7b8
          name: 'Drive Array Accelerators'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.232.3.2.2.2.1.1]'
          key: 'snmp.discovery[DaAccelerators]'
          delay: '3600'
          lifetime: '0'
          description: |
            Walk the cpqDaCntlrHwLocation table to get contoller locations:
            
            CPQIDA-MIB::
                 cpqDaAccelCntlrIndex OBJECT-TYPE
                    SYNTAX  INTEGER
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "Array Accelerator Board Controller Index.
            
                        This value is a logical number whose meaning is OS dependent.
                        The value has a direct mapping to the controller table index
                        such that controller 'i' has accelerator table entry 'i'."
                    ::= { cpqDaAccelEntry 1 }
          item_prototypes:
            -
              uuid: 9a56f88c6b30473680e18fe225f557a0
              name: 'HP Drive Array Accelerator Backup Power Source {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.2.2.1.16.{#SNMPINDEX}'
              key: 'cpqDaAccelBackupPowerSource[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: 1d
              description: |
                CPQIDA-MIB::
                      cpqDaAccelBackupPowerSource OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            battery(2),
                            capacitor(3)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Array Accelerator Board Backup Power Source.
                
                            This describes the backup power source being used by the Array
                            Accelerator board.
                
                            The status can be:
                
                            Other (1)
                              Indicates that the instrument agent does not recognize the backup
                              power source used by the Array Accelerator board.  You may need 
                              to upgrade the instrument agent.
                
                            Battery (2)
                              Indicates that a battery is the backup power source for the Array
                              Accelerator board. 
                             
                            Capacitor (3)
                              Indicates that a capacitor is the backup power source for the 
                              Array Accelerator board."
                        ::= { cpqDaAccelEntry 16 }
              valuemap:
                name: cpqDaAccelBackupPowerSource
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: 59288d5a159c4535aa540b2dff04de66
              name: 'HP Drive Array Accelerator Battery Status {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.2.2.1.6.{#SNMPINDEX}'
              key: 'cpqDaAccelBattery[{#SNMPINDEX}]'
              delay: '600'
              history: 7d
              trends: 90d
              description: |
                CPQIDA-MIB::
                     cpqDaAccelBattery OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            ok(2),
                            recharging(3),
                            failed(4),
                            degraded(5),
                            notPresent(6),
                            capacitorFailed(7)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Array Accelerator Board Backup Power Status.
                
                            This monitors the status of each backup power source on the board.  
                            The backup power source can only recharge when the system has 
                            power applied. The type of backup power source used is indicated 
                            by cpqDaAccelBackupPowerSource.
                
                            The following values are valid:
                
                            Other (1)
                              Indicates that the instrument agent does not recognize
                              battery status.  You may need to update your software.
                
                            Ok (2)
                              Indicates that a particular battery pack is fully charged.
                
                            Charging (3)
                              The battery power is less than 75%.  The Drive Array
                              Controller is attempting to recharge the battery.  A
                              battery can take as long as 36 hours to fully recharge.
                              After 36 hours, if the battery has not recharged, it is
                              considered failed.
                
                            Failed (4)
                              The battery pack is below the sufficient voltage level and
                              has not recharged in 36 hours.  Your Array Accelerator board
                              needs to be serviced.
                
                            Degraded (5)
                              The battery is still operating, however, one of the batteries
                              in the pack has failed to recharge properly.  Your Array
                              Accelerator board should be serviced as soon as possible.
                
                            NotPresent (6)
                              There are no batteries associated with this controller.
                              
                            Capacitor Failed (7)
                              The capacitor is below the sufficient voltage level and
                              has not recharged in 10 minutes.  Your Array Accelerator board
                              needs to be serviced."
                        ::= { cpqDaAccelEntry 6 }
              valuemap:
                name: cpqDaAccelBatteryStatus
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
              trigger_prototypes:
                -
                  uuid: 624a1ccdf1824ae08d6e09f0d1fe9bbd
                  expression: 'max(/HP_SNMP_Autodiscovery/cpqDaAccelBattery[{#SNMPINDEX}],86400s)=4'
                  name: '{HOST.NAME}: Drive Array Accelerator {#SNMPINDEX} battery has failed'
                  priority: WARNING
                  description: |
                    The battery provides backup power for the cache memory, to prevent data loss in the event of a power failure.  This battery has failed, so the Drive Array Controller will disable that cache, and disk performance will be bad until the battery is replaced.  The battery needs to be replaced.  Suggested actions are to write a ticket to replace the battery, then acknowledge the alert, writing the ticket number in the notes.  This will prevent a stream of continuing alerts.
                    
                    When the battery is on the edge of failing, it can move in and out of the failed state. This can have the effect of restarting an alert which has already been acknowledged.  To prevent this, this trigger is held until there has been no failure reported in the last 24 hours.
                    
                    HP System Management Homepage (may require starting service hpsmhd):
                    https://{HOST.CONN}:2381
            -
              uuid: 27bb65e09f9449888468aa9bd53d788b
              name: 'HP Drive Array Accelerator Condition {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.2.2.1.9.{#SNMPINDEX}'
              key: 'cpqDaAccelCondition[{#SNMPINDEX}]'
              delay: '600'
              history: 7d
              trends: 90d
              description: |
                CPQIDA-MIB::
                     cpqDaAccelCondition OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            ok(2),
                            degraded(3),
                            failed(4)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "The condition of the device.  This value represents the overall
                            condition of this array accelerator."
                        ::= { cpqDaAccelEntry 9 }
              valuemap:
                name: cpqCondition
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: 0af8a9d5230e4008ab4b3f8acda3600b
              name: 'HP Drive Array Accelerator Status {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.2.2.1.2.{#SNMPINDEX}'
              key: 'cpqDaAccelStatus[{#SNMPINDEX}]'
              delay: '600'
              history: 7d
              trends: 90d
              description: |
                CPQIDA-MIB::
                     cpqDaAccelStatus OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            invalid(2),
                            enabled(3),
                            tmpDisabled(4),
                            permDisabled(5)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Array Accelerator Board Status.
                
                            This describes the status of the accelerator write cache.
                
                            The status can be:
                
                            Other (1)
                              Indicates that the instrument agent does not recognize the
                              status of the Array Accelerator.  You may need to upgrade
                              the instrument agent.
                
                            Invalid (2)
                              Indicates that an Array Accelerator board has not been
                              installed in this system or is present but not configured.
                
                            Enabled (3)
                              Indicates that write cache operations are currently configured
                              and enabled for at least one logical drive.
                
                            Temporarily Disabled (4)
                              Indicates that write cache operations have been temporarily
                              disabled. View the Array Accelerator Board Error Code object
                              to determine why the write cache operations have been
                              temporarily disabled.
                
                            Permanently Disabled (5)
                              Indicates that write cache operations have been permanently
                              disabled.  View the Array Accelerator Board Error Code object
                              to determine why the write cache operations have been disabled."
                        ::= { cpqDaAccelEntry 2 }
              valuemap:
                name: cpqDaAccelStatus
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
              trigger_prototypes:
                -
                  uuid: 35d82cb74f6a48d3a435fe888619bde3
                  expression: 'last(/HP_SNMP_Autodiscovery/cpqDaAccelStatus[{#SNMPINDEX}])=2'
                  name: '{HOST.NAME}: Drive Array Accelerator {#SNMPINDEX} is missing or not configured'
                  priority: WARNING
                  description: |
                    The Drive Array Accelerator is the cache memory board for the Drive Array Controller; if it is missing, disk performance will be bad.  A Drive Array Accelerator (cache memory board) should be ordered and installed.
                    
                    Suggested actions are to write a ticket to order and install the HP Drive Array Accelerator (cache memory board).  Then acknowledge the alert, writing the ticket number in the notes.
                    
                    HP System Management Homepage (may require starting service hpsmhd):
                    https://{HOST.CONN}:2381
            -
              uuid: e66434c18fd14ba0afb49f112c6623e4
              name: 'HP Drive Array Accelerator Write Cache % {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.2.2.1.14.{#SNMPINDEX}'
              key: 'cpqDaAccelWriteCachePercent[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: 1d
              units: '%'
              description: |
                CPQIDA-MIB::
                     cpqDaAccelWriteCachePercent OBJECT-TYPE
                        SYNTAX  Gauge
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Write Cache Percent.
                
                            This shows the percent of cache memory allocated for posted
                            write caching.  If the data cannot be determined or is not
                            applicable, the value is set to 4,294,967,295."
                        ::= { cpqDaAccelEntry 14 }
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
        -
          uuid: 00356e1fa16e45708f2965534674f18f
          name: 'Drive Array Controller Performance Monitors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.232.3.2.7.1.1.1]'
          key: 'snmp.discovery[DaControllerPerf]'
          delay: '28800'
          lifetime: '0'
          description: |
            Walk the cpqDaCntlrPerfCntlrIndex table to find contoller performance monitor instances:
            
            CPQIDA-MIB::
                 cpqDaCntlrPerfCntlrIndex OBJECT-TYPE
                    SYNTAX  INTEGER
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "Drive Array Controller Performance Monitor Controller Index.
            
                        This maps the performance monitor information into their
                        respective controllers which support performance data."
                    ::= { cpqDaCntlrPerfEntry 1 }
          item_prototypes:
            -
              uuid: b4100e14f3fb419b985c4eafcc912594
              name: 'HP Drive Array Controller Latency {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.7.1.1.7.{#SNMPINDEX}'
              key: 'cpqDaCntlrPerfAvgLatency[{#SNMPINDEX}]'
              delay: '3600'
              value_type: FLOAT
              units: ms
              description: |
                CPQIDA-MIB::
                     cpqDaCntlrPerfAvgLatency OBJECT-TYPE
                        SYNTAX  INTEGER
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Array Controller Performance Monitor Average
                            Command Latency.
                
                            This value shows the average command latency for this sample
                            in 1/100,000 second units."
                        ::= { cpqDaCntlrPerfEntry 7 }
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '.01'
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
        -
          uuid: 969daa3ebf1e44a48975a3e220312741
          name: 'Drive Array Controllers'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.232.3.2.2.1.1.20]'
          key: 'snmp.discovery[DaControllers]'
          delay: '3600'
          lifetime: '0'
          description: |
            Walk the cpqDaCntlrHwLocation table to get contoller locations:
            
            CPQIDA-MIB::
                 cpqDaCntlrHwLocation OBJECT-TYPE
                    SYNTAX  DisplayString (SIZE (0..255))
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "A text description of the hardware location of the controller.
                         A NULL string indicates that the hardware location could not
                         be determined or is irrelevant."
                    ::= { cpqDaCntlrEntry 20  }
          item_prototypes:
            -
              uuid: 99e8ae14a4ba4e41bb09c08dfd652c40
              name: 'HP Drive Array Controller Board Condition {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.2.1.1.12.{#SNMPINDEX}'
              key: 'cpqDaCntlrBoardCondition[{#SNMPINDEX}]'
              delay: '600'
              history: 7d
              trends: 30d
              description: |
                CPQIDA-MIB::     
                     cpqDaCntlrBoardCondition OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            ok(2),
                            degraded(3),
                            failed(4)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "The condition of the device.  This value represents the
                            condition of the controller and any associated array
                            accelerators."
                        ::= { cpqDaCntlrEntry 12 }
              valuemap:
                name: cpqCondition
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
              trigger_prototypes:
                -
                  uuid: b5da9932256d474a803419270f0d703a
                  expression: 'last(/HP_SNMP_Autodiscovery/cpqDaCntlrBoardCondition[{#SNMPINDEX}])>2'
                  name: '{HOST.NAME}: HP Drive Array Controller Board {#SNMPINDEX} is degraded or failed'
                  priority: AVERAGE
                  description: |
                    This HP Drive Array Controller Controller Board is reporting a degraded or failed condition.  Check the iLO or preferably the HP System Management Homepage for more information.  This may require first starting the Array Configuration Utility from the command line ("/opt/compaq/cpqacuxe/bld/cpqacuxe -R")
                    
                    HP System Management Homepage (may require starting service hpsmhd):
                    https://{HOST.CONN}:2381
            -
              uuid: 119b2889b77749b79564ca208086bf20
              name: 'HP Drive Array Controller Condition {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.2.1.1.6.{#SNMPINDEX}'
              key: 'cpqDaCntlrCondition[{#SNMPINDEX}]'
              delay: '600'
              history: 7d
              trends: 30d
              description: |
                CPQIDA-MIB::     
                     cpqDaCntlrCondition OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            ok(2),
                            degraded(3),
                            failed(4)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "The condition of the device.  This value represents the overall
                            condition of this controller, and any associated logical drives,
                            physical drives, and array accelerators."
                        ::= { cpqDaCntlrEntry 6 }
              valuemap:
                name: cpqCondition
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: b87c048d16304a449415520f34c4463c
              name: 'HP Drive Array Controller Drive Write Cache State {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.2.1.1.27.{#SNMPINDEX}'
              key: 'cpqDaCntlrDriveWriteCacheState[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: 1d
              description: |
                CPQIDA-MIB::     
                     cpqDaCntlrDriveWriteCacheState OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            disabled(2),
                            enabled(3)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Array Controller Drive Write Cache State.
                
                            This is the controller's drive write cache setting.  The
                            following values are valid:
                
                            other (1)
                              Indicates that the instrument agent does not recognize the
                              value.  You may need to upgrade the instrument agent.
                
                            disabled (2)
                              The controller will disable drive write cache for all drives.
                
                            enabled (3)
                              The controller will enable drive write cache for all drives."
                        ::= { cpqDaCntlrEntry 27 }
              valuemap:
                name: cpqDaCntlrDriveWriteCacheState
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: 6bf047e9cd174977a388a50ef425ba15
              name: 'HP Drive Array Controller Firmware Revision {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.232.3.2.2.1.1.3.{#SNMPINDEX}'
              key: 'cpqDaCntlrFWRev[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: '0'
              value_type: TEXT
              description: |
                CPQIDA-MIB::     
                     cpqDaCntlrFWRev OBJECT-TYPE
                        SYNTAX  DisplayString (SIZE (0..5))
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Array Controller Firmware Revision.
                
                            The firmware revision of the drive array controller. This
                            value can be used to help identify a particular revision
                            of the controller."
                        ::= { cpqDaCntlrEntry 3 }
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
        -
          uuid: 99cad2e670c04275bfbf2a9d6d502c08
          name: Firmware
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.232.11.2.14.1.1.4]'
          key: 'snmp.discovery[firmware]'
          delay: '28800'
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: (Lights.Out|iLO|System.ROM)
                formulaid: A
          lifetime: '0'
          description: |
            Walk the cpqHoFwVerDisplayName table, filter for "Lights Out", "iLO" and "System ROM"
            
            CPQHLTH-MIB::
                cpqHoFwVerDisplayName OBJECT-TYPE
                    SYNTAX  DisplayString (SIZE (0..127))
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "Firmware Version Device Display Name.
            
                        This is the display name of the device containing the firmware."
                    ::= { cpqHoFwVerEntry 4 }
          item_prototypes:
            -
              uuid: d384000c50634668a9f3b92fd170c2e9
              name: 'HP Firmware Version {#SNMPINDEX} - {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.11.2.14.1.1.5.{#SNMPINDEX}'
              key: 'cpqHoFwVerVersion[{#SNMPINDEX}]'
              delay: '28800'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                CPQHOST-MIB::
                    cpqHoFwVerVersion OBJECT-TYPE
                        SYNTAX  DisplayString (SIZE (0..31))
                        ACCESS read-only
                        STATUS mandatory
                        DESCRIPTION
                            "Firmware Version.
                
                            This is the version of the device firmware."
                        ::= { cpqHoFwVerEntry 5 }
              tags:
                -
                  tag: Application
                  value: 'HP System Info'
        -
          uuid: 257033fd67ca4e38a31a68204b8389b4
          name: 'Logical Drives'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.232.3.2.3.1.1.14]'
          key: 'snmp.discovery[logicalDrives]'
          delay: '3600'
          lifetime: '0'
          description: |
            Walk the cpqDaLogDrvOsName table to get logical drive OS names:
            
            CPQIDA-MIB::
                 cpqDaLogDrvOsName OBJECT-TYPE
                    SYNTAX  DisplayString (SIZE (0..255))
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "Logical Drive OS Name.
            
                        The OS name for this array logical drive.  This field will be
                        a null (size 0) string if the agent does not support OS name."
                    ::= { cpqDaLogDrvEntry 14 }
          item_prototypes:
            -
              uuid: 5dcf6c2f7f234751a399767afe91b00c
              name: 'HP Logical Drive Condition {#SNMPINDEX} [{#SNMPVALUE}]'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.3.1.1.11.{#SNMPINDEX}'
              key: 'cpqDaLogDrvCondition[{#SNMPINDEX}]'
              delay: '300'
              history: 7d
              trends: 90d
              description: |
                CPQIDA-MIB::
                     cpqDaLogDrvCondition OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            ok(2),
                            degraded(3),
                            failed(4)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "The Logical Drive condition.
                
                            This value represents the overall condition of this logical drive and
                            any associated physical drives."
                        ::= { cpqDaLogDrvEntry 11 }
              valuemap:
                name: cpqCondition
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
              trigger_prototypes:
                -
                  uuid: 80f5cecdb56d4872a6db3d0dc1050b7a
                  expression: 'last(/HP_SNMP_Autodiscovery/cpqDaLogDrvCondition[{#SNMPINDEX}])=4'
                  name: '{HOST.NAME}: Logical Drive {#SNMPINDEX} [{#SNMPVALUE}] has failed'
                  priority: HIGH
                  description: |
                    This logical drive drive (volume) has failed.  For more information, go to the system management homepage, then check the array configuration utility (may need to be started from the command line first).  This alert is very serious (data has been lost) because failure of a logical drive (in RAID configuration with redundancy) is normally caused by multiple physical drive failures.
                    
                    HP System Management Homepage (may require starting service hpsmhd):
                    https://{HOST.CONN}:2381
                -
                  uuid: 83f915eeb4f04d279af91fdfb85b324b
                  expression: 'last(/HP_SNMP_Autodiscovery/cpqDaLogDrvCondition[{#SNMPINDEX}])=3'
                  name: '{HOST.NAME}: Logical Drive {#SNMPINDEX} [{#SNMPVALUE}] is degraded'
                  priority: WARNING
                  description: |
                    This logical drive drive (volume) is degraded.  For more information, go to the system management homepage, then check the array configuration utility (may need to be started from the command line first).
                    
                    This alert normally is normally means that redundancy has been lost because an underlying physical drive has failed.  This means that now a single drive failure could cause data loss.  This alert is normally accompanied by an alert from the physical drive which has failed.   Suggested actions are to write a ticket to replace the failed physical drive, then acknowledge the physical and logical drive alerts, writing the ticket number in the notes.
                    
                    HP System Management Homepage (may require starting service hpsmhd):
                    https://{HOST.CONN}:2381
            -
              uuid: aed63ab0c3b34d6caab794ec257ea47c
              name: 'HP Logical Drive Fault Tolerance {#SNMPINDEX} [{#SNMPVALUE}]'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.3.1.1.3.{#SNMPINDEX}'
              key: 'cpqDaLogDrvFaultTol[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: 7d
              description: |
                CPQIDA-MIB::
                   cpqDaLogDrvFaultTol OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            none(2),
                            mirroring(3),
                            dataGuard(4),
                            distribDataGuard(5),
                            advancedDataGuard(7),
                            raid50 (8),
                            raid60 (9)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Logical Drive Fault Tolerance.
                
                            This shows the fault tolerance mode of the logical drive.
                            The following values are valid for the Logical Drive Fault
                            Tolerance:
                
                            None (2)
                              Fault tolerance is not enabled.  If a physical drive reports
                              an error, the data cannot be recovered by the drive array
                              controller.
                
                            Mirroring - RAID 1/RAID 1+0 (3)
                              For each physical drive, there is a second physical drive
                              containing identical data. If a drive fails, the data can be
                              retrieved from the mirror drive. 
                
                            Data Guard - RAID 4 (4)
                              One of the physical drives is used as a data guard drive and
                              contains the exclusive OR of the data on the remaining drives.
                              If a failure is detected, the drive array controller rebuilds
                              the data using the data guard information plus information
                              from the other drives.
                
                            Distributed Data Guard - RAID 5 (5)
                              Distributed Data Guarding, sometimes referred to as RAID 5,
                              is similar to Data Guarding, but instead of storing the parity
                              information on one drive, the information is distributed across
                              all of the drives.  If a failure is detected, the drive array
                              controller rebuilds the data using the data guard information
                              from all the drives.
                
                            Advanced Data Guarding - RAID 6 (7)
                              Advanced Data Guarding (RAID ADG) is the fault tolerance method
                              that provides the highest level of data protection.  It
                              'stripes' data and parity across all the physical drives in the
                              configuration to ensure the uninterrupted availability of
                              uncorrupted data.  This fault-tolerance method is similar to
                              distributed data guard (RAID 5) in that parity data is
                              distributed across all drives in the array, except in RAID ADG
                              the capacity of multiple drives is used to store parity data.
                              Assuming the capacity of 2 drives is used for parity data,
                              this allows continued operation despite simultaneous failure of
                              any 2 drives in the array, whereas RAID 4 and RAID 5 can only
                              sustain failure of a single drive.
                
                           RAID 50 (8)
                              Distributed data guarding (RAID 5) with multiple parity groups.
                
                           RAID 60 (9)
                              Advanced data guarding (RAID 6) with multiple parity groups."
                        ::= { cpqDaLogDrvEntry 3 }
              valuemap:
                name: cpqDaLogDrvFaultTol
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: 269f47d319ae419881f2a45170093745
              name: 'HP Logical Drive Size {#SNMPINDEX} [{#SNMPVALUE}]'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.3.1.1.9.{#SNMPINDEX}'
              key: 'cpqDaLogDrvSize[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: 7d
              units: B
              description: |
                CPQIDA-MIB::
                     cpqDaLogDrvSize OBJECT-TYPE
                        SYNTAX  INTEGER (0..2147483647)
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Logical Drive Size.
                
                            This is the size of the logical drive in megabytes.  This value
                            is calculated using the value 1,048,576 (2^20) as a megabyte.
                            Drive manufacturers sometimes use the number 1,000,000 as a
                            megabyte when giving drive capacities so this value may
                            differ from the advertised size of a drive."
                        ::= { cpqDaLogDrvEntry 9 }
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
        -
          uuid: a89227a547ea475c8efa1a7545f47e88
          name: 'Memory Modules'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.232.6.2.14.13.1.19]'
          key: 'snmp.discovery[memoryModules]'
          delay: '3600'
          status: DISABLED
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: '^[^2]'
                formulaid: A
          lifetime: '0'
          description: |
            Enable this discovery rule to monitor each memory module (i.e. to show which modules are installed in which sockets).  If this rule is enabled, disable the top-level item "HP Resilient Memory Condition" so you don''t get 2 alerts in the event of a memory failure.
            
            If you don't need monitoring of individual memory modules, leave this disabled, and leave the top-level item "HP Resilient Memory Condition" enabled.
            
            
            Walk the cpqHeResMem2ModuleStatus, filter out any modules which are "notPresent(2)"
            
            CPQHLTH-MIB::
                cpqHeResMem2ModuleStatus OBJECT-TYPE
                    SYNTAX  INTEGER {
                        other(1),
                        notPresent(2),
                        present(3),
                        good(4),
                        add(5),
                        upgrade(6),
                        missing(7),
                        doesNotMatch(8),
                        notSupported(9),
                        badConfig(10),
                        degraded(11)
          item_prototypes:
            -
              uuid: 3bc14eb84a5f48b6bfe6fca6e39f013b
              name: 'HP Memory Module CPU Number [{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.14.13.1.3.{#SNMPINDEX}'
              key: 'cpqHeResMem2CpuNum[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: 1d
              description: |
                CPQHLTH-MIB::
                    cpqHeResMem2CpuNum OBJECT-TYPE
                        SYNTAX  INTEGER
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "The memory module CPU number. Value 0 means memory is not Processor based."
                        ::= { cpqHeResMem2ModuleEntry 3 }
              tags:
                -
                  tag: Application
                  value: 'Memory Modules'
            -
              uuid: 651b6ae0ffa442a4b4d0dde46ca1c1a2
              name: 'HP Memory Module Condition [{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.14.13.1.20.{#SNMPINDEX}'
              key: 'cpqHeResMem2ModuleCondition[{#SNMPINDEX}]'
              delay: '300'
              history: 7d
              trends: 30d
              description: |
                CPQHLTH-MIB::
                    cpqHeResMem2ModuleCondition OBJECT-TYPE
                        SYNTAX  INTEGER {
                            other(1),
                            ok(2),
                            degraded(3),
                            degradedModuleIndexUnknown(4)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                             "This provides the current status of the correctable memory
                              errors for this memory module.
                
                              The following status values are supported:
                
                                 other(1):
                                   ECC is not supported on this memory module or the
                                   condition could not be determined.
                
                                 ok(2):
                                   The memory module is operating normally.
                
                                 degraded(3):
                                   The memory module is correctable error count has exceeded
                                   threshold or a configuration error has been detected.
                
                                 degradedModuleIndexUnknown(4):
                                   The correctable error count has exceeded threshold.
                                   The module number not available."
                        ::= { cpqHeResMem2ModuleEntry 20 }
              valuemap:
                name: cpqCondition
              tags:
                -
                  tag: Application
                  value: 'Memory Modules'
            -
              uuid: 82b7e350d02040159bc0a347f685a1b6
              name: 'HP Memory Module Number [{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.14.13.1.5.{#SNMPINDEX}'
              key: 'cpqHeResMem2ModuleNum[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: 1d
              description: |
                CPQHLTH-MIB::
                    cpqHeResMem2ModuleNum OBJECT-TYPE
                        SYNTAX  INTEGER
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "The memory module number."
                        ::= { cpqHeResMem2ModuleEntry 5 }
              tags:
                -
                  tag: Application
                  value: 'Memory Modules'
            -
              uuid: 9fd0356e81b545969ce82e84facb0167
              name: 'HP Memory Module Size [{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.14.13.1.6.{#SNMPINDEX}'
              key: 'cpqHeResMem2ModuleSize[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: 1d
              units: B
              description: |
                CPQHLTH-MIB::
                    cpqHeResMem2ModuleSize OBJECT-TYPE
                        SYNTAX  INTEGER (0..2147483647)
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Module memory size in kilobytes.  A kilobyte of memory is
                            defined as 1024 bytes.
                
                            A size of 0 indicates the module is not present."
                        ::= { cpqHeResMem2ModuleEntry 6 }
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1024'
              tags:
                -
                  tag: Application
                  value: 'Memory Modules'
          trigger_prototypes:
            -
              uuid: b1c4a40ad8b345e5b0f8a94ba7bc5afb
              expression: 'last(/HP_SNMP_Autodiscovery/cpqHeResMem2ModuleCondition[{#SNMPINDEX}])>2 and last(/HP_SNMP_Autodiscovery/cpqHeResMem2ModuleNum[{#SNMPINDEX}])<>99 and last(/HP_SNMP_Autodiscovery/cpqHeResMem2CpuNum[{#SNMPINDEX}])<>99'
              name: '{HOST.NAME}: Memory Module {#SNMPINDEX} is degraded'
              priority: AVERAGE
              description: |
                The correctable error count for this memory module has been exceeded.  It needs to be replaced.  Suggested actions are to write a ticket to replace the module, then acknowledge the alert, writing the ticket number in the notes.
                
                HP System Management Homepage (may require starting service hpsmhd):
                https://{HOST.CONN}:2381
        -
          uuid: 31d507955e33493489af356d3665c51a
          name: 'Physical Drives'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.232.3.2.5.1.1.64]'
          key: 'snmp.discovery[physicalDrives]'
          delay: '3600'
          lifetime: '0'
          description: |
            Walk the cpqDaPhyDrvLocationString table to get drive locations:
            
            CPQIDA-MIB::
                 cpqDaPhyDrvLocationString OBJECT-TYPE
                    SYNTAX  DisplayString (SIZE (0..255))
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                       "Physical Drive Location String.
            
                        This string describes the location of the drive in relation to
                        the controller.  If the location string cannot be determined,
                        the agent will return a NULL string."
                    ::= { cpqDaPhyDrvEntry 64 }
          item_prototypes:
            -
              uuid: ea123336c0134f9db8cae5ad0829a587
              name: 'HP Physical Drive Condition {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.37.{#SNMPINDEX}'
              key: 'cpqDaPhyDrvCondition[{#SNMPINDEX}]'
              delay: '300'
              history: 7d
              trends: 90d
              description: |
                CPQIDA-MIB::
                     cpqDaPhyDrvCondition OBJECT-TYPE
                        SYNTAX  INTEGER
                        {
                            other(1),
                            ok(2),
                            degraded(3),
                            failed(4)
                        }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "The condition of the device.
                             This value represents the overall condition of this physical
                             drive."
                        ::= { cpqDaPhyDrvEntry 37 }
              valuemap:
                name: cpqCondition
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
              trigger_prototypes:
                -
                  uuid: 0f5111a02f034bf4b1f9d5c9a8a8f371
                  expression: 'last(/HP_SNMP_Autodiscovery/cpqDaPhyDrvCondition[{#SNMPINDEX}])=4'
                  name: '{HOST.NAME}: Drive {#SNMPINDEX} has failed [{#SNMPVALUE}]'
                  priority: AVERAGE
                  description: |
                    This drive has failed.  It needs to be replaced.  This alert will normally be accompanied by an alert from a logical drive which has now lost redundancy. This means that now a single drive failure can cause data loss.  Suggested actions are to write a ticket to replace the failed physical drive, then acknowledge the physical and logical drive alerts, writing the ticket number in the notes.
                    
                    HP System Management Homepage (may require starting service hpsmhd):
                    https://{HOST.CONN}:2381
                -
                  uuid: 55e83dedf2cf414e8961c7ce34f7217a
                  expression: 'last(/HP_SNMP_Autodiscovery/cpqDaPhyDrvCondition[{#SNMPINDEX}])=3'
                  name: '{HOST.NAME}: Drive {#SNMPINDEX} is degraded [{#SNMPVALUE}]'
                  priority: WARNING
                  description: |
                    This drive is degraded (may mean predictive failure).  It should be replaced.  Suggested actions are to write a ticket to replace the drive, then acknowledge the alert, writing the ticket number in the notes.
                    
                    HP System Management Homepage (may require starting service hpsmhd):
                    https://{HOST.CONN}:2381
            -
              uuid: f51cea5b54a24c0aaf6a2fe458e8da11
              name: 'HP Physical Drive Reads/Sec {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.11.{#SNMPINDEX}'
              key: 'cpqDaPhyDrvReadsSec[{#SNMPINDEX}]'
              delay: '60'
              history: 30d
              units: reads/s
              description: |
                Number of sector reads/sec
                
                CPQIDA-MIB::
                     cpqDaPhyDrvReads OBJECT-TYPE
                        SYNTAX  Counter
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Sectors Read (low).
                
                            The phyDrvHReads and the phyDrvReads together shows
                            the total number of sectors read from the physical disk drive
                            during the reference time (phyDrvRefHours).
                
                            The actual number of sectors read equals the phyDrvHReads
                            times 2^32 plus the phyDrvReads.
                
                            This information may be useful for determining rates.
                            For instance, if you wanted to calculate the average number
                            of reads per hour of operation, divide this number by the
                            reference hours."
                        ::= { cpqDaPhyDrvEntry 11 }
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: 5219c965b65542f291fbc84d1f7d51db
              name: 'HP Physical Drive Total Bytes Read {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.11.{#SNMPINDEX}'
              key: 'cpqDaPhyDrvReads[{#SNMPINDEX}]'
              delay: '600'
              history: 7d
              units: B
              description: |
                Running total of number of bytes read from this drive.  Wraps every 2TB.
                
                CPQIDA-MIB::
                     cpqDaPhyDrvReads OBJECT-TYPE
                        SYNTAX  Counter
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Sectors Read (low).
                
                            The phyDrvHReads and the phyDrvReads together shows
                            the total number of sectors read from the physical disk drive
                            during the reference time (phyDrvRefHours).
                
                            The actual number of sectors read equals the phyDrvHReads
                            times 2^32 plus the phyDrvReads.
                
                            This information may be useful for determining rates.
                            For instance, if you wanted to calculate the average number
                            of reads per hour of operation, divide this number by the
                            reference hours."
                        ::= { cpqDaPhyDrvEntry 11 }
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '512'
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: ee0f51812a3041a1ade06f7bbafce5c3
              name: 'HP Physical Drive Serial Number {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.51.{#SNMPINDEX}'
              key: 'cpqDaPhyDrvSerialNum[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: '0'
              value_type: TEXT
              description: |
                CPQIDA-MIB::
                     cpqDaPhyDrvSerialNum OBJECT-TYPE
                        SYNTAX  DisplayString (SIZE (0..40))
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Physical Drive Serial Number.
                
                            This is the serial number assigned to the physical drive.
                            This value is based upon the serial number as returned by the
                            SCSI inquiry command but may have been modified due to space
                            limitations.  This can be used for identification purposes."
                        ::= { cpqDaPhyDrvEntry 51 }
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: e31e947b7e114637a863d95f15a5a1cf
              name: 'HP Physical Drive Size {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.45.{#SNMPINDEX}'
              key: 'cpqDaPhyDrvSize[{#SNMPINDEX}]'
              delay: '28800'
              history: 1d
              trends: 7d
              units: B
              description: |
                CPQIDA-MIB::
                     cpqDaPhyDrvSize OBJECT-TYPE
                        SYNTAX  INTEGER
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Physical Drive Size in MB.
                
                            This is the size of the physical drive in megabytes.  This value
                            is calculated using the value 1,048,576 (2^20) as a megabyte.
                            Drive manufacturers sometimes use the number 1,000,000 as a
                            megabyte when giving drive capacities so this value may differ
                            from the advertised size of a drive.  This field is only
                            applicable for controllers which support SCSI drives, and
                            therefore is not supported by the IDA or IDA-2 controllers.
                            The field will contain 0xFFFFFFFF if the drive capacity cannot
                            be calculated or if the controller does not support SCSI drives."
                        ::= { cpqDaPhyDrvEntry 45 }
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: ae250f81391c4bd6a08f02545354e43b
              name: 'HP Physical Drive Writes/Sec {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.13.{#SNMPINDEX}'
              key: 'cpqDaPhyDrvWritesSec[{#SNMPINDEX}]'
              delay: '60'
              history: 30d
              units: writes/s
              description: |
                Number of sector writes/sec
                
                CPQIDA-MIB::
                     cpqDaPhyDrvWrites OBJECT-TYPE
                        SYNTAX  Counter
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Sectors Written (low).
                
                            The phyDrvHWrites and the phyDrvWrites together
                            shows the total number of sectors written to the physical
                            disk drive during the reference hours (phyDrvRefHours).
                
                            The actual number of sectors written equals the phyDrvHWrites
                            times 2^32 plus the phyDrvWrites.
                
                            This information may be useful for determining rates.
                            For instance, if you wanted to calculate the average number of
                            writes per hour of operation, divide this number by the reference
                            hours. "
                        ::= { cpqDaPhyDrvEntry 13 }
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
            -
              uuid: c05b32ecac9f4cfb801b987799a44e0a
              name: 'HP Physical Drive Total Bytes Written {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.13.{#SNMPINDEX}'
              key: 'cpqDaPhyDrvWrites[{#SNMPINDEX}]'
              delay: '600'
              history: 7d
              units: B
              description: |
                Running total of number of bytes written to this drive.  Wraps every 2TB.
                
                CPQIDA-MIB::
                     cpqDaPhyDrvWrites OBJECT-TYPE
                        SYNTAX  Counter
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "Sectors Written (low).
                
                            The phyDrvHWrites and the phyDrvWrites together
                            shows the total number of sectors written to the physical
                            disk drive during the reference hours (phyDrvRefHours).
                
                            The actual number of sectors written equals the phyDrvHWrites
                            times 2^32 plus the phyDrvWrites.
                
                            This information may be useful for determining rates.
                            For instance, if you wanted to calculate the average number of
                            writes per hour of operation, divide this number by the reference
                            hours. "
                        ::= { cpqDaPhyDrvEntry 13 }
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '512'
              tags:
                -
                  tag: Application
                  value: 'HP Drive Array'
        -
          uuid: fe1e5429a2a24d239fdcd2ff11b515b8
          name: 'Power Supplies'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.232.6.2.9.3.1.3]'
          key: 'snmp.discovery[powerSupplies]'
          delay: '3600'
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: '^[^2]'
                formulaid: A
          lifetime: '0'
          description: |
            Walk the cpqHeFltTolPowerSupplyPresent table, filter out any modules which are "absent(2)"
            
            CPQHLTH-MIB::
                cpqHeFltTolPowerSupplyPresent OBJECT-TYPE
                    SYNTAX  INTEGER {
                        other(1),
                        absent(2),
                        present(3)
                        }
                    ACCESS  read-only
                    STATUS  mandatory
                    DESCRIPTION
                        "Indicates whether the power supply is present in the chassis."
                    ::= { cpqHeFltTolPowerSupplyEntry 3 }
          item_prototypes:
            -
              uuid: 5e6aed9d782d439a822406203798b0b1
              name: 'HP Power Supply Condition {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.9.3.1.4.{#SNMPINDEX}'
              key: 'cpqHeFltTolPowerSupplyCondition[{#SNMPINDEX}]'
              delay: '300'
              history: 7d
              trends: 30d
              description: |
                CPQHLTH-MIB::
                    cpqHeFltTolPowerSupplyCondition OBJECT-TYPE
                        SYNTAX  INTEGER {
                            other(1),
                            ok(2),
                            degraded(3),
                            failed(4)
                            }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "The condition of the power supply.
                
                            This value will be one of the following:
                
                            other(1)
                              The status could not be determined or not present.
                
                            ok(2)
                              The power supply is operating normally.
                
                            degraded(3)
                              A temperature sensor, fan or other power supply component is
                              outside of normal operating range.
                
                            failed(4)
                              A power supply component detects a condition that could
                              permanently damage the system."
                        ::= { cpqHeFltTolPowerSupplyEntry 4 }
              valuemap:
                name: cpqCondition
              tags:
                -
                  tag: Application
                  value: 'HP Health'
              trigger_prototypes:
                -
                  uuid: 33e4a367043c4ddcbcc04333e0f7569d
                  expression: 'last(/HP_SNMP_Autodiscovery/cpqHeFltTolPowerSupplyCondition[{#SNMPINDEX}])=4'
                  name: '{HOST.NAME}: Power Supply {#SNMPINDEX} has failed'
                  priority: AVERAGE
                  description: |
                    This power supply is reporting that it has failed.  This could mean that the supply has failed and needs replacement, or it could also mean that there is no input power due to a cabling problem.  Check to make sure that there is power going to this supply, if so it has failed and needs to be replaced.
                    
                    HP System Management Homepage (may require starting service hpsmhd):
                    https://{HOST.CONN}:2381
                -
                  uuid: fa59d3b7cc44411f80389c583cfb6a45
                  expression: 'last(/HP_SNMP_Autodiscovery/cpqHeFltTolPowerSupplyCondition[{#SNMPINDEX}])=3'
                  name: '{HOST.NAME}: Power Supply {#SNMPINDEX} is degraded'
                  priority: WARNING
                  description: |
                    This power supply is reporting a degraded condition.  This could mean that a fan has failed, or a termperature reading is too high.  Check the iLO or system management homepage for more information. If a fan has failed, it needs to be replaced.
                    
                    HP System Management Homepage (may require starting service hpsmhd):
                    https://{HOST.CONN}:2381
            -
              uuid: 089d44e424714a97a1ffb32e73a7737c
              name: 'HP Power Supply Redundant {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.9.3.1.9.{#SNMPINDEX}'
              key: 'cpqHeFltTolPowerSupplyRedundant[{#SNMPINDEX}]'
              delay: '3600'
              history: 7d
              trends: 30d
              description: |
                CPQHLTH-MIB::
                    cpqHeFltTolPowerSupplyRedundant OBJECT-TYPE
                        SYNTAX  INTEGER {
                            other(1),
                            notRedundant(2),
                            redundant(3)
                            }
                        ACCESS  read-only
                        STATUS  mandatory
                        DESCRIPTION
                            "The redundancy state of the power supply.
                
                            This value will be one of the following:
                            other(1)
                              The redundancy state could not be determined.
                
                            notRedundant(2)
                              The power supply is not operating in a redundant state.
                
                            redundant(3)
                              The power supply is operating in a redundant state."
                        ::= { cpqHeFltTolPowerSupplyEntry 9 }
              valuemap:
                name: cpqRedundant
              tags:
                -
                  tag: Application
                  value: 'HP Health'
      valuemaps:
        -
          uuid: 29d83f2991d74930a1c481446792c904
          name: cpqCondition
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: OK
            -
              value: '3'
              newvalue: degraded
            -
              value: '4'
              newvalue: failed
        -
          uuid: baf7bb795f9b45cbb32479f0f9a0418e
          name: cpqDaAccelBackupPowerSource
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: battery
            -
              value: '3'
              newvalue: capacitor
            -
              value: '4'
              newvalue: 'Flash-Backed Write Cache'
        -
          uuid: 9a19b72a8160434fa8bea319c3dde0a7
          name: cpqDaAccelBatteryStatus
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: ok
            -
              value: '3'
              newvalue: recharging
            -
              value: '4'
              newvalue: failed
            -
              value: '5'
              newvalue: degraded
            -
              value: '6'
              newvalue: notPresent
            -
              value: '7'
              newvalue: capacitorFailed
        -
          uuid: 168e6af6066d491291cfc32034fd7339
          name: cpqDaAccelStatus
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: invalid
            -
              value: '3'
              newvalue: enabled
            -
              value: '4'
              newvalue: tmpDisabled
            -
              value: '5'
              newvalue: permDisabled
            -
              value: '6'
              newvalue: cacheModFlashMemNotAttached
            -
              value: '7'
              newvalue: cacheModDegradedFailsafeSpeed
            -
              value: '8'
              newvalue: cacheModCriticalFailure
            -
              value: '9'
              newvalue: cacheReadCacheNotMapped
        -
          uuid: 987ffe145337416e84f04f59f0fe2a76
          name: cpqDaCntlrDriveWriteCacheState
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: disabled
            -
              value: '3'
              newvalue: enabled
        -
          uuid: d5488bf60718464eb20ea6363c98f8d3
          name: cpqDaLogDrvFaultTol
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: none
            -
              value: '3'
              newvalue: mirroring
            -
              value: '4'
              newvalue: dataGuard
            -
              value: '5'
              newvalue: distribDataGuard
            -
              value: '7'
              newvalue: advancedDataGuard
            -
              value: '8'
              newvalue: raid50
            -
              value: '9'
              newvalue: raid60
        -
          uuid: 10c24bc1fb8246049eb40b9a3bdb818c
          name: cpqRedundant
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: notRedundant
            -
              value: '3'
              newvalue: redundant
