<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-11-09T08:15:40Z</date>
  <groups>
    <group>
      <name>Supermicro servers</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Supermicro SNMP Superdoctor 5 LLD</template>
      <name>Supermicro SNMP Superdoctor 5 LLD</name>
      <description>## Overview Monitor Supermicro servers by snmp vs SuperDoctor5 (SD5). Monitored items: 1. Fans (RPM) 2. Physical disks (by hba or LSI raid card (see SD5 documentation)). By default deactivated. * model * serial number (trigger exists) * smart status (trigger exists) 3. Power Supply (ok or not, trigger exists) 4. Temperatures (celsius, trigger exists) 5. Power Supply Input Voltages (for tests, trigger exists). By default deactivated. 6. Memory * model * serial number (trigger exists) * manufacturer * location * error count (trigger exists) * capacity 7. Mainboard * model * bios version (trigger exists) All items is searching by lld (excluding mainboard model and bios version). Filtering if set to not monitored in SD5. Macroses: 1. {$SNMP\_COMMUNITY} 2. {$SUPERMICRO\_DISCOVERY\_TIME} - period of discovering (how often). 3. {$DISC\_DISCOVERY\_TIME} - period of discovering for disks (i suppose that you may change it more often) 4. {$PD\_REQUEST\_PERIOD} - period of requesting data from disks. Regular expressions: 1. Filtering RAID (Result is False, expression - RAID) 2. Filtering Microsoft Storage Space Device (Result is False, expression - Filtering Microsoft Storage Space Device) Value mappings: 1. Supermicro physical disk smart status (0 ⇒ OK 2 ⇒ Critical) 2. Supermicro power supply status (SNMP) (0 ⇒ OK 1 ⇒ Warning 2 ⇒ Critical) I don't use disks in production and power voltages, but i've tested this functions. For using this template you have to configure snmp and install super doctor 5. You can use template as is and make commens with your wishes or other. i will glad to see interesting ideas for upgrading this template.</description>
      <groups>
        <group>
          <name>Supermicro servers</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Supermicro Fans</name>
        </application>
        <application>
          <name>Supermicro Mainboard</name>
        </application>
        <application>
          <name>Supermicro memory</name>
        </application>
        <application>
          <name>Supermicro phisycal disks</name>
        </application>
        <application>
          <name>Supermicro Power Supply</name>
        </application>
        <application>
          <name>Supermicro temperatures</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Supermicro mainboard bios version</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.10876.100.1.5.1.8.1</snmp_oid>
          <key>supermicro_mb_biosversion</key>
          <delay>1d</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>Supermicro Mainboard</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{diff()}=1</expression>
              <name>Supermicro bios was change to {ITEM.LASTVALUE} on {HOST.DNS}</name>
              <priority>INFO</priority>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Supermicro mainboard model</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.10876.100.1.6.1.11.1</snmp_oid>
          <key>supermicro_mb_model</key>
          <delay>1d</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>Supermicro Mainboard</name>
            </application>
          </applications>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>Physical disk</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.10876.100.1.4.1.5]</snmp_oid>
          <key>supermicro_diskmodel</key>
          <delay>{$DISC_DISCOVERY_TIME}</delay>
          <status>DISABLED</status>
          <filter>
            <evaltype>AND</evaltype>
            <conditions>
              <condition>
                <macro>{#SNMPVALUE}</macro>
                <value>@Filtering Microsoft Storage Space Device</value>
                <formulaid>A</formulaid>
              </condition>
              <condition>
                <macro>{#SNMPVALUE}</macro>
                <value>@Filtering RAID</value>
                <formulaid>B</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>Supermicro disk {#SNMPINDEX} model</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.100.1.4.1.5.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_disc_model[{#SNMPINDEX}]</key>
              <delay>{$PD_REQUEST_PERIOD}</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>Supermicro phisycal disks</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Supermicro disk {#SNMPINDEX} smart status</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.100.1.4.1.4.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_disk_smart[{#SNMPINDEX}]</key>
              <delay>{$PD_REQUEST_PERIOD}</delay>
              <applications>
                <application>
                  <name>Supermicro phisycal disks</name>
                </application>
              </applications>
              <valuemap>
                <name>Supermicro physical disk smart status</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}=2</expression>
                  <name>Supermicro physical disk status is {ITEM.LASTVALUE} on {HOST.DNS}</name>
                  <priority>HIGH</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Supermicro disk {#SNMPINDEX} serial number</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.100.1.4.1.1.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_disk_sn[{#SNMPINDEX}]</key>
              <delay>{$PD_REQUEST_PERIOD}</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>Supermicro phisycal disks</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{diff()}=1</expression>
                  <name>Supermicro physical disc was changed to {ITEM.LASTVALUE} on {HOST.DNS}</name>
                  <priority>WARNING</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>FANs</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#MONITEMNAME},.1.3.6.1.4.1.10876.2.1.1.1.1.2, {#MONITEMSTATUS},.1.3.6.1.4.1.10876.2.1.1.1.1.10]</snmp_oid>
          <key>supermicro_fanmonitemid</key>
          <delay>{$SUPERMICRO_DISCOVERY_TIME}</delay>
          <filter>
            <evaltype>AND</evaltype>
            <conditions>
              <condition>
                <macro>{#MONITEMNAME}</macro>
                <value>FAN*</value>
                <formulaid>A</formulaid>
              </condition>
              <condition>
                <macro>{#MONITEMSTATUS}</macro>
                <value>1</value>
                <formulaid>B</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>Supermicro $1 RPMs</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.2.1.1.1.1.4.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_fanrpms[{#MONITEMNAME}]</key>
              <delay>5m</delay>
              <history>30d</history>
              <trends>90d</trends>
              <units>RPM</units>
              <applications>
                <application>
                  <name>Supermicro Fans</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Power Supply Input voltages</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#MONITEMNAME},.1.3.6.1.4.1.10876.2.1.1.1.1.2, {#MONITEMSTATUS},.1.3.6.1.4.1.10876.2.1.1.1.1.10]</snmp_oid>
          <key>supermicro_inpvoltageid</key>
          <delay>{$SUPERMICRO_DISCOVERY_TIME}</delay>
          <status>DISABLED</status>
          <filter>
            <evaltype>AND</evaltype>
            <conditions>
              <condition>
                <macro>{#MONITEMNAME}</macro>
                <value>PS\d ACInputVoltage</value>
                <formulaid>A</formulaid>
              </condition>
              <condition>
                <macro>{#MONITEMSTATUS}</macro>
                <value>1</value>
                <formulaid>B</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>Supermicro $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.2.1.1.1.1.4.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_acinp[{#SNMPVALUE}]</key>
              <delay>5m</delay>
              <value_type>FLOAT</value_type>
              <units>V</units>
              <applications>
                <application>
                  <name>Supermicro Power Supply</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>MULTIPLIER</type>
                  <params>0.001</params>
                </step>
              </preprocessing>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}&lt;220</expression>
                  <name>{#SNMPVALUE} is {ITEM.LASTVALUE} on {HOST.DNS}</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>{HOST.CONN:{#SNMPVALUE} }</name>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Supermicro SNMP Superdoctor 5 LLD</host>
                    <key>supermicro_acinp[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Memory</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.10876.100.1.3.1.1]</snmp_oid>
          <key>supermicro_memory_id</key>
          <delay>{$SUPERMICRO_DISCOVERY_TIME}</delay>
          <item_prototypes>
            <item_prototype>
              <name>Supermicro memory $1 capacity</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.100.1.3.1.11.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_memory_cap[{#SNMPVALUE}]</key>
              <delay>1d</delay>
              <history>30d</history>
              <trends>90d</trends>
              <units>Gb</units>
              <applications>
                <application>
                  <name>Supermicro memory</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>MULTIPLIER</type>
                  <params>0.0009765625</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Supermicro memory $1 error count</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.100.1.3.1.15.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_memory_errcount[{#SNMPVALUE}]</key>
              <delay>1d</delay>
              <history>30d</history>
              <trends>90d</trends>
              <applications>
                <application>
                  <name>Supermicro memory</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}>0</expression>
                  <name>Memory bank on {HOST.DNS} has {ITEM.LASTVALUE} errors</name>
                  <priority>WARNING</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Supermicro memory $1 location</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.100.1.3.1.5.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_memory_location[{#SNMPVALUE}]</key>
              <delay>1d</delay>
              <history>30d</history>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>Supermicro memory</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Supermicro memory $1 manufacturer</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.100.1.3.1.8.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_memory_manufacturer[{#SNMPVALUE}]</key>
              <delay>1d</delay>
              <history>30d</history>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>Supermicro memory</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Supermicro memory $1 model</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.100.1.3.1.9.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_memory_model[{#SNMPVALUE}]</key>
              <delay>1d</delay>
              <history>30d</history>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>Supermicro memory</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Supermicro memory $1 sn</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.100.1.3.1.10.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_memory_sn[{#SNMPVALUE}]</key>
              <delay>1d</delay>
              <history>30d</history>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <applications>
                <application>
                  <name>Supermicro memory</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{diff()}=1</expression>
                  <name>Memory bank on {HOST.DNS} was changed</name>
                  <priority>INFO</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Power Supply</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#MONITEMNAME},.1.3.6.1.4.1.10876.2.1.1.1.1.2, {#MONITEMSTATUS},.1.3.6.1.4.1.10876.2.1.1.1.1.10]</snmp_oid>
          <key>supermicro_psmonitemid</key>
          <delay>{$SUPERMICRO_DISCOVERY_TIME}</delay>
          <filter>
            <evaltype>AND</evaltype>
            <conditions>
              <condition>
                <macro>{#MONITEMNAME}</macro>
                <value>PS\d Status</value>
                <formulaid>A</formulaid>
              </condition>
              <condition>
                <macro>{#MONITEMSTATUS}</macro>
                <value>1</value>
                <formulaid>B</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>Supermicro $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.2.1.1.1.1.4.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_psstatus[{#MONITEMNAME}]</key>
              <delay>15m</delay>
              <applications>
                <application>
                  <name>Supermicro Power Supply</name>
                </application>
              </applications>
              <valuemap>
                <name>Supermicro power supply status (SNMP)</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}=1</expression>
                  <name>{#SNMPVALUE} is {ITEM.LASTVALUE} on {HOST.DNS}</name>
                  <priority>WARNING</priority>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}=2</expression>
                  <name>{#SNMPVALUE} is {ITEM.LASTVALUE} on {HOST.DNS}</name>
                  <priority>HIGH</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Temperatures</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#MONITEMNAME},.1.3.6.1.4.1.10876.2.1.1.1.1.2, {#MONITEMSTATUS},.1.3.6.1.4.1.10876.2.1.1.1.1.10]</snmp_oid>
          <key>supermicro_tempmonitemid</key>
          <delay>{$SUPERMICRO_DISCOVERY_TIME}</delay>
          <filter>
            <evaltype>AND</evaltype>
            <conditions>
              <condition>
                <macro>{#MONITEMNAME}</macro>
                <value>.*Temp*</value>
                <formulaid>A</formulaid>
              </condition>
              <condition>
                <macro>{#MONITEMSTATUS}</macro>
                <value>1</value>
                <formulaid>B</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>Supermicro $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.10876.2.1.1.1.1.4.{#SNMPINDEX}</snmp_oid>
              <key>supermicro_temp[{#MONITEMNAME}]</key>
              <delay>5m</delay>
              <history>30d</history>
              <trends>90d</trends>
              <units>C</units>
              <applications>
                <application>
                  <name>Supermicro temperatures</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}>70</expression>
                  <name>{#SNMPVALUE} is {ITEM.LASTVALUE} on {HOST.DNS}</name>
                  <priority>HIGH</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
      </discovery_rules>
    </template>
  </templates>
  <value_maps>
    <value_map>
      <name>Supermicro physical disk smart status</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>OK</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>Critical</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Supermicro power supply status (SNMP)</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>OK</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Warning</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>Critical</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>