zabbix_export:
  version: '5.4'
  date: '2021-10-22T08:04:45Z'
  groups:
    -
      uuid: e960332b3f6c46a1956486d4f3f99fce
      name: 'Templates/Server hardware'
  templates:
    -
      uuid: 42848ae7b89b474b99f5f2b6ecbffeec
      template: macrosanStorage
      name: macrosanStorage
      description: 宏杉存储监控模板
      groups:
        -
          name: 'Templates/Server hardware'
      items:
        -
          uuid: c7663ba8b1e14e3e868cb4ab415ec73e
          name: 总缓存命中率
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.4.2.7.0
          key: cacheHitsIos
          history: 7d
          units: '%'
          preprocessing:
            -
              type: STR_REPLACE
              parameters:
                - '%'
                - ''
          tags:
            -
              tag: Application
              value: Perf
            -
              tag: Application
              value: space
        -
          uuid: acc8c54fb0834f5c9a5ff8ce7736df93
          name: 可用容量
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.1.5.1.3.0
          key: freecap
          delay: 1h
          history: 7d
          units: B
          preprocessing:
            -
              type: STR_REPLACE
              parameters:
                - GB
                - ''
            -
              type: MULTIPLIER
              parameters:
                - '1073741824'
          tags:
            -
              tag: Application
              value: CAP
            -
              tag: Application
              value: space
        -
          uuid: a5f0d709efde411bb0c1b68a121ea211
          name: readIops
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.4.2.2.0
          key: readIops
          history: 7d
          tags:
            -
              tag: Application
              value: Perf
        -
          uuid: 8a7fead94850451fbcb9709c19b7ec14
          name: readKbps
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.4.2.5.0
          key: readKbps
          history: 7d
          units: bps
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            -
              tag: Application
              value: Perf
        -
          uuid: aefdb16aa3ce4c4f8b7200e540a8e195
          name: 总容量
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.1.5.1.1.0
          key: totalcap
          delay: 1h
          history: 7d
          units: B
          preprocessing:
            -
              type: STR_REPLACE
              parameters:
                - GB
                - ''
            -
              type: MULTIPLIER
              parameters:
                - '1073741824'
          tags:
            -
              tag: Application
              value: CAP
            -
              tag: Application
              value: space
        -
          uuid: 5df51e7ff8de4b4dbd0b6b54607a3e85
          name: totalIops
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.4.2.1.0
          key: totalIops
          history: 7d
          tags:
            -
              tag: Application
              value: Perf
        -
          uuid: c00050f33a244e038accfba197c94ce1
          name: totalKbps
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.4.2.4.0
          key: totalKbps
          history: 7d
          units: bps
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            -
              tag: Application
              value: Perf
        -
          uuid: e67c566c66db4a7aac0a568e05a2d780
          name: 已用容量
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.1.5.1.2.0
          key: usedcap
          delay: 1h
          history: 7d
          units: B
          preprocessing:
            -
              type: STR_REPLACE
              parameters:
                - GB
                - ''
            -
              type: MULTIPLIER
              parameters:
                - '1073741824'
          tags:
            -
              tag: Application
              value: CAP
            -
              tag: Application
              value: space
        -
          uuid: c00b299c59924ca6a7dd0f2284a5470b
          name: 已用容量%
          type: CALCULATED
          key: usedcappercent
          delay: 1h
          history: 7d
          value_type: FLOAT
          units: '%'
          params: 'last(//usedcap)/last(//totalcap)*100'
          tags:
            -
              tag: Application
              value: space
          triggers:
            -
              uuid: 65d8333fb6594111ace02dbc78338525
              expression: last(/macrosanStorage/usedcappercent)>=70
              name: 总使用容量超过70%
              priority: AVERAGE
              manual_close: 'YES'
        -
          uuid: 4fc1994f87094c1ab70b69abb7ae0bb6
          name: writeIops
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.4.2.3.0
          key: writeIops
          history: 7d
          tags:
            -
              tag: Application
              value: Perf
        -
          uuid: d4ea911dc2e24dd59ac79c506898443f
          name: writeKbps
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.35904.1.2.4.2.6.0
          key: writeKbps
          history: 7d
          units: bps
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            -
              tag: Application
              value: Perf
      discovery_rules:
        -
          uuid: ed4e2df714144699a13c74bee362ee9e
          name: 'dis luns'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.35904.1.2.4.3.1.3]'
          key: luns
          delay: 1d
          lifetime: 1d
          description: |
            .iso.org.dod.internet.private.enterprises.macrosan.macrosanStorage.msStorageSystem.msStorageStatus.poolInfo.poolTable
            .iso.org.dod.internet.private.enterprises.macrosan.macrosanStorage.msStorageSystem.msStorageStatus.poolInfo.poolTable
          item_prototypes:
            -
              uuid: 014f3b53f92b404db04bcb7af54f1fab
              name: '{#SNMPVALUE}  缓存命中率'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.35904.1.2.4.3.1.6.{#SNMPINDEX}'
              key: 'luncachehitsIos[{#SNMPVALUE}]'
              history: 7d
              units: '%'
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '%'
                    - ''
              tags:
                -
                  tag: Application
                  value: '{#SNMPVALUE}'
            -
              uuid: fb707ee36df84827bfa4c32cfbf3e654
              name: '{#SNMPVALUE} lunReadAvrDelay'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.35904.1.2.4.3.1.7.{#SNMPINDEX}'
              key: 'lunReadAvrDelay[{#SNMPVALUE}]'
              history: 7d
              units: us
            -
              uuid: 5a96494449684c958b393250c60e2b18
              name: '{#SNMPVALUE}  总吞吐'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.35904.1.2.4.3.1.5.{#SNMPINDEX}'
              key: 'lunreadiops[{#SNMPVALUE}]'
              history: 7d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1024'
            -
              uuid: f012ac3c46c640818c3226085cf2d85f
              name: '{#SNMPVALUE} lunReadMaxDelay'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.35904.1.2.4.3.1.8.{#SNMPINDEX}'
              key: 'lunReadMaxDelay[{#SNMPVALUE}]'
              history: 7d
              units: us
            -
              uuid: e04120d8888d403fadc958560bb30a6e
              name: '{#SNMPVALUE}  totalIops'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.35904.1.2.4.3.1.4.{#SNMPINDEX}'
              key: 'luntotaliops[{#SNMPVALUE}]'
              history: 7d
            -
              uuid: 97fa3c76f88b491e96612844d5179036
              name: '{#SNMPVALUE} lunWriteAvrDelay'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.35904.1.2.4.3.1.9.{#SNMPINDEX}'
              key: 'lunWriteAvrDelay[{#SNMPVALUE}]'
              history: 7d
              units: us
            -
              uuid: ad81e073a86448fb891de621ac7bbfa8
              name: '{#SNMPVALUE} lunWriteMaxDelay'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.35904.1.2.4.3.1.10.{#SNMPINDEX}'
              key: 'lunWriteMaxDelay[{#SNMPVALUE}]'
              history: 7d
              units: us
          trigger_prototypes:
            -
              uuid: 545f6ee4c9854b1c9eef62a491fdd4c2
              expression: |
                last(/macrosanStorage/lunReadAvrDelay[{#SNMPVALUE}])>=10000
                or
                last(/macrosanStorage/lunWriteAvrDelay[{#SNMPVALUE}])>=10000
              name: 延时过高(>10ms)
              priority: AVERAGE
              manual_close: 'YES'
        -
          uuid: 3f10cc093cd64d57a821864ed9104d33
          name: 'dis pools'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.35904.1.2.2.9.2.1.1]'
          key: pools
          delay: 1d
          lifetime: 1d
          description: |
            .iso.org.dod.internet.private.enterprises.macrosan.macrosanStorage.msStorageSystem.msStorageStatus.poolInfo.poolTable
            .iso.org.dod.internet.private.enterprises.macrosan.macrosanStorage.msStorageSystem.msStorageStatus.poolInfo.poolTable
          item_prototypes:
            -
              uuid: 5075c01db9f24ce7b0ce5e010e534d0e
              name: '{#SNMPVALUE}  总容量'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.35904.1.2.2.9.2.1.3.{#SNMPINDEX}'
              key: 'CAP[{#SNMPVALUE} ]'
              delay: 1h
              units: B
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - GB
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '1073741824'
              tags:
                -
                  tag: Application
                  value: POOL
            -
              uuid: 85465b45b12e4ee5b9c10a5f4c8f15ab
              name: '{#SNMPVALUE}  可用容量'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.35904.1.2.2.9.2.1.4.{#SNMPINDEX}'
              key: 'FREECAP[{#SNMPVALUE} ]'
              delay: 1h
              units: B
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - GB
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '1073741824'
              tags:
                -
                  tag: Application
                  value: POOL
            -
              uuid: d0ad698dd4e54c5796705d91cb7f5840
              name: '{#SNMPVALUE}  可用%'
              type: CALCULATED
              key: 'USDEDP[{#SNMPVALUE} ]'
              delay: 1h
              history: 7d
              value_type: FLOAT
              units: '%'
              params: '100-(last(//FREECAP[{#SNMPVALUE}])/last(//CAP[{#SNMPVALUE}])*100)'
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - GB
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '1073741824'
              tags:
                -
                  tag: Application
                  value: POOL
              trigger_prototypes:
                -
                  uuid: 9e236181c22b4d7c9627473be4d3075b
                  expression: 'last(/macrosanStorage/USDEDP[{#SNMPVALUE} ])>80'
                  name: '{#SNMPVALUE} 已用容量大于80%'
                  priority: AVERAGE
                  manual_close: 'YES'
      macros:
        -
          macro: '{$SNMP_COMMUNITY}'
          value: storage
  graphs:
    -
      uuid: 3e7cfb30c7664a02b83cf0214f0f6097
      name: bandwidth
      width: '500'
      graph_items:
        -
          sortorder: '1'
          color: 1A7C11
          item:
            host: macrosanStorage
            key: readKbps
        -
          sortorder: '2'
          color: F63100
          item:
            host: macrosanStorage
            key: totalKbps
        -
          sortorder: '3'
          color: 2774A4
          item:
            host: macrosanStorage
            key: writeKbps
    -
      uuid: 5571a00152d74f49a08dfbcbeacd8d53
      name: iops
      width: '500'
      graph_items:
        -
          sortorder: '1'
          color: 1A7C11
          item:
            host: macrosanStorage
            key: readIops
        -
          sortorder: '2'
          color: F63100
          item:
            host: macrosanStorage
            key: totalIops
        -
          sortorder: '3'
          color: 2774A4
          item:
            host: macrosanStorage
            key: writeIops
