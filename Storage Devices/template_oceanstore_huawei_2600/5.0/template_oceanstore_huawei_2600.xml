<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T08:01:19Z</date>
  <groups>
    <group>
      <name>Templates</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Huawei Storage OceanStor</template>
      <name>Template Huawei Storage OceanStor</name>
      <groups>
        <group>
          <name>Templates</name>
        </group>
      </groups>
      <items>
        <item>
          <name>State of the system</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.34774.4.1.1.3.0</snmp_oid>
          <key>status.0</key>
          <delay>30s</delay>
          <description>Huawei 15-level HEALTH STATUS E (SHD)</description>
          <triggers>
            <trigger>
              <expression>{nodata(5m)}=1</expression>
              <name>No data from SNMP agent</name>
              <status>DISABLED</status>
              <priority>AVERAGE</priority>
            </trigger>
            <trigger>
              <expression>{last()}&lt;>1</expression>
              <name>Problem with SHD</name>
              <priority>AVERAGE</priority>
            </trigger>
          </triggers>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>Controller Detection</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#CONLOCATION},1.3.6.1.4.1.34774.4.1.23.5.2.1.5]</snmp_oid>
          <key>hwInfoController</key>
          <delay>1d</delay>
          <item_prototypes>
            <item_prototype>
              <name>Using the CPU controller: {#CONLOCATION} at %</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.5.2.1.8.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoControllerCPUUsage.[{#SNMPINDEX}]</key>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{avg(15m)}>90</expression>
                  <name>Controller {#CONLOCATION} uses > 90% CPU</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Controller status: {#CONLOCATION}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.5.2.1.2.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoControllerHealthStatus.[{#SNMPINDEX}]</key>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}&lt;>1</expression>
                  <name>problem with the controller:{#CONLOCATION}</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Using the Memory Controller: {#CONLOCATION} at %</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.5.2.1.9.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoControllerMemoryUsage.[{#SNMPINDEX}]</key>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{avg(15m)}>95</expression>
                  <name>Controller {#CONLOCATION} uses > 95% Memory</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Detection Disk Domain</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#DISKDNAME},1.3.6.1.4.1.34774.4.1.23.4.1.1.2]</snmp_oid>
          <key>hwInfoDiskDomain</key>
          <delay>1d</delay>
          <item_prototypes>
            <item_prototype>
              <name>Condition Disk Domain: {#DISKDNAME}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.1.1.3.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoDiskDomainHealthStatus.[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}&lt;>1</expression>
                  <name>Problem with Disk Domain : {#DISKDNAME}</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Running status Disk Domain: {#DISKDNAME}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.1.1.4.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoDiskDomainRunningStatus.[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}&lt;>27</expression>
                  <name>Problem with Disk Domain: {#DISKDNAME}</name>
                  <priority>AVERAGE</priority>
                  <description>SNMP check received status is not Online. Check the status of SHD</description>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Detection Fan BP</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#FANID},1.3.6.1.4.1.34774.4.1.23.5.4.1.1,{#FANLOCATION},1.3.6.1.4.1.34774.4.1.23.5.4.1.2]</snmp_oid>
          <key>hwinfoFANPower</key>
          <delay>1d</delay>
          <item_prototypes>
            <item_prototype>
              <name>Fan condition: {#FANLOCATION}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.5.4.1.3.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoFanHealthStatus.[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}&lt;>1</expression>
                  <name>Problem with BP Fan: {#FANLOCATION}</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Detection LUN</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#LUNID},1.3.6.1.4.1.34774.4.1.23.4.8.1.1,{#LUNNAME},1.3.6.1.4.1.34774.4.1.23.4.8.1.2]</snmp_oid>
          <key>hwInfoLun</key>
          <delay>1d</delay>
          <item_prototypes>
            <item_prototype>
              <name>LUN {#LUNNAME} Capacity in bytes</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.8.1.5.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoLunCapacity.[{#SNMPINDEX}]</key>
              <delay>5m</delay>
            </item_prototype>
            <item_prototype>
              <name>LUN {#LUNNAME} Allocated Capacity at %</name>
              <type>CALCULATED</type>
              <key>hwInfoLunCapacityProc.[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <params>last("hwInfoStoragePoolUsed.[{#SNMPINDEX}]")/last("hwInfoStoragePoolTotal.[{#SNMPINDEX}]")*100</params>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}>85</expression>
                  <name>LUN {#LUNNAME} Allocated Capacity > 85%</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}>95</expression>
                  <name>LUN {#LUNNAME} Allocated Capacity > 95%</name>
                  <priority>HIGH</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>LUN Status {#LUNNAME}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.8.1.9.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoLunHealthStatus.[{#SNMPINDEX}]</key>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}&lt;>1</expression>
                  <name>Problem with LUN {#LUNNAME}</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>LUN {#LUNNAME} Allocated Capacity in bytes</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.8.1.6.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoLunSubscribedCapacity.[{#SNMPINDEX}]</key>
              <delay>5m</delay>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Detection Storage Pool</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#POOLNAME},1.3.6.1.4.1.34774.4.1.23.4.2.1.2]</snmp_oid>
          <key>hwInfoPool</key>
          <delay>1d</delay>
          <item_prototypes>
            <item_prototype>
              <name>Storage Pool: {#POOLNAME} Allocated Capacity at %</name>
              <type>CALCULATED</type>
              <key>hwInfoStoragePoolCapacityProc.[{#SNMPINDEX}]</key>
              <delay>30s</delay>
              <params>last("hwInfoStoragePoolUsed.[{#SNMPINDEX}]")/last("hwInfoStoragePoolTotal.[{#SNMPINDEX}]")*100</params>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}>85</expression>
                  <name>{#POOLNAME} Allocated Capacity > 85%</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}>95</expression>
                  <name>{#POOLNAME} Allocated Capacity > 95%</name>
                  <priority>HIGH</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Condition Storage Pool: {#POOLNAME}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.2.1.5.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoStoragePoolHealthStatus.[{#SNMPINDEX}]</key>
              <delay>30s</delay>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}&lt;>1</expression>
                  <name>Issue with Storage Pool: {#POOLNAME}</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Storage Pool: {#POOLNAME} Capacity in bytes</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.2.1.7.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoStoragePoolTotal.[{#SNMPINDEX}]</key>
              <delay>30s</delay>
            </item_prototype>
            <item_prototype>
              <name>Storage Pool: {#POOLNAME} Allocated Capacity in bytes</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.23.4.2.1.8.{#SNMPINDEX}</snmp_oid>
              <key>hwInfoStoragePoolUsed.[{#SNMPINDEX}]</key>
              <delay>30s</delay>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Detection Performance LUN</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#LUNPID},1.3.6.1.4.1.34774.4.1.21.4.1.1]</snmp_oid>
          <key>hwPerformanceLun</key>
          <delay>1d</delay>
          <item_prototypes>
            <item_prototype>
              <name>LUN {$LUNID{#LUNPID}} Read IOPS</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.4.{#SNMPINDEX}</snmp_oid>
              <key>hwPerfLunReadIOPS.[{#SNMPINDEX}]</key>
            </item_prototype>
            <item_prototype>
              <name>LUN {$LUNID{#LUNPID}} Read bandwidth MB/s</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.7.{#SNMPINDEX}</snmp_oid>
              <key>hwPerfLunReadTraffic.[{#SNMPINDEX}]</key>
            </item_prototype>
            <item_prototype>
              <name>LUN {$LUNID{#LUNPID}} Total IOPS</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.3.{#SNMPINDEX}</snmp_oid>
              <key>hwPerfLunTotalIOPS.[{#SNMPINDEX}]</key>
            </item_prototype>
            <item_prototype>
              <name>LUN {$LUNID{#LUNPID}} Total bandwidth MB/s</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.6.{#SNMPINDEX}</snmp_oid>
              <key>hwPerfLunTotalTraffic.[{#SNMPINDEX}]</key>
            </item_prototype>
            <item_prototype>
              <name>LUN {$LUNID{#LUNPID}} Write IOPS</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.5.{#SNMPINDEX}</snmp_oid>
              <key>hwPerfLunWriteIOPS.[{#SNMPINDEX}]</key>
            </item_prototype>
            <item_prototype>
              <name>LUN {$LUNID{#LUNPID}} Write bandwidth MB/s</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.21.4.1.8.{#SNMPINDEX}</snmp_oid>
              <key>hwPerfLunWriteTraffic.[{#SNMPINDEX}]</key>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Detection Performance Port</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#PORTLOCATION},1.3.6.1.4.1.34774.4.1.21.5.1.11]</snmp_oid>
          <key>hwPortPerformance</key>
          <delay>1d</delay>
          <item_prototypes>
            <item_prototype>
              <name>Port: {#PORTLOCATION} I/O latancy</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.34774.4.1.21.5.1.2.{#SNMPINDEX}</snmp_oid>
              <key>hwPerfPortDelay.[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}>40</expression>
                  <name>I/O latancy Port: {#PORTLOCATION} > 40 ms</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
      </discovery_rules>
    </template>
  </templates>
</zabbix_export>