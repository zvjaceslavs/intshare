zabbix_export:
  version: '5.4'
  date: '2021-11-09T08:54:00Z'
  groups:
    -
      uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    -
      uuid: adedbd0cda614a1f9051676e76315e5c
      template: monitor_Firewall_Juniper_SRX
      name: 瞻博SRX防火墙监控模板
      description: |
        ## Overview
        
        瞻博（Juniper）SRX系列防火墙监控模板
        
        
        已在SRX3600，SRX650完成验证
        
        
        主要包括CPU利用率、内存利用率、端口状态、端口带宽利用率、端口报文速率、CP会话、flow会话、新建会话
        
        
        将宏 {$CLOUD\_SNMP\_COMMUNITY} 替换为实际团体字即可
        
        
        
        ## Author
        
        zhangzhefeng
        
        
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: 9106fc3a264943dd838e231a11324436
          name: ping丢包率
          type: SIMPLE
          key: 'icmppingloss[,10,,,]'
          delay: 5m
          history: 7d
          trends: 0d
          value_type: FLOAT
          units: '%'
          tags:
            -
              tag: Application
              value: ping检测
          triggers:
            -
              uuid: 1af3c2e6d0d041cbb3ad1e5340b07b7d
              expression: 'avg(/monitor_Firewall_Juniper_SRX/icmppingloss[,10,,,],10m)>{$ICMP_LOSS_WARN}'
              name: 'ICMP ping 丢包'
              priority: AVERAGE
              type: MULTIPLE
              manual_close: 'YES'
              dependencies:
                -
                  name: 'ICMP ping不可达'
                  expression: 'last(/monitor_Firewall_Juniper_SRX/icmpping[,5,,,],#1)=0 and last(/monitor_Firewall_Juniper_SRX/icmpping[,5,,,],#2)=1'
        -
          uuid: 881a8b881630446a94739fee3840a7b2
          name: ping时延
          type: SIMPLE
          key: 'icmppingsec[,10,,,,avg]'
          delay: 5m
          history: 7d
          trends: 0d
          value_type: FLOAT
          units: s
          tags:
            -
              tag: Application
              value: ping检测
          triggers:
            -
              uuid: 0e5ffbefa20545be900bec276f3e15d4
              expression: 'min(/monitor_Firewall_Juniper_SRX/icmppingsec[,10,,,,avg],10m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'ICMP ping 时延高'
              priority: AVERAGE
              type: MULTIPLE
              manual_close: 'YES'
              dependencies:
                -
                  name: 'ICMP ping不可达'
                  expression: 'last(/monitor_Firewall_Juniper_SRX/icmpping[,5,,,],#1)=0 and last(/monitor_Firewall_Juniper_SRX/icmpping[,5,,,],#2)=1'
        -
          uuid: f54a2ef2c65844d8b8358b382430f411
          name: 'ICMP ping'
          type: SIMPLE
          key: 'icmpping[,5,,,]'
          history: 7d
          trends: 0d
          tags:
            -
              tag: Application
              value: ping检测
          triggers:
            -
              uuid: 0ad041fe33e4499d9b0e4b449fcf60b5
              expression: 'last(/monitor_Firewall_Juniper_SRX/icmpping[,5,,,],#1)=0 and last(/monitor_Firewall_Juniper_SRX/icmpping[,5,,,],#2)=1'
              name: 'ICMP ping不可达'
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: 6b97a449253044c2a6e2932d6b2cbddc
              expression: 'last(/monitor_Firewall_Juniper_SRX/icmpping[,5,,,],#1)=0'
              name: 监控失效（ping不通）
              priority: INFO
              manual_close: 'YES'
              tags:
                -
                  tag: 监控失效原因
                  value: ping不通
        -
          uuid: 43aec8177a8b46ea91812ed9c7f36eb3
          name: trap消息
          type: SNMP_TRAP
          key: 'snmptrap[""]'
          delay: '0'
          history: 30d
          trends: '0'
          value_type: LOG
          tags:
            -
              tag: Application
              value: trap消息
          triggers:
            -
              uuid: 0e87544e97454a62b1233cc043cb54d3
              expression: 'find(/monitor_Firewall_Juniper_SRX/snmptrap[""],,"iregexp",".*")=1'
              name: trap告警
              priority: AVERAGE
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: af0e8a7858c642f4a7d90313164fefba
              expression: 'find(/monitor_Firewall_Juniper_SRX/snmptrap[""],,"iregexp","coldStart")=1'
              name: 冷重启告警
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: 41c4017db6614510b0849fb2ad109c2f
              expression: 'find(/monitor_Firewall_Juniper_SRX/snmptrap[""],,"iregexp","warmStart")=1'
              name: 热重启告警
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: c22db39c36e24783bc874db7986a0ca3
              expression: 'find(/monitor_Firewall_Juniper_SRX/snmptrap[""],,"iregexp","linkDown")=1'
              name: 端口down
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: 1cff2983e27843c3bec76d8f8e96f626
          name: 系统信息
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: SystemDescription
          delay: 1h
          history: 3d
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: Application
              value: 系统信息
          triggers:
            -
              uuid: 0423b7ab0c554df1b708d5e08d0ff18a
              expression: 'nodata(/monitor_Firewall_Juniper_SRX/SystemDescription,12h)=1'
              name: 监控失效（snmp不通）
              priority: INFO
              manual_close: 'YES'
              tags:
                -
                  tag: 监控失效原因
                  value: snmp不通
        -
          uuid: b36235f926944741928b9eb56990bb26
          name: 运行时间
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: SystemUpTime
          delay: 1h
          history: 3d
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: Application
              value: 系统信息
      discovery_rules:
        -
          uuid: b7fbdd23f1aa4d80b301ff9bdb2820ab
          name: FPC板卡发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2636.3.39.1.12.1.1.1.10]'
          key: FPCBoardDiscovery
          delay: 12h
          lifetime: 0d
          item_prototypes:
            -
              uuid: 6eb5b374e1a64493a8fcc6a0bfe5d966
              name: 'node{#SNMPVALUE} {#SNMPINDEX}号FPC板卡CP会话'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.39.1.12.1.1.1.8.{#SNMPINDEX}'
              key: 'CPSession.[{#SNMPVALUE},{#SNMPINDEX}]'
              delay: 5m
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: CP会话数
            -
              uuid: 39df661409774578a4cb05aa7f668b0c
              name: 'node{#SNMPVALUE} {#SNMPINDEX}号FPC板卡CP会话利用率'
              type: CALCULATED
              key: 'CPSessionUsage.[{#SNMPVALUE},{#SNMPINDEX}]'
              delay: 5m
              history: 3d
              trends: 0d
              value_type: FLOAT
              units: '%'
              params: 'last(//CPSession.[{#SNMPVALUE},{#SNMPINDEX}])/last(//MaxCPSession.[{#SNMPVALUE},{#SNMPINDEX}])*100'
              tags:
                -
                  tag: Application
                  value: CP会话利用率
              trigger_prototypes:
                -
                  uuid: c27d6809102a457c9024e7b35d225f13
                  expression: 'min(/monitor_Firewall_Juniper_SRX/CPSessionUsage.[{#SNMPVALUE},{#SNMPINDEX}],#2)>{$CP_SESSION_USAGE_THRESHOLD}'
                  name: CP会话利用率高
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
            -
              uuid: 746a148d4de845a2aadbe04d2bdf5d07
              name: 'node{#SNMPVALUE} {#SNMPINDEX}号FPC板卡CPU利用率'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.39.1.12.1.1.1.4.{#SNMPINDEX}'
              key: 'CPUUsage.[{#SNMPVALUE},{#SNMPINDEX}]'
              delay: 5m
              history: 3d
              trends: 0d
              units: '%'
              tags:
                -
                  tag: Application
                  value: CPU利用率
              trigger_prototypes:
                -
                  uuid: 397719b300fc461a8b901826efabe274
                  expression: 'min(/monitor_Firewall_Juniper_SRX/CPUUsage.[{#SNMPVALUE},{#SNMPINDEX}],#2)>{$CPU_USAGE_THRESHOLD}'
                  name: CPU利用率高
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
            -
              uuid: 53da6fb7c8c54d74a1bc78867364b24b
              name: 'node{#SNMPVALUE} {#SNMPINDEX}号FPC板卡flow会话'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.39.1.12.1.1.1.6.{#SNMPINDEX}'
              key: 'FlowSession.[{#SNMPVALUE},{#SNMPINDEX}]'
              delay: 5m
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: flow会话数
            -
              uuid: c944bb639b334298a9d95045fedd59ba
              name: 'node{#SNMPVALUE} {#SNMPINDEX}号FPC板卡flow会话利用率'
              type: CALCULATED
              key: 'FlowSessionUsage.[{#SNMPVALUE},{#SNMPINDEX}]'
              delay: 5m
              history: 3d
              trends: 0d
              value_type: FLOAT
              units: '%'
              params: 'last(//FlowSession.[{#SNMPVALUE},{#SNMPINDEX}])/last(//MaxFlowSession.[{#SNMPVALUE},{#SNMPINDEX}])*100'
              tags:
                -
                  tag: Application
                  value: flow会话利用率
              trigger_prototypes:
                -
                  uuid: 360007ffe1b24d439879adf46cd5da03
                  expression: 'min(/monitor_Firewall_Juniper_SRX/FlowSessionUsage.[{#SNMPVALUE},{#SNMPINDEX}],#2)>{$FLOW_SESSION_USAGE_THRESHOLD}'
                  name: flow会话利用率高
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
            -
              uuid: 9e98c86a73264ebbac9a0e838b801106
              name: 'node{#SNMPVALUE} {#SNMPINDEX}号FPC板卡最大CP会话'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.39.1.12.1.1.1.9.{#SNMPINDEX}'
              key: 'MaxCPSession.[{#SNMPVALUE},{#SNMPINDEX}]'
              delay: 12h
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: CP会话数
            -
              uuid: 192e147252b444068132649ecb478e19
              name: 'node{#SNMPVALUE} {#SNMPINDEX}号FPC板卡最大flow会话'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.39.1.12.1.1.1.7.{#SNMPINDEX}'
              key: 'MaxFlowSession.[{#SNMPVALUE},{#SNMPINDEX}]'
              delay: 12h
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: flow会话数
            -
              uuid: f26c8af52c3541f8b49da407f31a2a88
              name: 'node{#SNMPVALUE} {#SNMPINDEX}号FPC板卡内存利用率'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.39.1.12.1.1.1.5.{#SNMPINDEX}'
              key: 'MemUsage.[{#SNMPVALUE},{#SNMPINDEX}]'
              delay: 5m
              history: 3d
              trends: 0d
              units: '%'
              tags:
                -
                  tag: Application
                  value: 内存利用率
              trigger_prototypes:
                -
                  uuid: ed0572ea0a91463da75ffc0b7c3cb669
                  expression: 'min(/monitor_Firewall_Juniper_SRX/MemUsage.[{#SNMPVALUE},{#SNMPINDEX}],#2)>{$MEMORY_USAGE_THRESHOLD}'
                  name: 内存利用率高
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
        -
          uuid: 5f1f706127eb4f078c6d36c4f516c1d8
          name: 端口发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr,{#IFALIAS},IF-MIB::ifAlias]'
          key: InterfaceDiscovery_status
          delay: 12h
          filter:
            conditions:
              -
                macro: '{#IFDESCR}'
                value: '.*Vlan.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          lifetime: 0d
          description: |
            You may also consider using IF-MIB::ifType or IF-MIB::ifAlias for discovery depending on your filtering needs.
            
            {$CLOUD_SNMP_COMMUNITY} is a global macro.
          item_prototypes:
            -
              uuid: 938527ad26fe430aaa7aabf7360ec6ce
              name: '端口:{#IFDESCR}({#IFALIAS})状态'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'InterfaceOperationStatus.[{#SNMPINDEX}]'
              delay: 5m
              history: 3d
              trends: 0d
              description: 'The current operational state of the interface.'
              tags:
                -
                  tag: Application
                  value: 端口状态
              trigger_prototypes:
                -
                  uuid: 3a380cd2d6f04dbd9c6039d2f4bbac2f
                  expression: 'last(/monitor_Firewall_Juniper_SRX/InterfaceOperationStatus.[{#SNMPINDEX}],#2)=1 and  last(/monitor_Firewall_Juniper_SRX/InterfaceOperationStatus.[{#SNMPINDEX}],#1)=2'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/monitor_Firewall_Juniper_SRX/InterfaceOperationStatus.[{#SNMPINDEX}],#2)=1 and  last(/monitor_Firewall_Juniper_SRX/InterfaceOperationStatus.[{#SNMPINDEX}],#1)=1'
                  name: '端口 {#IFDESCR} down'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: 端口描述
                      value: '{#IFALIAS}'
        -
          uuid: def72e560ec0411ca3f94ec17506c100
          name: 端口发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr,{#IFSTATUS},IF-MIB::ifOperStatus,{#IFALIAS},IF-MIB::ifAlias]'
          key: InterfaceDiscovery_traffic
          delay: 12h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFSTATUS}'
                value: '1'
                formulaid: E
              -
                macro: '{#IFDESCR}'
                value: '.*Vlan.*'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#IFDESCR}'
                value: '.*Loop.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#IFDESCR}'
                value: '.*VLAN.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
              -
                macro: '{#IFDESCR}'
                value: '.*NULL.*'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          lifetime: 0d
          item_prototypes:
            -
              uuid: 38a7d99486cb452885abb0e688d5e74a
              name: '端口带宽 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'InterfaceBandwidth.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 12h
              history: 3d
              trends: 0d
              units: Mbps
              tags:
                -
                  tag: Application
                  value: 端口带宽
            -
              uuid: 067476f61dd6468ea668061b5bc9c696
              name: '入方向带宽利用率 {#IFDESCR}({#IFALIAS})'
              type: CALCULATED
              key: 'InterfaceInBandwidthUsage.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              value_type: FLOAT
              units: '%'
              params: 'last(//InterfaceInTraffic.[{#SNMPINDEX},{#IFDESCR}])/last(//InterfaceBandwidth.[{#SNMPINDEX},{#IFDESCR}])/10000'
              tags:
                -
                  tag: Application
                  value: 入方向带宽利用率
              trigger_prototypes:
                -
                  uuid: d28f1dcc5e404b239901ca568c4ae1a4
                  expression: 'last(/monitor_Firewall_Juniper_SRX/InterfaceInBandwidthUsage.[{#SNMPINDEX},{#IFDESCR}])>{$BANDWIDTH_USAGE_IN_THRESHOLD}'
                  name: '端口 {#IFDESCR} 入方向带宽利用率高'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: 端口描述
                      value: '{#IFALIAS}'
            -
              uuid: a80ccdaaf72d4acdb1365c87fa77b2c4
              name: '入方向广播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.9.{#SNMPINDEX}'
              key: 'InterfaceInBroadcastPacketsTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向广播包流量
            -
              uuid: fecb35a6890749a6adbf37b4b99ece41
              name: '入方向组播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.9.{#SNMPINDEX}'
              key: 'InterfaceInMulticastPacketsTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向组播报文速率
            -
              uuid: 094daea5271741f59bbee16e2df2a4fb
              name: '入方向错包 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'InterfaceInPacketError.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 30m
              history: 7d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向错包
              trigger_prototypes:
                -
                  uuid: 9fbe2f4a900e496f89e0f474bb205637
                  expression: 'last(/monitor_Firewall_Juniper_SRX/InterfaceInPacketError.[{#SNMPINDEX},{#IFDESCR}])>{$ERROR_PACKETS_IN_THRESHOLD}'
                  name: '端口 {#IFDESCR} 入方向错包率高'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: 端口描述
                      value: '{#IFALIAS}'
            -
              uuid: 8f5cb70dd7744935b03e28d7a3f39d1b
              name: '入方向流量 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'InterfaceInTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向流量
            -
              uuid: aec68b7c77a24b34b29752b2e3ebf13f
              name: '入方向单播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.7.{#SNMPINDEX}'
              key: 'InterfaceInUnicastPacketsTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向单播报文速率
            -
              uuid: 8841b9682fd047c2a8ec4b5a58ab7761
              name: '出方向带宽利用率 {#IFDESCR}({#IFALIAS})'
              type: CALCULATED
              key: 'InterfaceOutBandwidthUsage[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              value_type: FLOAT
              units: '%'
              params: 'last(//InterfaceOutTraffic.[{#SNMPINDEX},{#IFDESCR}])/last(//InterfaceBandwidth.[{#SNMPINDEX},{#IFDESCR}])/10000'
              tags:
                -
                  tag: Application
                  value: 出方向带宽利用率
              trigger_prototypes:
                -
                  uuid: 662cd9b388dd45a3a18342ee0b311ff5
                  expression: 'last(/monitor_Firewall_Juniper_SRX/InterfaceOutBandwidthUsage[{#SNMPINDEX},{#IFDESCR}])>{$BANDWIDTH_USAGE_OUT_THRESHOLD}'
                  name: '端口 {#IFDESCR} 出方向带宽利用率高'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: 端口描述
                      value: '{#IFALIAS}'
            -
              uuid: ac40431929d64942807d439d77460657
              name: '出方向广播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.13.{#SNMPINDEX}'
              key: 'InterfaceOutBroadcastPacketTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向广播报文速率
            -
              uuid: aae7a682ce9e44eba74161fadba32f13
              name: '出方向组播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.12.{#SNMPINDEX}'
              key: 'InterfaceOutMulticastPackestTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 3d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向组播报文速率
            -
              uuid: 3e61225dac254b8692e26eea5665cb17
              name: '出方向错包 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'InterfaceOutPacketError.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 30m
              history: 7d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向错包
              trigger_prototypes:
                -
                  uuid: c481bffa13ba403e8bc64b4dc6dba90e
                  expression: 'last(/monitor_Firewall_Juniper_SRX/InterfaceOutPacketError.[{#SNMPINDEX},{#IFDESCR}])>{$ERROR_PACKETS_OUT_THRESHOLD}'
                  name: '端口 {#IFDESCR} 出方向错包率高'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: 端口描述
                      value: '{#IFALIAS}'
            -
              uuid: d281deee8dee4ff7922422167fafaffa
              name: '出方向流量 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'InterfaceOutTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向流量
            -
              uuid: 6c4f7f5cc6414360977a1917baaa9498
              name: '出方向单播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.11.{#SNMPINDEX}'
              key: 'InterfaceOutUnicastPacketsTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向单播报文速率
        -
          uuid: 5a94df655f8e420483c019af14b245c8
          name: 节点发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.2636.3.39.1.12.1.4.1.2]'
          key: NodeDiscovery
          delay: 12h
          lifetime: 0d
          item_prototypes:
            -
              uuid: 21bac06bd33a4977b5acbf43781dbc7b
              name: 'node {#SNMPVALUE} 新建会话速率'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2636.3.39.1.12.1.4.1.5.{#SNMPINDEX}'
              key: 'SessionCreatedRate.[{#SNMPINDEX},{#SNMPVALUE}]'
              delay: 3m
              history: 3d
              trends: 0d
              units: 个/秒
              tags:
                -
                  tag: Application
                  value: 新建会话速率
              trigger_prototypes:
                -
                  uuid: fa343de0459c423ba9e1cd57774e652e
                  expression: 'last(/monitor_Firewall_Juniper_SRX/SessionCreatedRate.[{#SNMPINDEX},{#SNMPVALUE}])>{$SESSION_CREATEDRATE_THRESHOLD}'
                  name: 新建会话数高
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
      macros:
        -
          macro: '{$BANDWIDTH_USAGE_IN_THRESHOLD}'
          value: '90'
        -
          macro: '{$BANDWIDTH_USAGE_OUT_THRESHOLD}'
          value: '90'
        -
          macro: '{$CLOUD_SNMP_COMMUNITY}'
          value: public
        -
          macro: '{$CPU_USAGE_THRESHOLD}'
          value: '80'
        -
          macro: '{$CP_SESSION_USAGE_THRESHOLD}'
          value: '80'
        -
          macro: '{$ERROR_PACKETS_IN_THRESHOLD}'
          value: '10'
        -
          macro: '{$ERROR_PACKETS_OUT_THRESHOLD}'
          value: '10'
        -
          macro: '{$FLOW_SESSION_USAGE_THRESHOLD}'
          value: '80'
        -
          macro: '{$ICMP_LOSS_WARN}'
          value: '30'
        -
          macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.1'
        -
          macro: '{$MEMORY_USAGE_THRESHOLD}'
          value: '80'
        -
          macro: '{$SESSION_CREATEDRATE_THRESHOLD}'
          value: '2000'
