zabbix_export:
  version: '5.4'
  date: '2021-10-22T10:58:28Z'
  groups:
    -
      uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    -
      uuid: fd4de5e233084c8a83d86cec9c324b7a
      template: 'SNMPv2 ARP'
      name: 'SNMPv2 ARP'
      groups:
        -
          name: 'Templates/Network devices'
      discovery_rules:
        -
          uuid: 4ffb12568f2342e4b79585c451cd7864
          name: 'Get SNMP index'
          type: EXTERNAL
          key: 'snmpv2-arp-bash.sh["{HOST.CONN}","1.3.6.1.2.1.4.22.1.2"]'
          delay: 10m
          lifetime: 1h
          description: |
            This script obtain "#ARPINDEX" (part of OID = interface ID + ip) to constrain ipNetToMediaPhysAddress OID:
            "1.3.6.1.2.1.4.22.1.2" + "." + interface ID + "." + ip =
            "1.3.6.1.2.1.4.22.1.2" + {#ARPINDEX}
            
            Also it gets:
            {#ARPIFNAME} - Name of the interface (Example: Vl900 - VLAN 900)
            {#ARPIP} - IP row from ARP Cache
          item_prototypes:
            -
              uuid: 26c23f5617b0447697990d82d2c5fb54
              name: '{#ARPIFNAME} - {#ARPIP}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.4.22.1.2.{#ARPINDEX}'
              key: 'net.interface.arp.[net.{#ARPINDEX}]'
              delay: 30m
              history: '0'
              trends: '0'
              value_type: TEXT
              description: 'Find IP(+ Name of the Interface) to MAC'
              tags:
                -
                  tag: Application
                  value: 'ARP Check'
