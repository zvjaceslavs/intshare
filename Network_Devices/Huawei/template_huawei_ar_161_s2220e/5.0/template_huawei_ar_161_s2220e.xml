<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T10:55:09Z</date>
  <groups>
    <group>
      <name>MakroSwitches</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Basic HUAWEI SNMP with traps AR161 and S2220E</template>
      <name>Basic HUAWEI SNMP with traps AR161 and S2220E</name>
      <groups>
        <group>
          <name>MakroSwitches</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Enterprise MIB</name>
        </application>
        <application>
          <name>SNMP trap</name>
        </application>
        <application>
          <name>Uptime device</name>
        </application>
      </applications>
      <items>
        <item>
          <name>CPU Usage</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.2011.5.25.31.1.1.1.1.45.9</snmp_oid>
          <key>cpmCPUTotal5min</key>
          <delay>300</delay>
          <history>10d</history>
          <units>%</units>
          <applications>
            <application>
              <name>Enterprise MIB</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{last(0)}>70</expression>
              <name>High CPU load on {HOST.NAME}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
              <priority>HIGH</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Memory usage</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.2011.5.25.31.1.1.1.1.7.9</snmp_oid>
          <key>MemoryPoolUsed</key>
          <delay>300</delay>
          <history>10d</history>
          <units>%</units>
          <applications>
            <application>
              <name>Enterprise MIB</name>
            </application>
          </applications>
        </item>
        <item>
          <name>MIB-trap-BGP</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap["(CISCO.*MIB)((.|[[:space:]])*)(BGP)"]</key>
          <delay>0</delay>
          <history>10d</history>
          <trends>0</trends>
          <value_type>LOG</value_type>
          <applications>
            <application>
              <name>SNMP trap</name>
            </application>
          </applications>
          <logtimefmt>hh:mm:ss yyyy/MM/dd</logtimefmt>
          <triggers>
            <trigger>
              <expression>{regexp(hold time expired)} and {nodata(1h)}=0</expression>
              <name>BGP hold time expired on {HOST.NAME}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
              <priority>HIGH</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>MIB-trap-LOGIN</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap["(CISCO.*MIB)((.|[[:space:]])*)(LOGIN)"]</key>
          <delay>0</delay>
          <history>10d</history>
          <trends>0</trends>
          <value_type>LOG</value_type>
          <applications>
            <application>
              <name>SNMP trap</name>
            </application>
          </applications>
          <logtimefmt>hh:mm:ss yyyy/MM/dd</logtimefmt>
          <triggers>
            <trigger>
              <expression>{regexp(LOGIN_FAILED)} and {nodata(1h)}=0</expression>
              <name>Login Auth Error on {HOST.NAME}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
              <priority>WARNING</priority>
            </trigger>
            <trigger>
              <expression>{regexp(LOGIN_SUCCESS)} and {nodata(1h)}=0</expression>
              <name>Login Auth Success on {HOST.NAME}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>MIB-trap-SLA</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap["(CISCO.*MIB)((.|[[:space:]])*)(SLA)"]</key>
          <delay>0</delay>
          <history>10d</history>
          <trends>0</trends>
          <value_type>LOG</value_type>
          <applications>
            <application>
              <name>SNMP trap</name>
            </application>
          </applications>
          <logtimefmt>hh:mm:ss yyyy/MM/dd</logtimefmt>
          <triggers>
            <trigger>
              <expression>{regexp(IPSLATHRESHOLD)} and {regexp(Threshold Cleared|below)} and {nodata(1h)}=0</expression>
              <name>IP SLA restored on {HOST.NAME}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
              <priority>INFO</priority>
            </trigger>
            <trigger>
              <expression>{regexp(IPSLATHRESHOLD)} and {regexp(Threshold Occurred|exceeded)} and {nodata(1h)}=0</expression>
              <name>IP SLA violated on {HOST.NAME}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
              <priority>AVERAGE</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>CONFIG-MAN-MIB-trap</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap["CISCO-CONFIG-MAN-MIB"]</key>
          <delay>0</delay>
          <history>10d</history>
          <trends>0</trends>
          <value_type>LOG</value_type>
          <applications>
            <application>
              <name>SNMP trap</name>
            </application>
          </applications>
          <logtimefmt>hh:mm:ss yyyy/MM/dd</logtimefmt>
          <triggers>
            <trigger>
              <expression>{regexp(ccmHistoryEventConfigDestination.*value=INTEGER: 2)} and {nodata(1h)}=0</expression>
              <name>"Show run" executed on {HOST.NAME}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
              <description>WORK! events.php?triggerid={TRIGGER.ID} events.php?triggerid={TRIGGER.ID}&amp;period=3600</description>
            </trigger>
            <trigger>
              <expression>{regexp(ccmHistoryEventConfigDestination.*value=INTEGER: 3)} and {nodata(1h)}=0</expression>
              <name>Enter to config mode on {HOST.NAME}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
            </trigger>
            <trigger>
              <expression>{regexp(ccmHistoryEventConfigDestination.*value=INTEGER: 4)} and {nodata(1h)}=0</expression>
              <name>startup config changed on {HOST.NAME}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Temperature</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.2011.5.25.31.1.1.1.1.11.9</snmp_oid>
          <key>tempofhuawei</key>
          <delay>300</delay>
          <units>&amp;#176; C</units>
          <triggers>
            <trigger>
              <expression>{last(,60)}>60</expression>
              <name>Temperature to high on: {HOST.NAME}:{#SNMPVALUE}</name>
              <url>events.php?triggerid={TRIGGER.ID}</url>
              <priority>DISASTER</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>uptime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMP-FRAMEWORK-MIB::snmpEngineTime.0</snmp_oid>
          <key>uptime</key>
          <delay>30</delay>
          <units>uptime</units>
          <applications>
            <application>
              <name>Uptime device</name>
            </application>
          </applications>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>Huawei chassis component</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.9.9.92.1.1.1.3]</snmp_oid>
          <key>ceAssetOrderablePartNumber</key>
          <delay>60</delay>
          <lifetime>10d</lifetime>
          <description>Searches the Cisco MIB for the chassis model and blades.</description>
          <item_prototypes>
            <item_prototype>
              <name>Cisco P/N: "$1"</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.9.9.92.1.1.1.3.{#SNMPINDEX}</snmp_oid>
              <key>ceAssetOrderablePartNumber[{#SNMPVALUE}]</key>
              <delay>86400</delay>
              <history>10d</history>
              <trends>0</trends>
              <value_type>CHAR</value_type>
              <applications>
                <application>
                  <name>Enterprise MIB</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Fan Sensors detect</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.9.9.13.1.4.1.2]</snmp_oid>
          <key>ciscoEnvMonFanStatusDescr</key>
          <delay>60</delay>
          <lifetime>10d</lifetime>
          <description>Searches the CISCO-ENVMON-MIB for the Fan sensors, use ciscoEnvMonFanStatusDescr as key.</description>
          <item_prototypes>
            <item_prototype>
              <name>State of "$1"</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.9.9.13.1.4.1.3.{#SNMPINDEX}</snmp_oid>
              <key>ciscoEnvMonFanState[{#SNMPVALUE}]</key>
              <delay>300</delay>
              <history>10d</history>
              <applications>
                <application>
                  <name>Enterprise MIB</name>
                </application>
              </applications>
              <valuemap>
                <name>ciscoEnvMonState</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}>1</expression>
                  <name>Problem with: {HOST.NAME}:{#SNMPVALUE}</name>
                  <url>events.php?triggerid={TRIGGER.ID}</url>
                  <priority>HIGH</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Power Supply detect</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.9.9.13.1.5.1.2]</snmp_oid>
          <key>ciscoEnvMonSupplyStatusDescr</key>
          <delay>60</delay>
          <lifetime>10d</lifetime>
          <description>Searches the CISCO-ENVMON-MIB for the Fan sensors, use ciscoEnvMonSupplyStatusDescr as key.</description>
          <item_prototypes>
            <item_prototype>
              <name>State of "$1"</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.9.9.13.1.5.1.3.{#SNMPINDEX}</snmp_oid>
              <key>ciscoEnvMonSupplyState[{#SNMPVALUE}]</key>
              <delay>300</delay>
              <history>10d</history>
              <applications>
                <application>
                  <name>Enterprise MIB</name>
                </application>
              </applications>
              <valuemap>
                <name>ciscoEnvMonState</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}>6</expression>
                  <name>Problem with: {HOST.NAME}:{#SNMPVALUE}</name>
                  <url>events.php?triggerid={TRIGGER.ID}</url>
                  <priority>INFO</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
      </discovery_rules>
      <screens>
        <screen>
          <name>System performance</name>
          <hsize>1</hsize>
          <vsize>2</vsize>
          <screen_items>
            <screen_item>
              <resourcetype>0</resourcetype>
              <style>0</style>
              <resource>
                <name>Mem/CPU Load on {{HOST.HOST}:sysName.last(0)}</name>
                <host>Basic HUAWEI SNMP with traps AR161 and S2220E</host>
              </resource>
              <width>500</width>
              <height>100</height>
              <x>0</x>
              <y>0</y>
              <colspan>1</colspan>
              <rowspan>1</rowspan>
              <elements>0</elements>
              <valign>0</valign>
              <halign>0</halign>
              <dynamic>0</dynamic>
              <sort_triggers>0</sort_triggers>
              <url></url>
              <application></application>
              <max_columns>3</max_columns>
            </screen_item>
            <screen_item>
              <resourcetype>3</resourcetype>
              <style>0</style>
              <resource>
                <key>snmptrap["(CISCO.*MIB)((.|[[:space:]])*)(SLA)"]</key>
                <host>Basic HUAWEI SNMP with traps AR161 and S2220E</host>
              </resource>
              <width>500</width>
              <height>100</height>
              <x>0</x>
              <y>1</y>
              <colspan>1</colspan>
              <rowspan>1</rowspan>
              <elements>25</elements>
              <valign>0</valign>
              <halign>0</halign>
              <dynamic>0</dynamic>
              <sort_triggers>0</sort_triggers>
              <url></url>
              <application></application>
              <max_columns>3</max_columns>
            </screen_item>
          </screen_items>
        </screen>
      </screens>
    </template>
  </templates>
  <graphs>
    <graph>
      <name>&amp;#10054; &amp;#176; on {{HOST.HOST}:sysName.last(0)}</name>
      <graph_items>
        <graph_item>
          <color>1A7C11</color>
          <item>
            <host>Basic HUAWEI SNMP with traps AR161 and S2220E</host>
            <key>tempofhuawei</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>Mem/CPU Load on {{HOST.HOST}:sysName.last(0)}</name>
      <width>620</width>
      <graph_items>
        <graph_item>
          <color>AA0000</color>
          <item>
            <host>Basic HUAWEI SNMP with traps AR161 and S2220E</host>
            <key>cpmCPUTotal5min</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>008800</color>
          <yaxisside>RIGHT</yaxisside>
          <item>
            <host>Basic HUAWEI SNMP with traps AR161 and S2220E</host>
            <key>MemoryPoolUsed</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
  </graphs>
  <value_maps>
    <value_map>
      <name>ciscoEnvMonState</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>normal</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>warning</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>critical</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>critical</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>notPresent</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>notFunctioning</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>