zabbix_export:
  version: '5.4'
  date: '2021-11-09T08:48:48Z'
  groups:
    -
      uuid: 57b7ae836ca64446ba2c296389c009b7
      name: Templates/Modules
    -
      uuid: 31a2c7b235b1462495f4bad087ee8943
      name: 'Templates Huawei'
  templates:
    -
      uuid: f6c031abaebb45929dba607260ff45b3
      template: 'Optical Modules Huawei'
      name: 'Optical Modules Huawei'
      description: |
        ## Overview
        
        Template with single lane discovery and multi lane devices.
        
        
          
        Créditos à https://github.com/GustavoIFelippe
        
        
        
        ## Author
        
        gustavo10telecom
        
        
      groups:
        -
          name: Templates/Modules
        -
          name: 'Templates Huawei'
      discovery_rules:
        -
          uuid: c5600c6b8835487ea10f66f7b215dcbb
          name: 'Network Optical Modules Multi Lane'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ENTPHYSICALNAME},ENTITY-MIB::entPhysicalName,{#IFVOLTAGE},1.3.6.1.4.1.2011.5.25.31.1.1.3.1.6]'
          key: net.optical.ml.discovery
          delay: 1h
          filter:
            evaltype: FORMULA
            formula: '(A or B) and C'
            conditions:
              -
                macro: '{#ENTPHYSICALNAME}'
                value: 40GE
                formulaid: A
              -
                macro: '{#ENTPHYSICALNAME}'
                value: 100GE
                formulaid: B
              -
                macro: '{#IFVOLTAGE}'
                value: '-1'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          lifetime: 1d
          item_prototypes:
            -
              uuid: 2ac9ca89a8044f9ca52bc165f13e1302
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower Lane0'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.32.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneRxPowerMLLane0[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: REGEX
                  parameters:
                    - '([^\,\s]*),([^\,\s]*),([^,\s]*),([^,\s]*)'
                    - \1
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: def2f2d5586741b086df7f411c1ba576
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower Lane1'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.32.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneRxPowerMLLane1[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: REGEX
                  parameters:
                    - '([^\,\s]*),([^\,\s]*),([^,\s]*),([^,\s]*)'
                    - \2
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: 4708954c22a64d57a0d9b2eec58d44d9
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower Lane2'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.32.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneRxPowerMLLane2[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: REGEX
                  parameters:
                    - '([^\,\s]*),([^\,\s]*),([^,\s]*),([^,\s]*)'
                    - \3
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: bd9d1924df214b009dd247376546ddf3
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower Lane3'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.32.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneRxPowerMLLane3[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: REGEX
                  parameters:
                    - '([^\,\s]*),([^\,\s]*),([^,\s]*),([^,\s]*)'
                    - \4
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: 2c4ba167905949da982f07fdfa25673a
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower Lane0'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.33.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneTxPowerMLLane0[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: REGEX
                  parameters:
                    - '([^\,\s]*),([^\,\s]*),([^,\s]*),([^,\s]*)'
                    - \1
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: 654817ca49124ab3bc3fe1791c2099a8
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower Lane1'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.33.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneTxPowerMLLane1[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: REGEX
                  parameters:
                    - '([^\,\s]*),([^\,\s]*),([^,\s]*),([^,\s]*)'
                    - \2
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: f7787853c7e740f491102ada195a257f
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower Lane2'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.33.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneTxPowerMLLane2[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: REGEX
                  parameters:
                    - '([^\,\s]*),([^\,\s]*),([^,\s]*),([^,\s]*)'
                    - \3
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: 5cc0fce9bb0d44c8af00263ec8bc00e2
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower Lane3'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.33.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneTxPowerMLLane3[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: REGEX
                  parameters:
                    - '([^\,\s]*),([^\,\s]*),([^,\s]*),([^,\s]*)'
                    - \4
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: 591022ae6a9e46ec85861154c46f2040
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower High Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.14.{#SNMPINDEX}'
              key: 'hwEntityOpticalRxHighThresholdML[{#ENTPHYSICALNAME}]'
              delay: 30m
              history: 30d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: 5364ae850766456e90a2246ed3c806ab
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower High Warning Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.21.{#SNMPINDEX}'
              key: 'hwEntityOpticalRxHighWarnThresholdML[{#ENTPHYSICALNAME}]'
              delay: 30m
              history: 30d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: b5ee7dbbd9da4a5381b42e6112398a3d
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower Low Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.13.{#SNMPINDEX}'
              key: 'hwEntityOpticalRxLowThresholdML[{#ENTPHYSICALNAME}]'
              delay: 30m
              history: 30d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: ce98751bf08e411680eae3fda93e5e59
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower Low Warning Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.20.{#SNMPINDEX}'
              key: 'hwEntityOpticalRxLowWarnThresholdML[{#ENTPHYSICALNAME}]'
              delay: 30m
              history: 30d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: 59a63571ab2543d18385eaf5f9e7ced8
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Temperature'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.5.{#SNMPINDEX}'
              key: 'hwEntityOpticalTemperatureML[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: ºC
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
              trigger_prototypes:
                -
                  uuid: 3b39a434e5254408b1b0fc7584fec7e2
                  expression: |
                    last(/Optical Modules Huawei/hwEntityOpticalTemperatureML[{#ENTPHYSICALNAME}])
                    >=
                    {$TRANSCEIVER_TEMP_WARN}
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: |
                    last(/Optical Modules Huawei/hwEntityOpticalTemperatureML[{#ENTPHYSICALNAME}])
                    <
                    {$TRANSCEIVER_TEMP_WARN}
                  name: 'High Temperature on Optical Module ML: {#ENTPHYSICALNAME}'
                  priority: HIGH
                  manual_close: 'YES'
            -
              uuid: 3e4b2ddec3e442f3a626ecf0d7f16359
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower High Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.16.{#SNMPINDEX}'
              key: 'hwEntityOpticalTxHighThresholdML[{#ENTPHYSICALNAME}]'
              delay: 30m
              history: 30d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: ce19e65f43174b809fdb8184b0f39ca3
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower High Warning Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.23.{#SNMPINDEX}'
              key: 'hwEntityOpticalTxHighWarnThresholdML[{#ENTPHYSICALNAME}]'
              delay: 30m
              history: 30d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: 9a6b4f520abf46fb9978324016336af9
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower Low Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.15.{#SNMPINDEX}'
              key: 'hwEntityOpticalTxLowThresholdML[{#ENTPHYSICALNAME}]'
              delay: 30m
              history: 30d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: a129b5ab53eb4084b7d9826243a33e5e
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower Low Warning Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.22.{#SNMPINDEX}'
              key: 'hwEntityOpticalTxLowWarnThresholdML[{#ENTPHYSICALNAME}]'
              delay: 30m
              history: 30d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: d2c99159597e4b72917294df21ff6a66
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Vendor Name'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.24.{#SNMPINDEX}'
              key: 'hwEntityOpticalVenderNameML[{#ENTPHYSICALNAME}]'
              delay: 1h
              history: 30d
              trends: '0'
              value_type: TEXT
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
            -
              uuid: 993e7600b7814600b73d9f5fed7e6be0
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Type'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.25.{#SNMPINDEX}'
              key: 'hwEntityOpticalVenderPnML[{#ENTPHYSICALNAME}]'
              delay: 1h
              history: 30d
              trends: '0'
              value_type: TEXT
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface: {#ENTPHYSICALNAME}'
          trigger_prototypes:
            -
              uuid: 58bb482b68ab402d9b889e55226507d0
              expression: |
                ((last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane0[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane1[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane2[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane3[{#ENTPHYSICALNAME}])) 
                 <= 
                (last(/Optical Modules Huawei/hwEntityOpticalRxLowWarnThresholdML[{#ENTPHYSICALNAME}])))
                
                and
                
                ((last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane0[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane1[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane2[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane3[{#ENTPHYSICALNAME}]))
                <> -40)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                ((last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane0[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane1[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane2[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane3[{#ENTPHYSICALNAME}])) 
                 >
                (last(/Optical Modules Huawei/hwEntityOpticalRxLowWarnThresholdML[{#ENTPHYSICALNAME}])))
                
                and
                
                ((last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane0[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane1[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane2[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane3[{#ENTPHYSICALNAME}]))
                <> -40)
              name: 'Low Rx Signal on Optical Module ML: {#ENTPHYSICALNAME}'
              priority: DISASTER
              manual_close: 'YES'
            -
              uuid: c1a33f14d3f44525988d02d212be0c46
              expression: |
                ((last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane0[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane1[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane2[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane3[{#ENTPHYSICALNAME}])) 
                 <= 
                (last(/Optical Modules Huawei/hwEntityOpticalTxLowWarnThresholdML[{#ENTPHYSICALNAME}])))
                
                and
                
                ((last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane0[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane1[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane2[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane3[{#ENTPHYSICALNAME}])) 
                <> -40)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                ((last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane0[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane1[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane2[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane3[{#ENTPHYSICALNAME}])) 
                 >
                (last(/Optical Modules Huawei/hwEntityOpticalTxLowWarnThresholdML[{#ENTPHYSICALNAME}])))
                
                and
                
                ((last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane0[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane1[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane2[{#ENTPHYSICALNAME}]) or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneTxPowerMLLane3[{#ENTPHYSICALNAME}])) 
                <> -40)
              name: 'Low Tx Signal on Optical Module ML: {#ENTPHYSICALNAME}'
              priority: DISASTER
              manual_close: 'YES'
            -
              uuid: 7ed747166ddf44f3a13d922ab2a373d5
              expression: |
                ((change(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane0[{#ENTPHYSICALNAME}]) <= {$ATTENUATIONFACTOR}) 
                or
                (change(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane1[{#ENTPHYSICALNAME}]) <= {$ATTENUATIONFACTOR}) 
                or
                (change(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane2[{#ENTPHYSICALNAME}]) <= {$ATTENUATIONFACTOR}) 
                or
                (change(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane3[{#ENTPHYSICALNAME}]) <= {$ATTENUATIONFACTOR}))
                
                and
                
                ((last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane0[{#ENTPHYSICALNAME}]) 
                or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane1[{#ENTPHYSICALNAME}]) 
                or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane2[{#ENTPHYSICALNAME}]) 
                or
                 last(/Optical Modules Huawei/hwEntityOpticalLaneRxPowerMLLane3[{#ENTPHYSICALNAME}]))
                <> -40)
              recovery_mode: NONE
              name: 'Signal Atenuation on Optical Module ML: {#ENTPHYSICALNAME}'
              priority: HIGH
              manual_close: 'YES'
          graph_prototypes:
            -
              uuid: 416886c1eb604ff096ffebb5725cd88a
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Rx Signals'
              graph_items:
                -
                  drawtype: BOLD_LINE
                  color: 59DF00
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalRxHighThresholdML[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '1'
                  color: FF0000
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneRxPowerMLLane0[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '2'
                  color: 0040FF
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneRxPowerMLLane1[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '3'
                  color: FFFF00
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneRxPowerMLLane2[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '4'
                  color: BF00FF
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneRxPowerMLLane3[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '5'
                  drawtype: BOLD_LINE
                  color: CC6600
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalRxLowThresholdML[{#ENTPHYSICALNAME}]'
            -
              uuid: 6e26289c89fd4805a8feba4a1f339e57
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Temperature'
              graph_items:
                -
                  drawtype: BOLD_LINE
                  color: FF0000
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalTemperatureML[{#ENTPHYSICALNAME}]'
            -
              uuid: 75f3002b8fb340e191e86d5eb5ca83b8
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Tx Signals'
              graph_items:
                -
                  drawtype: BOLD_LINE
                  color: 59DF00
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalTxHighThresholdML[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '1'
                  color: FF0000
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneTxPowerMLLane0[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '2'
                  color: 0040FF
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneTxPowerMLLane1[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '3'
                  color: FFFF00
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneTxPowerMLLane2[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '4'
                  color: BF00FF
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneTxPowerMLLane3[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '5'
                  drawtype: BOLD_LINE
                  color: CC6600
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalTxLowThresholdML[{#ENTPHYSICALNAME}]'
        -
          uuid: 309b42251f964d49a73d0f4fc9ef5498
          name: 'Network Optical Modules Single Lane'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ENTPHYSICALNAME},ENTITY-MIB::entPhysicalName,{#IFVOLTAGE},1.3.6.1.4.1.2011.5.25.31.1.1.3.1.6]'
          key: net.optical.sl.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#ENTPHYSICALNAME}'
                value: XG
                formulaid: A
              -
                macro: '{#IFVOLTAGE}'
                value: '-1'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime: 1d
          item_prototypes:
            -
              uuid: 69be48daa36b4d7889283ee43d335544
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.32.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneRxPower[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
              trigger_prototypes:
                -
                  uuid: 848b25ed45d4431882be536b463a41ea
                  expression: |
                    (change(/Optical Modules Huawei/hwEntityOpticalLaneRxPower[{#ENTPHYSICALNAME}])
                     <= 
                    {$ATTENUATIONFACTOR})
                    
                    and
                    
                    (last(/Optical Modules Huawei/hwEntityOpticalLaneRxPower[{#ENTPHYSICALNAME}]) <> -40)
                  recovery_mode: NONE
                  name: 'Signal Atenuation on Optical Module SL: {#ENTPHYSICALNAME}'
                  priority: HIGH
                  manual_close: 'YES'
            -
              uuid: cab5f495cf164f5892e26a7684a54a23
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.33.{#SNMPINDEX}'
              key: 'hwEntityOpticalLaneTxPower[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: 288ca9c3b96b4ea09c50ea5d5521e0cf
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower High Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.14.{#SNMPINDEX}'
              key: 'hwEntityOpticalRxHighThreshold[{#ENTPHYSICALNAME}]'
              delay: 10m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: 47f42d30939a4b329ba0d5b60318db7f
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower High Warning Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.21.{#SNMPINDEX}'
              key: 'hwEntityOpticalRxHighWarnThreshold[{#ENTPHYSICALNAME}]'
              delay: 10m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: 82168de0d68745feabc072e275c5c2eb
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower Low Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.13.{#SNMPINDEX}'
              key: 'hwEntityOpticalRxLowThreshold[{#ENTPHYSICALNAME}]'
              delay: 10m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: 0a14442ed20a4d6bb2c0b41e4425fb98
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: RxPower Low Warning Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.20.{#SNMPINDEX}'
              key: 'hwEntityOpticalRxLowWarnThreshold[{#ENTPHYSICALNAME}]'
              delay: 10m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: a9e9da7ab4854ed2ac11dac64a52d7ee
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Temperature'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.2011.5.25.31.1.1.3.1.5.{#SNMPINDEX}'
              key: 'hwEntityOpticalTemperature[{#ENTPHYSICALNAME}]'
              delay: 5m
              history: 30d
              value_type: FLOAT
              units: °C
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
              trigger_prototypes:
                -
                  uuid: 1e61d47ce40044b0997bdcd007f940d7
                  expression: |
                    last(/Optical Modules Huawei/hwEntityOpticalTemperature[{#ENTPHYSICALNAME}])
                    >=
                    {$TRANSCEIVER_TEMP_WARN}
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: |
                    last(/Optical Modules Huawei/hwEntityOpticalTemperature[{#ENTPHYSICALNAME}])
                    >
                    {$TRANSCEIVER_TEMP_WARN}
                  name: 'High Temperature on Optical Module SL: {#ENTPHYSICALNAME}'
                  priority: HIGH
            -
              uuid: 5c8d618c7b0a4b5c85a2edb680bf0e6e
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower High Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.16.{#SNMPINDEX}'
              key: 'hwEntityOpticalTxHighThreshold[{#ENTPHYSICALNAME}]'
              delay: 10m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: ad68cdb519f94f62b52cdef5d34587cc
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower High Warning Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.23.{#SNMPINDEX}'
              key: 'hwEntityOpticalTxHighWarnThreshold[{#ENTPHYSICALNAME}]'
              delay: 10m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: 71e48c85dc814013adb190a745b4f550
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower Low Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.15.{#SNMPINDEX}'
              key: 'hwEntityOpticalTxLowThreshold[{#ENTPHYSICALNAME}]'
              delay: 10m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: 9fae1c129708463e87b458446996bd3c
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: TxPower Low Warning Threshold'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.22.{#SNMPINDEX}'
              key: 'hwEntityOpticalTxLowWarnThreshold[{#ENTPHYSICALNAME}]'
              delay: 10m
              history: 10d
              value_type: FLOAT
              units: dBm
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.01'
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: 5f9b00f29cdd4b16b6ea1ad84be37e61
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Vendor Name'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.24.{#SNMPINDEX}'
              key: 'hwEntityOpticalVenderName[{#ENTPHYSICALNAME}]'
              delay: 1h
              history: 30d
              trends: '0'
              value_type: TEXT
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
            -
              uuid: 0a261feed73d41848be7e2954abadfba
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Type'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.2011.5.25.31.1.1.3.1.25.{#SNMPINDEX}'
              key: 'hwEntityOpticalVenderPn[{#ENTPHYSICALNAME}]'
              delay: 1h
              history: 30d
              trends: '0'
              value_type: TEXT
              tags:
                -
                  tag: Application
                  value: 'Transceiver Data Interface SL: {#ENTPHYSICALNAME}'
          trigger_prototypes:
            -
              uuid: 9bb66a5c490042c4a39f4c2949322270
              expression: |
                (last(/Optical Modules Huawei/hwEntityOpticalLaneRxPower[{#ENTPHYSICALNAME}])
                 <= 
                (last(/Optical Modules Huawei/hwEntityOpticalRxLowThreshold[{#ENTPHYSICALNAME}]) * 0.90))
                and
                (last(/Optical Modules Huawei/hwEntityOpticalLaneRxPower[{#ENTPHYSICALNAME}]) <> -40)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (last(/Optical Modules Huawei/hwEntityOpticalLaneRxPower[{#ENTPHYSICALNAME}])
                 >
                (last(/Optical Modules Huawei/hwEntityOpticalRxLowThreshold[{#ENTPHYSICALNAME}]) * 0.90))
                and
                (last(/Optical Modules Huawei/hwEntityOpticalLaneRxPower[{#ENTPHYSICALNAME}]) <> -40)
              name: 'Low Rx Signal on Optical Module SL: {#ENTPHYSICALNAME}'
              priority: DISASTER
              manual_close: 'YES'
            -
              uuid: 77735e0bfeb244479d0394490b0e9459
              expression: |
                (last(/Optical Modules Huawei/hwEntityOpticalLaneTxPower[{#ENTPHYSICALNAME}])
                 <= 
                (last(/Optical Modules Huawei/hwEntityOpticalTxLowThreshold[{#ENTPHYSICALNAME}]) * 0.90))
                and
                (last(/Optical Modules Huawei/hwEntityOpticalLaneTxPower[{#ENTPHYSICALNAME}]) <> -40)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (last(/Optical Modules Huawei/hwEntityOpticalLaneTxPower[{#ENTPHYSICALNAME}])
                 >
                (last(/Optical Modules Huawei/hwEntityOpticalTxLowThreshold[{#ENTPHYSICALNAME}]) * 0.90))
                and
                (last(/Optical Modules Huawei/hwEntityOpticalLaneTxPower[{#ENTPHYSICALNAME}]) <> -40)
              name: 'Low Tx Signal on Optical Module SL: {#ENTPHYSICALNAME}'
              priority: DISASTER
              manual_close: 'YES'
          graph_prototypes:
            -
              uuid: 6348c4362fff46cf8ac1cec0185d65c2
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Rx Signals (SL)'
              graph_items:
                -
                  color: 59DF00
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalRxHighThreshold[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '1'
                  color: 0040FF
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneRxPower[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '2'
                  color: CC6600
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalRxLowThreshold[{#ENTPHYSICALNAME}]'
            -
              uuid: f98d108afb744fb69cbdc665512abcd0
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Temperature (SL)'
              graph_items:
                -
                  drawtype: BOLD_LINE
                  color: FF0000
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalTemperature[{#ENTPHYSICALNAME}]'
            -
              uuid: e793de2d12134c2eb33f2b69b9db6655
              name: 'Optical Module Interface {#ENTPHYSICALNAME}: Tx Signals (SL)'
              graph_items:
                -
                  color: 59DF00
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalLaneTxPower[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '1'
                  color: 0040FF
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalTxHighThreshold[{#ENTPHYSICALNAME}]'
                -
                  sortorder: '2'
                  color: CC6600
                  item:
                    host: 'Optical Modules Huawei'
                    key: 'hwEntityOpticalTxLowThreshold[{#ENTPHYSICALNAME}]'
      macros:
        -
          macro: '{$ATTENUATIONFACTOR}'
          value: '-2'
        -
          macro: '{$SNMP_COMMUNITY}'
          value: dEz_sW_@ro
        -
          macro: '{$TRANSCEIVER_TEMP_WARN}'
          value: '70'
