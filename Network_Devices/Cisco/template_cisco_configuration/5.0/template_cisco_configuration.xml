<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-11-09T08:25:47Z</date>
  <groups>
    <group>
      <name>Templates</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>SNMP Cisco Configuration</template>
      <name>SNMP Cisco Configuration</name>
      <groups>
        <group>
          <name>Templates</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Configuration</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Who changed configuration</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.9.9.43.1.4.3.0</snmp_oid>
          <key>ccmctIdWhoChanged</key>
          <delay>3600</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>This object indicates the user who last reset the Config Change Tracking ID.</description>
          <applications>
            <application>
              <name>Configuration</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Running configuration last changed</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.9.9.43.1.1.1.0</snmp_oid>
          <key>ccmHistoryRunningLastChanged</key>
          <delay>3600</delay>
          <units>s</units>
          <description>The value of sysUpTime when the running configuration was last changed. If the value of ccmHistoryRunningLastChanged is greater than ccmHistoryRunningLastSaved, the configuration has been changed but not saved.</description>
          <applications>
            <application>
              <name>Configuration</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{diff()}=1</expression>
              <name>Configuration changed on {HOST.NAME}</name>
              <priority>INFO</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Running configuration last saved</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.9.9.43.1.1.2.0</snmp_oid>
          <key>ccmHistoryRunningLastSaved</key>
          <delay>3600</delay>
          <units>s</units>
          <description>The value of sysUpTime when the running configuration was last saved (written). If the value of ccmHistoryRunningLastChanged is greater than ccmHistoryRunningLastSaved, the configuration has been changed but not saved. What constitutes a safe saving of the running configuration is a management policy issue beyond the scope of this MIB. For some installations, writing the running configuration to a terminal may be a way of capturing and saving it. Others may use local or remote storage. Thus ANY write is considered saving for the purposes of the MIB.</description>
          <applications>
            <application>
              <name>Configuration</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>Running startup last changed</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.9.9.43.1.1.3.0</snmp_oid>
          <key>ccmHistoryStartupLastChanged</key>
          <delay>3600</delay>
          <units>s</units>
          <description>The value of sysUpTime when the startup configuration was last written to. In general this is the default configuration used when cold starting the system. It may have been changed by a save of the running configuration or by a copy from elsewhere.</description>
          <applications>
            <application>
              <name>Configuration</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
        </item>
      </items>
    </template>
  </templates>
  <triggers>
    <trigger>
      <expression>{SNMP Cisco Configuration:ccmHistoryRunningLastChanged.last()}>{SNMP Cisco Configuration:ccmHistoryRunningLastSaved.last()}</expression>
      <name>Configuration changes is not saved on {HOST.NAME}</name>
      <priority>WARNING</priority>
    </trigger>
  </triggers>
</zabbix_export>