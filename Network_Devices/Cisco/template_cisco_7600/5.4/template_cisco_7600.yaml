zabbix_export:
  version: '5.4'
  date: '2021-11-21T21:16:40Z'
  groups:
    -
      uuid: f1537448b0da4ebb870d18790c1cec56
      name: 'Templates SNMP Devices'
  templates:
    -
      uuid: 7fb2ca93c2e54b52bc51ae077b2c9e08
      template: Cisco_7600
      name: Cisco_7600
      description: |
        ## Overview
        
        Amperage sensors
        
        
        Fan Tray sensors
        
        
        Temperature Sensors
        
        
        Module sensors
        
        
        Load sensors
        
        
        BGP Peers (inherited from Template Cisco General)
        
        
        CPU
        
        
        FAN
        
        
        Flash Devices
        
        
        Memory Pool
        
        
        OSPF Interfaces (inherited from Template Cisco General)
        
        
        OSPF Neighbours (inherited from Template Cisco General)
        
        
        Power Supplies
        
        
        
        
      templates:
        -
          name: 'Template Cisco General'
        -
          name: Template_Cisco_Traps
      groups:
        -
          name: 'Templates SNMP Devices'
      discovery_rules:
        -
          uuid: d9c525fc13b040829b618e3e1b55f30c
          name: FAN
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.9.9.13.1.4.1.2]'
          key: ciscoEnvMonFanStatusDescr
          delay: '300'
          lifetime: '0'
          description: |
            CISCO-ENVMON-MIB::ciscoEnvMonFanStatusDescr
            
            Textual description of the fan being instrumented.
          item_prototypes:
            -
              uuid: f55929f9f68a40aba1028005b223f0cf
              name: 'Status of FAN "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.13.1.4.1.3.{#SNMPINDEX}'
              key: 'ciscoEnvMonFanState["{#SNMPVALUE}"]'
              delay: '60'
              description: |
                CISCO-ENVMON-MIB::ciscoEnvMonFanState
                
                The current state of the fan being instrumented.
              tags:
                -
                  tag: Application
                  value: 'FAN Sensors'
              trigger_prototypes:
                -
                  uuid: a4d2342fc7804e43912506e7094ea99b
                  expression: 'last(/Cisco_7600/ciscoEnvMonFanState["{#SNMPVALUE}"])=3'
                  name: 'Status of FAN "{#SNMPVALUE}" is critical'
                  priority: AVERAGE
                -
                  uuid: 18f0b89d518a49ab94343eafd4502a23
                  expression: 'last(/Cisco_7600/ciscoEnvMonFanState["{#SNMPVALUE}"])=2'
                  name: 'Status of FAN "{#SNMPVALUE}" is non-operable'
                  priority: WARNING
                -
                  uuid: 237563e8341f416884355b4da742beb7
                  expression: 'last(/Cisco_7600/ciscoEnvMonFanState["{#SNMPVALUE}"])=6'
                  name: 'Status of FAN "{#SNMPVALUE}" is not functioning'
                  priority: AVERAGE
                -
                  uuid: ad7b0ee2e5134b6e9fe05329ef95a4aa
                  expression: 'last(/Cisco_7600/ciscoEnvMonFanState["{#SNMPVALUE}"])=4'
                  name: 'Status of FAN "{#SNMPVALUE}" is shutdown'
                  priority: HIGH
        -
          uuid: 6b138f8bd40446c99fb06a8c6d87157f
          name: 'Power Supplies'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.9.9.13.1.5.1.2]'
          key: ciscoEnvMonSupplyStatusDescr
          delay: '300'
          lifetime: '0'
          description: |
            CISCO-ENVMON-MIB::ciscoEnvMonSupplyStatusDescr
            
            Textual description of the power supply being instrumented.
          item_prototypes:
            -
              uuid: 99bd08fe2fea44ffb5130f769fc090d9
              name: 'Status of Power Supply "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.13.1.5.1.3.{#SNMPINDEX}'
              key: 'ciscoEnvMonSupplyState["{#SNMPVALUE}"]'
              delay: '60'
              description: |
                CISCO-ENVMON-MIB::ciscoEnvMonSupplyState
                
                The current state of the power supply being instrumented.
              tags:
                -
                  tag: Application
                  value: 'Power Supplies'
              trigger_prototypes:
                -
                  uuid: 06ae136a7bc4460b8dae9a886eccd21e
                  expression: 'last(/Cisco_7600/ciscoEnvMonSupplyState["{#SNMPVALUE}"])=3'
                  name: 'Status of Power Supply "{#SNMPVALUE}" is critical'
                  priority: AVERAGE
                -
                  uuid: a3939534388a4f4ead2c8a4141d50bc8
                  expression: 'last(/Cisco_7600/ciscoEnvMonSupplyState["{#SNMPVALUE}"])=2'
                  name: 'Status of Power Supply "{#SNMPVALUE}" is non-operable'
                  priority: WARNING
                -
                  uuid: a6a36a4f09d34717983ded73b16f083b
                  expression: 'last(/Cisco_7600/ciscoEnvMonSupplyState["{#SNMPVALUE}"])=6'
                  name: 'Status of Power Supply "{#SNMPVALUE}" is not functioning'
                  priority: AVERAGE
                -
                  uuid: 5e3672cf25ee4eac8f8e1412e680f680
                  expression: 'last(/Cisco_7600/ciscoEnvMonSupplyState["{#SNMPVALUE}"])=4'
                  name: 'Status of Power Supply "{#SNMPVALUE}" is shutdown'
                  priority: HIGH
        -
          uuid: 4b36aebf775c4c78a3e52739e6e43e31
          name: 'Flash Devices'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.9.9.10.1.1.2.1.8]'
          key: ciscoFlashDeviceDescr
          delay: '300'
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: ^.+$
                formulaid: A
          lifetime: '0'
          description: |
            CISCO-FLASH-MIB::ciscoFlashDeviceDescr
            
            Description of a Flash device. The description is meant to explain what the Flash device and its purpose is. Current values are:
            System flash - for the primary Flash used to store full system images.
            Boot flash - for the secondary Flash used to store bootstrap images.
            
            The device description will always be available for a removable device, even when the device has been removed.
          item_prototypes:
            -
              uuid: 11ed4e44ed0945f8b00925bbf7afbcfe
              name: 'Size of Flash Device "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.10.1.1.2.1.2.{#SNMPINDEX}'
              key: 'ciscoFlashDeviceSize["{#SNMPVALUE}"]'
              delay: '3600'
              units: B
              description: |
                CISCO-FLASH-MIB::ciscoFlashDeviceSize
                
                Total size of the Flash device.
              tags:
                -
                  tag: Application
                  value: 'Flash Devices'
        -
          uuid: 8c80fe23325e495cb6d9a951439b04fd
          name: 'Memory Pool'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.9.9.48.1.1.1.2]'
          key: ciscoMemoryPoolName
          delay: '300'
          lifetime: '0'
          description: |
            CISCO-MEMORY-POOL-MIB::ciscoMemoryPoolName
            
            A textual name assigned to the memory pool.
          item_prototypes:
            -
              uuid: b6d8bc88bb874e28ba5eab4ecdfc8b5f
              name: 'Free memory on Memory Pool "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.48.1.1.1.6.{#SNMPINDEX}'
              key: 'ciscoMemoryPoolFree["{#SNMPVALUE}"]'
              delay: '60'
              units: B
              description: |
                CISCO-MEMORY-POOL-MIB::ciscoMemoryPoolFree
                
                Indicates the number of bytes from the memory pool that are currently unused on the managed device.
              tags:
                -
                  tag: Application
                  value: Memory
            -
              uuid: ccee523f1e3346d19deee7f2f14d71e0
              name: 'Name of Memory Pool "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.48.1.1.1.2.{#SNMPINDEX}'
              key: 'ciscoMemoryPoolName["{#SNMPVALUE}"]'
              delay: '3600'
              trends: '0'
              value_type: CHAR
              description: |
                CISCO-MEMORY-POOL-MIB::ciscoMemoryPoolName
                
                A textual name assigned to the memory pool.
              tags:
                -
                  tag: Application
                  value: Memory
            -
              uuid: 3d8d087fd77a4044a0a823a4c50fa236
              name: 'Total Memory Pool "$1"'
              type: CALCULATED
              key: 'ciscoMemoryPoolTotal["{#SNMPVALUE}"]'
              delay: '3600'
              units: B
              params: 'last(//ciscoMemoryPoolFree["{#SNMPVALUE}"])+last(//ciscoMemoryPoolUsed["{#SNMPVALUE}"])'
              tags:
                -
                  tag: Application
                  value: Memory
            -
              uuid: 6c036da747014d71bb5752f2681a5c45
              name: 'Used memory on Memory Pool "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.48.1.1.1.5.{#SNMPINDEX}'
              key: 'ciscoMemoryPoolUsed["{#SNMPVALUE}"]'
              delay: '300'
              units: B
              description: |
                CISCO-MEMORY-POOL-MIB::ciscoMemoryPoolUsed
                
                Indicates the number of bytes from the memory pool that are currently in use by applications on the managed device.
              tags:
                -
                  tag: Application
                  value: Memory
          trigger_prototypes:
            -
              uuid: 939bbced77864cf995e52f1aef671b29
              expression: 'last(/Cisco_7600/ciscoMemoryPoolUsed["{#SNMPVALUE}"])>last(/Cisco_7600/ciscoMemoryPoolTotal["{#SNMPVALUE}"])*0.9'
              name: 'High utilization of Memory Pool "{#SNMPVALUE}"'
              priority: AVERAGE
        -
          uuid: 1e14eb0ec24b487fbc5055a745dc1067
          name: CPU
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.9.9.109.1.1.1.1.2]'
          key: cpmCPUTotalPhysicalIndex
          delay: '300'
          lifetime: '0'
          description: |
            CISCO-PROCESS-MIB::cpmCPUTotalPhysicalIndex
            
            The entPhysicalIndex of the physical entity for which the CPU statistics in this entry are maintained. The physical entity can be a CPU chip, a group of CPUs, a CPU card etc. The exact type of this entity is described by its entPhysicalVendorType value. If the CPU statistics in this entry correspond to more than one physical entity (or to no physical entity), or if the entPhysicalTable is not supported on the SNMP agent, the value of this object must be zero.
          item_prototypes:
            -
              uuid: ae13746e758340a1addc47e2c77d1428
              name: 'CPU #$1 Usage 1min Rev'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.109.1.1.1.1.7.{#SNMPINDEX}'
              key: 'cpmCPUTotal1minRev[{#SNMPINDEX}]'
              delay: '60'
              units: '%'
              description: |
                CISCO-PROCESS-MIB::cpmCPUTotal1minRev
                
                The overall CPU busy percentage in the last 1 minute period. This object deprecates the object cpmCPUTotal1min and increases the value range to (0..100).
              tags:
                -
                  tag: Application
                  value: CPU
            -
              uuid: f49fc37fcd1940c59c7d3c70fdf55f98
              name: 'CPU #$1 Usage 5min Rev'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.109.1.1.1.1.8.{#SNMPINDEX}'
              key: 'cpmCPUTotal5minRev[{#SNMPINDEX}]'
              delay: '300'
              units: '%'
              description: |
                CISCO-PROCESS-MIB::cpmCPUTotal5minRev
                
                The overall CPU busy percentage in the last 5 minute period. This object deprecates the object cpmCPUTotal5min and increases the value range to (0..100).
              tags:
                -
                  tag: Application
                  value: CPU
              trigger_prototypes:
                -
                  uuid: 853baa4f464047fdb1dd68e27b80c930
                  expression: 'last(/Cisco_7600/cpmCPUTotal5minRev[{#SNMPINDEX}])>95'
                  name: 'High CPU #{#SNMPINDEX} Usage'
                  priority: HIGH
            -
              uuid: 700a61b3c35648cf84752da2d60e2e4e
              name: 'CPU #$1 Usage 5sec Rev'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.109.1.1.1.1.6.{#SNMPINDEX}'
              key: 'cpmCPUTotal5secRev[{#SNMPINDEX}]'
              delay: '30'
              status: DISABLED
              units: '%'
              description: |
                CISCO-PROCESS-MIB::cpmCPUTotal5secRev
                
                The overall CPU busy percentage in the last 5 second period. This object deprecates the object cpmCPUTotal5sec and increases the value range to (0..100). This object is deprecated by cpmCPUTotalMonIntervalValue.
              tags:
                -
                  tag: Application
                  value: CPU
          graph_prototypes:
            -
              uuid: b2bb4ec526a8422599460b06b6ef3a4c
              name: 'CPU #{#SNMPINDEX} Usage'
              graph_items:
                -
                  color: 00C800
                  item:
                    host: Cisco_7600
                    key: 'cpmCPUTotal1minRev[{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  color: C80000
                  item:
                    host: Cisco_7600
                    key: 'cpmCPUTotal5minRev[{#SNMPINDEX}]'
        -
          uuid: e598a667212e4e3a8a0b0830da59a97e
          name: '$1 Sensors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.2.1.47.1.1.1.1.7]'
          key: 'entPhysicalName["Fan Tray"]'
          delay: '300'
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: ^fantray
                formulaid: A
          lifetime: '0'
          description: 'The textual name of the physical entity.'
          item_prototypes:
            -
              uuid: 28fbf1453b7347cfacaf4ac3f2f510d3
              name: 'Operational Status of $2 "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.117.1.4.1.1.1.{#SNMPINDEX}'
              key: 'cefcFanTrayOperStatus["{#SNMPVALUE}","Fan Tray"]'
              delay: '60'
              description: |
                CISCO-ENTITY-FRU-CONTROL-MIB::cefcFanTrayOperStatus
                
                The operational state of the fan or fan tray.
              tags:
                -
                  tag: Application
                  value: 'Fan Trays'
              trigger_prototypes:
                -
                  uuid: a55a86b11d9f4ccabc630686c56f9d9c
                  expression: 'last(/Cisco_7600/cefcFanTrayOperStatus["{#SNMPVALUE}","Fan Tray"])=4'
                  name: 'Status of Fan Tray "{#SNMPVALUE}" is in partial failure'
                  priority: WARNING
                -
                  uuid: 645b6e941b8d4553b280d27ac90c96e2
                  expression: 'last(/Cisco_7600/cefcFanTrayOperStatus["{#SNMPVALUE}","Fan Tray"])=3'
                  name: 'Status of Fan Tray "{#SNMPVALUE}" is powered down'
                  priority: HIGH
            -
              uuid: 62a405572b9a4b59b3646ce3aaf950d5
              name: 'Manufacturer of $2 "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.12.{#SNMPINDEX}'
              key: 'entPhysicalMfgName["{#SNMPVALUE}","Fan Tray"]'
              delay: '86400'
              trends: '0'
              value_type: CHAR
              description: |
                ENTITY-MIB::entPhysicalMfgName
                
                The name of the manufacturer of this physical component. The preferred value is the manufacturer name string actually printed on the component itself (if present).
              tags:
                -
                  tag: Application
                  value: 'Fan Trays'
            -
              uuid: aac682a9bd8f4f37b22de48b353c5c31
              name: 'Model Name of $2 "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.13.{#SNMPINDEX}'
              key: 'entPhysicalModelName["{#SNMPVALUE}","Fan Tray"]'
              delay: '86400'
              trends: '0'
              value_type: CHAR
              description: |
                ENTITY-MIB::entPhysicalModelName
                
                The vendor-specific model name identifier string associated with this physical component.  The preferred value is the customer-visible part number, which may be printed on the component itself.
              tags:
                -
                  tag: Application
                  value: 'Fan Trays'
            -
              uuid: 44c19a12e87740dcb1e72c0b0f3bc619
              name: 'Serial Number of $2 "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.11.{#SNMPINDEX}'
              key: 'entPhysicalSerialNum["{#SNMPVALUE}","Fan Tray"]'
              delay: '3600'
              trends: '0'
              value_type: CHAR
              description: |
                ENTITY-MIB::entPhysicalSerialNum
                
                The vendor-specific serial number string for the physical entity. The preferred value is the serial number string actually printed on the component itself (if present).
              tags:
                -
                  tag: Application
                  value: 'Fan Trays'
        -
          uuid: 4a2b6c2f4a2448f8a86b782ec37728c0
          name: '$1 Sensors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.2.1.47.1.1.1.1.7]'
          key: 'entPhysicalName[Amperage]'
          delay: '300'
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: 'Bias Current Sensor$'
                formulaid: A
          lifetime: '0'
          description: 'The textual name of the physical entity.'
          item_prototypes:
            -
              uuid: f2839199dfcb441092c3a5517c48609b
              name: 'Status of $2 Sensor "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.91.1.1.1.1.5.{#SNMPINDEX}'
              key: 'entSensorStatus["{#SNMPVALUE}",Amperage]'
              delay: '60'
              description: |
                CISCO-ENTITY-SENSOR-MIB::entSensorStatus
                
                This variable indicates the present operational status of the sensor.
              tags:
                -
                  tag: Application
                  value: 'Amperage Sensors'
              trigger_prototypes:
                -
                  uuid: 68fb406e1ab448c9b2392a9c155081cf
                  expression: 'last(/Cisco_7600/entSensorStatus["{#SNMPVALUE}",Amperage])=3'
                  name: 'Amperage Sensor "{#SNMPVALUE}" is nonoperational'
                  priority: HIGH
                -
                  uuid: d958e5b0d68b4ac293de0bef3ad880c0
                  expression: 'last(/Cisco_7600/entSensorStatus["{#SNMPVALUE}",Amperage])=2'
                  name: 'Amperage Sensor "{#SNMPVALUE}" is unavailable'
                  priority: AVERAGE
            -
              uuid: 4a70bcf4e40f49ff9637d9571d540ba2
              name: '$2 of Sensor "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.91.1.1.1.1.4.{#SNMPINDEX}'
              key: 'entSensorValue["{#SNMPVALUE}",Amperage]'
              delay: '60'
              value_type: FLOAT
              units: A
              description: |
                CISCO-ENTITY-SENSOR-MIB::entSensorValue
                
                This variable reports the most recent measurement seen by the sensor.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                -
                  tag: Application
                  value: 'Amperage Sensors'
        -
          uuid: ca121b1c4b5445ee914f770579cdd76d
          name: '$1 Sensors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.2.1.47.1.1.1.1.7]'
          key: 'entPhysicalName[Load]'
          delay: '300'
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: '^power (T|R)x'
                formulaid: A
          lifetime: '0'
          description: 'The textual name of the physical entity.'
          item_prototypes:
            -
              uuid: d5a1bd5085714027814206797db3672d
              name: 'Status of $2 Sensor "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.91.1.1.1.1.5.{#SNMPINDEX}'
              key: 'entSensorStatus["{#SNMPVALUE}",Load]'
              delay: '60'
              description: |
                CISCO-ENTITY-SENSOR-MIB::entSensorStatus
                
                This variable indicates the present operational status of the sensor.
              tags:
                -
                  tag: Application
                  value: 'Load Sensors'
              trigger_prototypes:
                -
                  uuid: 0758fb19b7724db3bb8f6ae804c6f085
                  expression: 'last(/Cisco_7600/entSensorStatus["{#SNMPVALUE}",Load])=3'
                  name: 'Load Sensor "{#SNMPVALUE}" is nonoperational'
                  priority: HIGH
                -
                  uuid: f9bcdab3a0b544abb9d63a76e1fb944c
                  expression: 'last(/Cisco_7600/entSensorStatus["{#SNMPVALUE}",Load])=2'
                  name: 'Load Sensor "{#SNMPVALUE}" is unavailable'
                  priority: AVERAGE
            -
              uuid: 91412633a4364312b015f0fd39e5006a
              name: 'Value of $2 Sensor "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.91.1.1.1.1.4.{#SNMPINDEX}'
              key: 'entSensorValue["{#SNMPVALUE}",Load]'
              delay: '60'
              value_type: FLOAT
              units: W
              description: |
                CISCO-ENTITY-SENSOR-MIB::entSensorValue
                
                This variable reports the most recent measurement seen by the sensor.
              tags:
                -
                  tag: Application
                  value: 'Load Sensors'
        -
          uuid: 972caedf47d84f60ac21157a03155887
          name: '$1 Sensors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.2.1.47.1.1.1.1.7]'
          key: 'entPhysicalName[Module]'
          delay: '300'
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: ^module
                formulaid: A
          lifetime: '0'
          description: 'The textual name of the physical entity.'
          item_prototypes:
            -
              uuid: 0da15746ac4e491daba3313aca8eec53
              name: 'Operational Status of $2 "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.117.1.2.1.1.2.{#SNMPINDEX}'
              key: 'cefcModuleOperStatus["{#SNMPVALUE}","Module"]'
              delay: '60'
              description: 'CISCO-ENTITY-FRU-CONTROL-MIB::cefcModuleOperStatus'
              tags:
                -
                  tag: Application
                  value: Modules
              trigger_prototypes:
                -
                  uuid: 16d36bc2d1684119ab5e6b2d30105b98
                  expression: 'last(/Cisco_7600/cefcModuleOperStatus["{#SNMPVALUE}","Module"])=15'
                  name: 'Module "{#SNMPVALUE}" is powered down'
                  priority: HIGH
                -
                  uuid: 4ba0409500ff402c9f5f1b6965708e3b
                  expression: 'last(/Cisco_7600/cefcModuleOperStatus["{#SNMPVALUE}","Module"])>3 and last(/Cisco_7600/cefcModuleOperStatus["{#SNMPVALUE}","Module"])<>15'
                  name: 'Module "{#SNMPVALUE}" is unstable [{ITEM.LASTVALUE1}]'
                  priority: HIGH
            -
              uuid: 9d65b23c444e493295438deb5339e39c
              name: 'Manufacturer of $2 "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.12.{#SNMPINDEX}'
              key: 'entPhysicalMfgName["{#SNMPVALUE}","Module"]'
              delay: '86400'
              trends: '0'
              value_type: CHAR
              description: |
                ENTITY-MIB::entPhysicalMfgName
                
                The name of the manufacturer of this physical component. The preferred value is the manufacturer name string actually printed on the component itself (if present).
              tags:
                -
                  tag: Application
                  value: Modules
            -
              uuid: 9590ea05e66e48618fe649c75e62a8e8
              name: 'Model Name of $2 "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.13.{#SNMPINDEX}'
              key: 'entPhysicalModelName["{#SNMPVALUE}","Module"]'
              delay: '86400'
              trends: '0'
              value_type: CHAR
              description: |
                ENTITY-MIB::entPhysicalModelName
                
                The vendor-specific model name identifier string associated with this physical component.  The preferred value is the customer-visible part number, which may be printed on the component itself.
              tags:
                -
                  tag: Application
                  value: Modules
            -
              uuid: 2382d34536764823bfe53f36b54c42f8
              name: 'Serial Number of $2 "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.11.{#SNMPINDEX}'
              key: 'entPhysicalSerialNum["{#SNMPVALUE}","Module"]'
              delay: '3600'
              trends: '0'
              value_type: CHAR
              description: |
                ENTITY-MIB::entPhysicalSerialNum
                
                The vendor-specific serial number string for the physical entity. The preferred value is the serial number string actually printed on the component itself (if present).
              tags:
                -
                  tag: Application
                  value: Modules
            -
              uuid: 68c6b9a4970e486cad69572f0c73f7b0
              name: 'Module Trap Status'
              type: SNMP_TRAP
              key: 'snmptrap["cefcModuleStatusChange.*cefcModuleOperStatus\.{#SNMPINDEX}[[:space:]]"]'
              delay: '0'
              history: 1d
              trends: '0'
              value_type: LOG
              logtimefmt: yyyyMMdd.hhmmss
              tags:
                -
                  tag: Application
                  value: Modules
        -
          uuid: 8ed26f848f7e4801bf59a975c8d3ce34
          name: '$1 Sensors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.2.1.47.1.1.1.1.7]'
          key: 'entPhysicalName[Temperature]'
          delay: '300'
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: temperature
                formulaid: A
          lifetime: '0'
          description: 'The textual name of the physical entity.'
          item_prototypes:
            -
              uuid: 78fdc749027a478192fe900c461b1a95
              name: 'Status of $2 Sensor "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.91.1.1.1.1.5.{#SNMPINDEX}'
              key: 'entSensorStatus["{#SNMPVALUE}",Temperature]'
              delay: '60'
              description: |
                CISCO-ENTITY-SENSOR-MIB::entSensorStatus
                
                This variable indicates the present operational status of the sensor.
              tags:
                -
                  tag: Application
                  value: Temperature
              trigger_prototypes:
                -
                  uuid: 489cb13369564f50a4c62b17315c1ecd
                  expression: 'last(/Cisco_7600/entSensorStatus["{#SNMPVALUE}",Temperature])=3'
                  name: 'Temperature Sensor "{#SNMPVALUE}" is nonoperational'
                  priority: HIGH
                -
                  uuid: c54203c84d9b4382a365ae022b95b88c
                  expression: 'last(/Cisco_7600/entSensorStatus["{#SNMPVALUE}",Temperature])=2'
                  name: 'Temperature Sensor "{#SNMPVALUE}" is unavailable'
                  priority: AVERAGE
            -
              uuid: cc09711d299b4b01b0bcd9b565e13f56
              name: '$2 on Sensor "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.91.1.1.1.1.4.{#SNMPINDEX}'
              key: 'entSensorValue["{#SNMPVALUE}",Temperature]'
              delay: '60'
              value_type: FLOAT
              units: °C
              description: |
                CISCO-ENTITY-SENSOR-MIB::entSensorValue
                
                This variable reports the most recent measurement seen by the sensor.
              tags:
                -
                  tag: Application
                  value: Temperature
        -
          uuid: fd025e9c485a44d09a05a05edfbd99ee
          name: '$1 Sensors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.2.1.47.1.1.1.1.7]'
          key: 'entPhysicalName[Voltage]'
          delay: '300'
          filter:
            conditions:
              -
                macro: '{#SNMPVALUE}'
                value: ^voltage
                formulaid: A
          lifetime: '0'
          description: 'The textual name of the physical entity.'
          item_prototypes:
            -
              uuid: 9e6253e0fcb24041b08fcc51492314b3
              name: 'Status of $2 Sensor "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.91.1.1.1.1.5.{#SNMPINDEX}'
              key: 'entSensorStatus["{#SNMPVALUE}",Voltage]'
              delay: '60'
              description: |
                CISCO-ENTITY-SENSOR-MIB::entSensorStatus
                
                This variable indicates the present operational status of the sensor.
              tags:
                -
                  tag: Application
                  value: 'Voltage Sensors'
              trigger_prototypes:
                -
                  uuid: bf65a87e5c8a43a396d3495a0b2df39a
                  expression: 'last(/Cisco_7600/entSensorStatus["{#SNMPVALUE}",Voltage])=3'
                  name: 'Voltage Sensor "{#SNMPVALUE}" is nonoperational'
                  priority: HIGH
                -
                  uuid: ef63e3db014940e180ea85604d81c0bd
                  expression: 'last(/Cisco_7600/entSensorStatus["{#SNMPVALUE}",Voltage])=2'
                  name: 'Voltage Sensor "{#SNMPVALUE}" is unavailable'
                  priority: AVERAGE
            -
              uuid: 2ce04e9ad8c94eddba237346fd2105f2
              name: '$2 on Sensor "$1"'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.9.9.91.1.1.1.1.4.{#SNMPINDEX}'
              key: 'entSensorValue["{#SNMPVALUE}",Voltage]'
              delay: '60'
              value_type: FLOAT
              units: V
              description: |
                CISCO-ENTITY-SENSOR-MIB::entSensorValue
                
                This variable reports the most recent measurement seen by the sensor.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                -
                  tag: Application
                  value: 'Voltage Sensors'
    -
      uuid: aaf832cd9bb244afbadf7dd283fa0ca1
      template: 'Template Cisco General'
      name: 'Template Cisco General'
      groups:
        -
          name: 'Templates SNMP Devices'
      discovery_rules:
        -
          uuid: d8a4d8de88734cd5973dae0b4d323d1f
          name: 'BGP Peers'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.2.1.15.3.1.1]'
          key: bgpPeerIdentifier
          delay: '300'
          lifetime: '0'
          description: 'BGP4-MIB::bgpPeerIdentifier'
          item_prototypes:
            -
              uuid: 06cb527e41d84c4cbb5d670187523709
              name: 'BGP Peer "{#SNMPINDEX}" State'
              type: SNMP_TRAP
              key: 'snmptrap["(bgpBackwardTransition|cbgpFsmStateChange).*bgpPeerState\.{#SNMPINDEX}[[:space:]][a-zA-Z]+[[:space:]]"]'
              delay: '0'
              history: 5d
              trends: '0'
              value_type: LOG
              logtimefmt: yyyyMMdd.hhmmss
              tags:
                -
                  tag: Application
                  value: 'BGP Peers'
              trigger_prototypes:
                -
                  uuid: 31c73d1b6f804813a347863db837bd53
                  expression: 'nodata(/Template Cisco General/snmptrap["(bgpBackwardTransition|cbgpFsmStateChange).*bgpPeerState\.{#SNMPINDEX}[[:space:]][a-zA-Z]+[[:space:]]"],10m)=0'
                  name: 'BGP Peer "{#SNMPINDEX}"->"{#SNMPVALUE}" State changed'
                  priority: AVERAGE
            -
              uuid: 3d637feb8dee4df8b9ef5674e9a3ea39
              name: 'BGP Peer "{#SNMPINDEX}" State'
              type: SNMP_TRAP
              key: 'snmptrap["(bgpEstablished|bgpBackwardTransition|cbgpFsmStateChange).*bgpPeerState\.{#SNMPINDEX}[[:space:]][a-zA-Z]+[[:space:]]"]'
              delay: '0'
              history: 5d
              trends: '0'
              value_type: LOG
              logtimefmt: yyyyMMdd.hhmmss
              tags:
                -
                  tag: Application
                  value: 'BGP Peers'
              trigger_prototypes:
                -
                  uuid: 70cdd15c1792488fb69fce4ddbc192a4
                  expression: 'nodata(/Template Cisco General/snmptrap["(bgpEstablished|bgpBackwardTransition|cbgpFsmStateChange).*bgpPeerState\.{#SNMPINDEX}[[:space:]][a-zA-Z]+[[:space:]]"],10m)=0'
                  name: 'BGP Peer "{#SNMPINDEX}"->"{#SNMPVALUE}" State changed'
                  priority: AVERAGE
        -
          uuid: b976e273329844f2a50cb32699b62504
          name: 'OSPF Interfaces'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.2.1.14.7.1.1]'
          key: ospfIfIpAddress
          delay: '300'
          lifetime: '0'
          description: |
            OSPF-MIB::ospfIfIpAddress
            
            The IP address of this OSPF interface.
          item_prototypes:
            -
              uuid: f9d9e6fc1d6a448e83083a2bb10a2375
              name: 'OSPF Interface "{SNMPVALUE}" State'
              type: SNMP_TRAP
              key: 'snmptrap["ospfIfStateChange.+ospfIfIpAddress[[:space:]]{#SNMPVALUE}[[:space:]].+ospfIfState[[:space:]][a-zA-Z]+"]'
              delay: '0'
              history: 5d
              trends: '0'
              value_type: LOG
              logtimefmt: yyyyMMdd.hhmmss
              tags:
                -
                  tag: Application
                  value: 'OSPF Interfaces'
              trigger_prototypes:
                -
                  uuid: a5939ae9503d42dba1e92cabe9149ade
                  expression: 'nodata(/Template Cisco General/snmptrap["ospfIfStateChange.+ospfIfIpAddress[[:space:]]{#SNMPVALUE}[[:space:]].+ospfIfState[[:space:]][a-zA-Z]+"],10m)=0'
                  name: 'OSPF Interface "{#SNMPVALUE}" State has been changed'
                  priority: AVERAGE
        -
          uuid: 288da292e4514a67bb8ee9bbd5ca44f3
          name: 'OSPF Neighbors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.2.1.14.10.1.1]'
          key: ospfNbrIpAddr
          delay: '300'
          lifetime: '0'
          description: |
            OSPF-MIB::ospfNbrIpAddr
            
            
            The IP address this neighbor is using in its IP source address.  Note that, on addressless links, this will not be 0.0.0.0 but the address of another of the neighbor's interfaces.
          item_prototypes:
            -
              uuid: 20b1bf6660e649a9bb6702942e7199a3
              name: 'OSPF "{#SNMPVALUE}" Neighbour State'
              type: SNMP_TRAP
              key: 'snmptrap["(ospfNbrStateChange).*ospfNbrIpAddr[[:space:]]{#SNMPVALUE}[[:space:]].*[[:space:]][a-zA-Z]+[[:space:]]$"]'
              delay: '0'
              history: 5d
              trends: '0'
              value_type: LOG
              logtimefmt: yyyyMMdd.hhmmss
              tags:
                -
                  tag: Application
                  value: 'OSPF Neighbor States'
              trigger_prototypes:
                -
                  uuid: de9dfb7aff8b47408308d721e93b9339
                  expression: 'nodata(/Template Cisco General/snmptrap["(ospfNbrStateChange).*ospfNbrIpAddr[[:space:]]{#SNMPVALUE}[[:space:]].*[[:space:]][a-zA-Z]+[[:space:]]$"],10m)=0'
                  name: 'OSPF Neighbor {#SNMPVALUE} has been changed'
                  priority: AVERAGE
    -
      uuid: c8a076efd8704fb08209b260723a815a
      template: Template_Cisco_Traps
      name: Template_Cisco_Traps
      groups:
        -
          name: 'Templates SNMP Devices'
      items:
        -
          uuid: 9a06f3474b8d4f6e84e4a18a86563c90
          name: 'BGP Peer State'
          type: SNMP_TRAP
          key: 'snmptrap["bgpPeerState|cbgpPeer2State"]'
          delay: '0'
          trends: '0'
          status: DISABLED
          value_type: LOG
          description: |
            BGP4-MIB::bgpPeerState
            CISCO-BGP4-MIB::cbgpPeer2State
            
            The BGP peer connection state.
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
          triggers:
            -
              uuid: ad4f2147d05f4d2396273b53558aff42
              expression: 'count(/Template_Cisco_Traps/snmptrap["bgpPeerState|cbgpPeer2State"],10m,"like","idle")>0 and nodata(/Template_Cisco_Traps/snmptrap["bgpPeerState|cbgpPeer2State"],10m)=0'
              name: 'BGP Peer State is idle'
              priority: WARNING
        -
          uuid: 36dae3b28a26497cba03b42413a56d8f
          name: 'Source of Command'
          type: SNMP_TRAP
          key: 'snmptrap["ccmHistoryEventCommandSource"]'
          delay: '0'
          history: '0'
          trends: '0'
          value_type: LOG
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
        -
          uuid: 727e514ddf2b457bbe85d922629d805f
          name: 'BFD Sessions'
          type: SNMP_TRAP
          key: 'snmptrap["ciscoBfdSess(Up|Down)"]'
          delay: '0'
          history: 5d
          trends: '0'
          value_type: LOG
          description: 'CISCO-IETF-BFD-MIB::ciscoBfdSessDown and ciscoBfdSessUp'
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
        -
          uuid: 0748431bfab5483aa2f76e7adba5da11
          name: 'Attack Filter changes'
          type: SNMP_TRAP
          key: 'snmptrap["cscaFilterChange"]'
          delay: '0'
          history: '0'
          trends: '0'
          value_type: LOG
          description: 'The system generates this notification to indicate that the cscaFilterStatus of the attack filter for cscaType has changed due to the reason determined by cscaDescription. The system limits the generation of this notifications for the same cscaType to a five-second interval.'
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
        -
          uuid: 4799ea7a51bf467b946d08d0dfbd20a4
          name: 'Status of Attack Filter'
          type: SNMP_TRAP
          key: 'snmptrap["cscaFilterStatus"]'
          delay: '0'
          history: '0'
          trends: '0'
          value_type: LOG
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
        -
          uuid: 3aaa748a254a46e1b98a6411675ad784
          name: 'SSH Sessions'
          type: SNMP_TRAP
          key: 'snmptrap["cssSessionHostAddr"]'
          delay: '0'
          history: 5d
          trends: '0'
          value_type: LOG
          description: 'CISCO-SECURE-SHELL-MIB::cssSessionHostAddr'
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
        -
          uuid: 26d14d78c9994c7eab1101a410f3dcec
          name: 'MPLS L3 State'
          type: SNMP_TRAP
          key: 'snmptrap["mplsL3VpnVrf[Up|Down]"]'
          delay: '0'
          trends: '0'
          value_type: LOG
          description: |
            MPLS-L3VPN-STD-MIB::mplsL3VpnVrfUp
            MPLS-L3VPN-STD-MIB::mplsL3VpnVrfDown
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
          triggers:
            -
              uuid: d272a7dd7fc94744ac188f00b0247980
              expression: 'find(/Template_Cisco_Traps/snmptrap["mplsL3VpnVrf[Up|Down]"],,"like","Down")=1'
              name: 'MPLS L3 is down'
              priority: AVERAGE
        -
          uuid: bd1cc9042b864ab1bb59b3cc3092e3a1
          name: 'OSPF Interface State'
          type: SNMP_TRAP
          key: 'snmptrap["ospfIfState"]'
          delay: '0'
          trends: '0'
          status: DISABLED
          value_type: LOG
          description: |
            OSPF-MIB::ospfIfState
            
            The OSPF Interface State.
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
          triggers:
            -
              uuid: 04c51014d65c4376950504bbbfb57733
              expression: 'count(/Template_Cisco_Traps/snmptrap["ospfIfState"],10m,"like","down")>0 and nodata(/Template_Cisco_Traps/snmptrap["ospfIfState"],10m)=0'
              name: 'OSPF Interface State is down'
              priority: WARNING
            -
              uuid: 7d4c396d908241d38cf6463bda2c1961
              expression: 'count(/Template_Cisco_Traps/snmptrap["ospfIfState"],10m,"like","loopback")>0 and nodata(/Template_Cisco_Traps/snmptrap["ospfIfState"],10m)=0'
              name: 'OSPF Interface State is loopback'
              priority: WARNING
            -
              uuid: d19b5f5cd3c946f2ac3c94dd0a0234e3
              expression: 'count(/Template_Cisco_Traps/snmptrap["ospfIfState"],10m,"like","waiting")>0 and nodata(/Template_Cisco_Traps/snmptrap["ospfIfState"],10m)=0'
              name: 'OSPF Interface State is waiting'
              priority: WARNING
        -
          uuid: e3b7631715f241cb92d120916eb487aa
          name: 'LSA aged to MaxAge'
          type: SNMP_TRAP
          key: 'snmptrap["ospfMaxAgeLsa"]'
          delay: '0'
          history: '0'
          trends: '0'
          value_type: LOG
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
        -
          uuid: 30b40030d93b4f9780ea5de6c0cf8c06
          name: 'OSPF neighbour state'
          type: SNMP_TRAP
          key: 'snmptrap["ospfNbrStateChange.*ospfNbrState[[:space:]]"]'
          delay: '0'
          history: '0'
          trends: '0'
          status: DISABLED
          value_type: LOG
          description: |
            1 : down
            2 : attempt
            3 : init
            4 : twoWay
            5 : exchangeStart
            6 : exchange
            7 : loading
            8 : full
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
        -
          uuid: fd1e6c8201b14231b250413541927260
          name: 'LSA has been originated'
          type: SNMP_TRAP
          key: 'snmptrap["ospfOriginateLsa"]'
          delay: '0'
          history: 5d
          trends: '0'
          value_type: LOG
          description: 'OSPF-TRAP-MIB::ospfOriginateLsa'
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
        -
          uuid: 1f20791fdc3143f69ad60cf86d12034a
          name: 'OSP TX Retransmits'
          type: SNMP_TRAP
          key: 'snmptrap["ospfTxRetransmit"]'
          delay: '0'
          history: 1d
          trends: '0'
          value_type: LOG
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
          triggers:
            -
              uuid: ff1ceb1dbb594bbe8d9f33318ad5c656
              expression: 'count(/Template_Cisco_Traps/snmptrap["ospfTxRetransmit"],1h,"like","ospfTxRetransmit")>30 and nodata(/Template_Cisco_Traps/snmptrap["ospfTxRetransmit"],1h)=0'
              name: 'Many OSPF TX Retransmits'
              priority: WARNING
        -
          uuid: 876a5022458c46d9b73b7563b62fd685
          name: 'Type of remote session'
          type: SNMP_TRAP
          key: 'snmptrap["tslineSesType"]'
          delay: '0'
          history: '0'
          trends: '0'
          value_type: LOG
          logtimefmt: yyyyMMdd.hhmmss
          tags:
            -
              tag: Application
              value: 'SNMP Traps'
