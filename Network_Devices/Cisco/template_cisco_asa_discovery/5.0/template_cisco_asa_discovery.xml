<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T10:03:56Z</date>
  <groups>
    <group>
      <name>Templates</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Template Cisco ASA Discovery</template>
      <name>Template Cisco ASA Discovery</name>
      <groups>
        <group>
          <name>Templates</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>General</name>
        </application>
        <application>
          <name>Interfaces</name>
        </application>
        <application>
          <name>VPN Lan-To-Lan</name>
        </application>
        <application>
          <name>VPN RemoteAccess</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Connections In Use</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-FIREWALL-MIB::cfwConnectionStatValue.protoIp.currentInUse</snmp_oid>
          <key>cfwConnectionStatValueCurrentInUse</key>
          <delay>60</delay>
          <history>7d</history>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Max Connections Supported</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-FIREWALL-MIB::cfwConnectionStatValue.protoIp.high</snmp_oid>
          <key>cfwConnectionStatValueHigh</key>
          <delay>3600</delay>
          <history>1d</history>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Failover status</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-FIREWALL-MIB::cfwHardwareStatusDetail.6</snmp_oid>
          <key>cfwHardwareStatusDetail</key>
          <delay>60</delay>
          <history>1d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>Can be "Active Unit" or "Passive Unit"</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{diff(0)}=1</expression>
              <name>{HOST.NAME} Failover status as changed</name>
              <priority>HIGH</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Memory Free</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-MEMORY-POOL-MIB::ciscoMemoryPoolFree.1</snmp_oid>
          <key>ciscoMemoryPoolFree</key>
          <delay>60</delay>
          <history>7d</history>
          <units>Byte</units>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Memory Pool Largest Free</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-MEMORY-POOL-MIB::ciscoMemoryPoolLargestFree.1</snmp_oid>
          <key>ciscoMemoryPoolLargestFree</key>
          <delay>60</delay>
          <history>7d</history>
          <units>Byte</units>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Memory Used</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-MEMORY-POOL-MIB::ciscoMemoryPoolUsed.1</snmp_oid>
          <key>ciscoMemoryPoolUsed</key>
          <delay>60</delay>
          <history>7d</history>
          <units>Byte</units>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Memoty Total</name>
          <type>CALCULATED</type>
          <key>ciscoMemoryTotal</key>
          <delay>3600</delay>
          <history>7d</history>
          <value_type>FLOAT</value_type>
          <units>Byte</units>
          <params>last("ciscoMemoryPoolUsed")+last("ciscoMemoryPoolFree")</params>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Memory Usage</name>
          <type>CALCULATED</type>
          <key>ciscoMemUsage</key>
          <delay>60</delay>
          <history>7d</history>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <params>100*last("ciscoMemoryPoolUsed")/last("ciscoMemoryTotal")</params>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>CPU Utilization avg last 1 min</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-PROCESS-MIB::cpmCPUTotal1minRev.1</snmp_oid>
          <key>cpmCPUTotal1minRev</key>
          <delay>60</delay>
          <history>7d</history>
          <units>%</units>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{last(0)}>80</expression>
              <name>{HOST.NAME} CPU Over 85 %</name>
              <priority>HIGH</priority>
              <description>{HOST.NAME} has had a CPU Utilization above 85 % for 3 samples taken in the last 1 minute 30 seconds.</description>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>CPU Utilization avg last 5 min</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-PROCESS-MIB::cpmCPUTotal5minRev.1</snmp_oid>
          <key>cpmCPUTotal5minRev</key>
          <delay>60</delay>
          <history>7d</history>
          <units>%</units>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>CPU Utilization avg last 5 sec</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-PROCESS-MIB::cpmCPUTotal5secRev.1</snmp_oid>
          <key>cpmCPUTotal5secRev</key>
          <delay>60</delay>
          <history>7d</history>
          <units>%</units>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{nodata(14400)}=1</expression>
              <name>{HOST.NAME} SNMP Failed</name>
              <priority>HIGH</priority>
              <description>{HOST.IP} SNMP Failed. Check configuration, ACL.</description>
              <dependencies>
                <dependency>
                  <name>{HOST.NAME} is unavailable by ICMP</name>
                  <expression>{Template Cisco ASA Discovery:icmpping.max(180)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Active IPSEC VPNs RemoteAccess</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-REMOTE-ACCESS-MONITOR-MIB::crasIPSecNumSessions.0</snmp_oid>
          <key>crasIPSecNumSessions</key>
          <delay>60</delay>
          <history>7d</history>
          <description>The number of currently active IPSEC sessions.</description>
          <applications>
            <application>
              <name>VPN RemoteAccess</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Active VPNs Lan-To-Lan</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-REMOTE-ACCESS-MONITOR-MIB::crasL2LNumSessions.0</snmp_oid>
          <key>crasL2LNumSessions</key>
          <delay>60</delay>
          <history>7d</history>
          <description>The number of currently active LAN to LAN sessions.</description>
          <applications>
            <application>
              <name>VPN Lan-To-Lan</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Active SSL VPNs RemoteAccess</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>CISCO-REMOTE-ACCESS-MONITOR-MIB::crasSVCNumSessions.0</snmp_oid>
          <key>crasSVCNumSessions</key>
          <delay>60</delay>
          <history>7d</history>
          <description>The number of currently active SVC sessions.</description>
          <applications>
            <application>
              <name>VPN RemoteAccess</name>
            </application>
          </applications>
        </item>
        <item>
          <name>ROMMON Versoin</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>ENTITY-MIB::entPhysicalFirmwareRev.1</snmp_oid>
          <key>entPhysicalFirmwareRev</key>
          <delay>3600</delay>
          <history>1d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <inventory_link>OS_SHORT</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Chassis Version</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>ENTITY-MIB::entPhysicalHardwareRev.1</snmp_oid>
          <key>entPhysicalHardwareRev</key>
          <delay>3600</delay>
          <history>1d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <inventory_link>CHASSIS</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Vendor Name</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>ENTITY-MIB::entPhysicalMfgName.1</snmp_oid>
          <key>entPhysicalMfgName</key>
          <delay>3600</delay>
          <history>1d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <inventory_link>VENDOR</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Model Name</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>ENTITY-MIB::entPhysicalModelName.1</snmp_oid>
          <key>entPhysicalModelName</key>
          <delay>3600</delay>
          <history>1d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <inventory_link>MODEL</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Chassis Serial Number</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>ENTITY-MIB::entPhysicalSerialNum.1</snmp_oid>
          <key>entPhysicalSerialNum</key>
          <delay>3600</delay>
          <history>1d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <inventory_link>SERIALNO_A</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>IOS Version</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>ENTITY-MIB::entPhysicalSoftwareRev.1</snmp_oid>
          <key>entPhysicalSoftwareRev</key>
          <delay>3600</delay>
          <history>1d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <inventory_link>OS_FULL</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{diff(0)}>0 and {strlen()}&lt;>0</expression>
              <name>IOS version has changed</name>
              <priority>INFO</priority>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>ICMP Ping</name>
          <type>SIMPLE</type>
          <key>icmpping</key>
          <delay>30</delay>
          <history>1d</history>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <valuemap>
            <name>Service state</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{max(180)}=0</expression>
              <name>{HOST.NAME} is unavailable by ICMP</name>
              <priority>DISASTER</priority>
              <description>{HOST.IP} not responding to ICMP in 3 minutes</description>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>ICMP loss</name>
          <type>SIMPLE</type>
          <key>icmppingloss</key>
          <delay>60</delay>
          <history>7d</history>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{min(5m)}>20</expression>
              <name>Ping loss is too high on {HOST.NAME}</name>
              <priority>AVERAGE</priority>
              <description>Packet loss more than 20% on {HOST.IP}</description>
              <dependencies>
                <dependency>
                  <name>{HOST.NAME} is unavailable by ICMP</name>
                  <expression>{Template Cisco ASA Discovery:icmpping.max(180)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>ICMP response time</name>
          <type>SIMPLE</type>
          <key>icmppingsec</key>
          <delay>60</delay>
          <history>7d</history>
          <value_type>FLOAT</value_type>
          <units>s</units>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{avg(10m)}>0.20</expression>
              <name>Response time is too high on {HOST.NAME}</name>
              <priority>WARNING</priority>
              <description>Response time more than 200ms for 10 minutes.</description>
              <dependencies>
                <dependency>
                  <name>{HOST.NAME} is unavailable by ICMP</name>
                  <expression>{Template Cisco ASA Discovery:icmpping.max(180)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Number of network interfaces</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>IF-MIB::ifNumber.0</snmp_oid>
          <key>ifNumber</key>
          <delay>3600</delay>
          <history>7d</history>
          <description>The number of network interfaces (regardless of their current state) present on this system.</description>
          <applications>
            <application>
              <name>Interfaces</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Description</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysDescr.0</snmp_oid>
          <key>sysDescr</key>
          <delay>3600</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <inventory_link>OS</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>sysUpTime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysUpTime.0</snmp_oid>
          <key>sysUpTime</key>
          <delay>300</delay>
          <history>7d</history>
          <value_type>FLOAT</value_type>
          <units>uptime</units>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{last(0)}&lt;600</expression>
              <name>{HOST.NAME} reloaded</name>
              <priority>AVERAGE</priority>
              <description>{HOST.NAME} reloaded</description>
            </trigger>
          </triggers>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>ASA Interfaces discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr]</snmp_oid>
          <key>ifDescr</key>
          <delay>3600</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPVALUE}</macro>
                <value>@Firewalls network interfaces for discovery</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <lifetime>14d</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>$1 AdminStatus</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifAdminStatus.{#SNMPINDEX}</snmp_oid>
              <key>ifAdminStatus[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <description>The desired state of the interface.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <valuemap>
                <name>SNMP interface status (ifAdminStatus)</name>
              </valuemap>
            </item_prototype>
            <item_prototype>
              <name>$1 Description</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifDescr.{#SNMPINDEX}</snmp_oid>
              <key>ifDescr[{#SNMPVALUE}]</key>
              <delay>3600</delay>
              <history>7d</history>
              <trends>0</trends>
              <value_type>CHAR</value_type>
              <description>A textual string containing information about the interface. This string should include the name of the manufacturer, the product name and the version of the interface hardware/software.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>$1 InBroadcastPkts</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifInBroadcastPkts.{#SNMPINDEX}</snmp_oid>
              <key>ifInBroadcastPkts[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>6d</history>
              <units>pps</units>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 InErrors</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifInErrors.{#SNMPINDEX}</snmp_oid>
              <key>ifInErrors[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <description>For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol. For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 InMulticastPkts</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifInMulticastPkts.{#SNMPINDEX}</snmp_oid>
              <key>ifInMulticastPkts[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <units>pps</units>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 InOctets</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifInOctets.{#SNMPINDEX}</snmp_oid>
              <key>ifInOctets[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <units>bps</units>
              <description>The number of octets in valid MAC frames received on this interface, including the MAC header and FCS.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 InUcastPkts</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifInUcastPkts.{#SNMPINDEX}</snmp_oid>
              <key>ifInUcastPkts[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <units>pps</units>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 OperStatus</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
              <key>ifOperStatus[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <description>The current operational state of the interface.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <valuemap>
                <name>SNMP interface status (ifOperStatus)</name>
              </valuemap>
            </item_prototype>
            <item_prototype>
              <name>$1 OutBroadcastPkts</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOutBroadcastPkts.{#SNMPINDEX}</snmp_oid>
              <key>ifOutBroadcastPkts[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <units>pps</units>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 OutErrors</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOutErrors.{#SNMPINDEX}</snmp_oid>
              <key>ifOutErrors[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <description>For packet-oriented interfaces, the number of outbound packets that could not be transmitted because of errors. For character-oriented or fixed-length interfaces, the number of outbound transmission units that could not be transmitted because of errors.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 OutMulticastPkts</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOutMulticastPkts.{#SNMPINDEX}</snmp_oid>
              <key>ifOutMulticastPkts[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <units>pps</units>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 OutOctets</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOutOctets.{#SNMPINDEX}</snmp_oid>
              <key>ifOutOctets[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <units>bps</units>
              <description>The number of octets transmitted in MAC frames on this interface, including the MAC header and FCS.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 OutUcastPkts</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOutUcastPkts.{#SNMPINDEX}</snmp_oid>
              <key>ifOutUcastPkts[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <units>pps</units>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>$1 Speed</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifSpeed.{#SNMPINDEX}</snmp_oid>
              <key>ifSpeed[{#SNMPVALUE}]</key>
              <delay>60</delay>
              <history>7d</history>
              <units>bps</units>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
          <trigger_prototypes>
            <trigger_prototype>
              <expression>{Template Cisco ASA Discovery:ifInErrors[{#SNMPVALUE}].last(0)}>100 or {Template Cisco ASA Discovery:ifOutErrors[{#SNMPVALUE}].last(0)}>100</expression>
              <name>Errors on {#SNMPVALUE}</name>
              <priority>WARNING</priority>
              <description>More than 100 in/out errors detected on {#SNMPVALUE}</description>
            </trigger_prototype>
          </trigger_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>{#SNMPVALUE} Packets</name>
              <height>400</height>
              <show_work_period>NO</show_work_period>
              <show_triggers>NO</show_triggers>
              <ymin_type_1>FIXED</ymin_type_1>
              <graph_items>
                <graph_item>
                  <color>009900</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifInUcastPkts[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>AA00AA</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifInBroadcastPkts[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>2</sortorder>
                  <color>000000</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifInMulticastPkts[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>3</sortorder>
                  <color>880000</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifOutBroadcastPkts[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>4</sortorder>
                  <color>888800</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifOutMulticastPkts[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>5</sortorder>
                  <color>000099</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifOutUcastPkts[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
            <graph_prototype>
              <name>{#SNMPVALUE} Traffic</name>
              <height>400</height>
              <show_work_period>NO</show_work_period>
              <graph_items>
                <graph_item>
                  <drawtype>GRADIENT_LINE</drawtype>
                  <color>00AA00</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifInOctets[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <drawtype>GRADIENT_LINE</drawtype>
                  <color>3333FF</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifOutOctets[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>2</sortorder>
                  <color>FF3333</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifInErrors[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>3</sortorder>
                  <color>FFFF33</color>
                  <item>
                    <host>Template Cisco ASA Discovery</host>
                    <key>ifOutErrors[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
      </discovery_rules>
    </template>
  </templates>
  <triggers>
    <trigger>
      <expression>{Template Cisco ASA Discovery:cfwConnectionStatValueCurrentInUse.last(0)}/{Template Cisco ASA Discovery:cfwConnectionStatValueHigh.last(0)}>0.80</expression>
      <name>{HOST.NAME} Connections In Use > 80 %</name>
      <priority>HIGH</priority>
      <description>Connections In Use > 80 %</description>
    </trigger>
    <trigger>
      <expression>{Template Cisco ASA Discovery:ciscoMemoryPoolFree.min(10)}/{Template Cisco ASA Discovery:ciscoMemoryTotal.last(0)}&lt; 0.05</expression>
      <name>{HOST.NAME} Memory Free &lt; 5 %</name>
      <priority>AVERAGE</priority>
      <description>Memory Free &lt; 5 %</description>
    </trigger>
  </triggers>
  <graphs>
    <graph>
      <name>Active VPNs</name>
      <show_triggers>NO</show_triggers>
      <ymin_type_1>FIXED</ymin_type_1>
      <graph_items>
        <graph_item>
          <drawtype>GRADIENT_LINE</drawtype>
          <color>00EE00</color>
          <item>
            <host>Template Cisco ASA Discovery</host>
            <key>crasSVCNumSessions</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <drawtype>GRADIENT_LINE</drawtype>
          <color>0000EE</color>
          <item>
            <host>Template Cisco ASA Discovery</host>
            <key>crasL2LNumSessions</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <color>EEEE00</color>
          <item>
            <host>Template Cisco ASA Discovery</host>
            <key>crasIPSecNumSessions</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>Connections Usage</name>
      <height>400</height>
      <show_work_period>NO</show_work_period>
      <ymin_type_1>FIXED</ymin_type_1>
      <ymax_type_1>ITEM</ymax_type_1>
      <ymax_item_1>
        <host>Template Cisco ASA Discovery</host>
        <key>cfwConnectionStatValueHigh</key>
      </ymax_item_1>
      <graph_items>
        <graph_item>
          <drawtype>BOLD_LINE</drawtype>
          <color>00AA00</color>
          <item>
            <host>Template Cisco ASA Discovery</host>
            <key>cfwConnectionStatValueCurrentInUse</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>CPU Load</name>
      <height>400</height>
      <show_work_period>NO</show_work_period>
      <show_triggers>NO</show_triggers>
      <ymin_type_1>FIXED</ymin_type_1>
      <ymax_type_1>FIXED</ymax_type_1>
      <graph_items>
        <graph_item>
          <color>0000EE</color>
          <item>
            <host>Template Cisco ASA Discovery</host>
            <key>cpmCPUTotal5minRev</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>00EE00</color>
          <item>
            <host>Template Cisco ASA Discovery</host>
            <key>cpmCPUTotal1minRev</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>2</sortorder>
          <drawtype>FILLED_REGION</drawtype>
          <color>EE0000</color>
          <item>
            <host>Template Cisco ASA Discovery</host>
            <key>cpmCPUTotal5secRev</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>ICMP Ping</name>
      <height>400</height>
      <show_work_period>NO</show_work_period>
      <show_triggers>NO</show_triggers>
      <ymin_type_1>FIXED</ymin_type_1>
      <graph_items>
        <graph_item>
          <drawtype>BOLD_LINE</drawtype>
          <color>005500</color>
          <item>
            <host>Template Cisco ASA Discovery</host>
            <key>icmppingsec</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>Memory Usage</name>
      <height>400</height>
      <show_work_period>NO</show_work_period>
      <show_triggers>NO</show_triggers>
      <ymin_type_1>FIXED</ymin_type_1>
      <ymax_type_1>ITEM</ymax_type_1>
      <ymax_item_1>
        <host>Template Cisco ASA Discovery</host>
        <key>ciscoMemoryTotal</key>
      </ymax_item_1>
      <graph_items>
        <graph_item>
          <drawtype>BOLD_LINE</drawtype>
          <color>00AA00</color>
          <item>
            <host>Template Cisco ASA Discovery</host>
            <key>ciscoMemoryPoolUsed</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
  </graphs>
  <value_maps>
    <value_map>
      <name>Service state</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Down</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Up</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>SNMP interface status (ifAdminStatus)</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>up</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>down</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>testing</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>SNMP interface status (ifOperStatus)</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>up</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>down</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>testing</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>unknown</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>dormant</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>notPresent</newvalue>
        </mapping>
        <mapping>
          <value>7</value>
          <newvalue>lowerLayerDown</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>