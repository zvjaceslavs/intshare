zabbix_export:
  version: '5.4'
  date: '2021-11-21T22:09:33Z'
  groups:
    -
      uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    -
      uuid: 014a2f11f7b947e78fe606561cc490c8
      template: monitor_Firewall_H3C_SecPath
      name: 华三SecPath防火墙监控模板
      description: |
        ## Overview
        
        新华三SecPath系列防火墙监控模板
        
        
        已在M9010、M9008完成验证
        
        
        主要包括CPU利用率、内存利用率、端口状态、端口带宽利用率、端口报文速率、并发会话、新建会话、实体（电源、风扇、板卡）状态
        
        
        将宏 {$CLOUD\_SNMP\_COMMUNITY} 替换为实际团体字即可
        
        
        
        ## Author
        
        zhangzhefeng
        
        
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: 25d856713e6e41168eb322454098b3a5
          name: ping丢包率
          type: SIMPLE
          key: 'icmppingloss[,10,,,]'
          delay: 5m
          history: 7d
          trends: 0d
          value_type: FLOAT
          units: '%'
          tags:
            -
              tag: Application
              value: ping检测
          triggers:
            -
              uuid: 270f63ad4c334a3fbb3f5c6b49b245e1
              expression: 'avg(/monitor_Firewall_H3C_SecPath/icmppingloss[,10,,,],10m)>{$ICMP_LOSS_WARN}'
              name: 'ICMP ping 丢包'
              priority: AVERAGE
              description: 'Last value: {ITEM.LASTVALUE1}.'
              type: MULTIPLE
              manual_close: 'YES'
              dependencies:
                -
                  name: 'ICMP ping不可达'
                  expression: 'last(/monitor_Firewall_H3C_SecPath/icmpping[,5,,,],#1)=0 and last(/monitor_Firewall_H3C_SecPath/icmpping[,5,,,],#2)=1'
        -
          uuid: 0181a1ba9b1d4af280ec37b495dee310
          name: ping时延
          type: SIMPLE
          key: 'icmppingsec[,10,,,,avg]'
          delay: 5m
          history: 7d
          trends: 0d
          value_type: FLOAT
          units: s
          tags:
            -
              tag: Application
              value: ping检测
          triggers:
            -
              uuid: d48bc466aac64b8e8b30ac25bd4e186c
              expression: 'min(/monitor_Firewall_H3C_SecPath/icmppingsec[,10,,,,avg],10m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'ICMP ping 时延高'
              priority: AVERAGE
              description: 'Last value: {ITEM.LASTVALUE1}.'
              type: MULTIPLE
              manual_close: 'YES'
              dependencies:
                -
                  name: 'ICMP ping不可达'
                  expression: 'last(/monitor_Firewall_H3C_SecPath/icmpping[,5,,,],#1)=0 and last(/monitor_Firewall_H3C_SecPath/icmpping[,5,,,],#2)=1'
        -
          uuid: 9fbab5b44e9d4da2be342f55643a0e6a
          name: 'ICMP ping'
          type: SIMPLE
          key: 'icmpping[,5,,,]'
          history: 7d
          trends: 0d
          tags:
            -
              tag: Application
              value: ping检测
          triggers:
            -
              uuid: 07f73f8ef9f34f658f761b36a1c78f7e
              expression: 'last(/monitor_Firewall_H3C_SecPath/icmpping[,5,,,],#1)=0 and last(/monitor_Firewall_H3C_SecPath/icmpping[,5,,,],#2)=1'
              name: 'ICMP ping不可达'
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: d3e8894242b745219b9f0232563cb788
              expression: 'last(/monitor_Firewall_H3C_SecPath/icmpping[,5,,,],#1)=0'
              name: 监控失效（ping不通）
              priority: INFO
              manual_close: 'YES'
              tags:
                -
                  tag: 监控失效原因
                  value: ping不通
        -
          uuid: 28020f725f0945ef8622ce1897c302a9
          name: trap消息
          type: SNMP_TRAP
          key: 'snmptrap[""]'
          delay: '0'
          history: 30d
          trends: '0'
          value_type: LOG
          tags:
            -
              tag: Application
              value: trap消息
          triggers:
            -
              uuid: ec19bacc8abb4b54aa2477fb7d8411a6
              expression: 'find(/monitor_Firewall_H3C_SecPath/snmptrap[""],,"iregexp",".*")=1'
              name: trap告警
              priority: AVERAGE
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: 641304344fcb47969ba551506e2e2c11
              expression: 'find(/monitor_Firewall_H3C_SecPath/snmptrap[""],,"iregexp","coldStart")=1'
              name: 冷重启告警
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: 45d5493b47b144baa8b6eb1d40d1b9a6
              expression: 'find(/monitor_Firewall_H3C_SecPath/snmptrap[""],,"regexp","hh3cEntityExt")=1'
              name: 实体告警
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: 68d2b745d633414cba63919c777e6b24
              expression: 'find(/monitor_Firewall_H3C_SecPath/snmptrap[""],,"regexp","hh3cBoard")=1'
              name: 板卡告警
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: 75dc16b92287494b86d07ed5b55c29b6
              expression: 'find(/monitor_Firewall_H3C_SecPath/snmptrap[""],,"iregexp","warmStart")=1'
              name: 热重启告警
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: 6899eec996db4be89d4e1c2035c9c09b
              expression: 'find(/monitor_Firewall_H3C_SecPath/snmptrap[""],,"regexp","hh3cPower")=1'
              name: 电源告警
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: beae0c16a0924c74b8f09cd27c7dc881
              expression: 'find(/monitor_Firewall_H3C_SecPath/snmptrap[""],,"iregexp","linkDown")=1'
              name: 端口down
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
            -
              uuid: 11f5c25ee0ed4452a85b2d17d780b2b0
              expression: 'find(/monitor_Firewall_H3C_SecPath/snmptrap[""],,"regexp","hh3cFan")=1'
              name: 风扇告警
              priority: HIGH
              type: MULTIPLE
              manual_close: 'YES'
        -
          uuid: 90a9f4bf881840bea3801c9061bd49c0
          name: 系统信息
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: SystemDescription
          delay: 1h
          history: 3d
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: Application
              value: 系统信息
          triggers:
            -
              uuid: 9711a4e0b3be4bef90f6d6a77f4522c2
              expression: 'nodata(/monitor_Firewall_H3C_SecPath/SystemDescription,12h)=1'
              name: 监控失效（snmp不通）
              priority: INFO
              manual_close: 'YES'
              tags:
                -
                  tag: 监控失效原因
                  value: snmp不通
        -
          uuid: 36c6f5f987a2469aaa0225448add8fa8
          name: 运行时间
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: SystemUpTime
          delay: 1h
          history: 3d
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: Application
              value: 系统信息
      discovery_rules:
        -
          uuid: fd09efcff13b439bbe882f920dd46d87
          name: 板卡发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ENTITYDESCR},1.3.6.1.2.1.47.1.1.1.1.7,{#ENTITYTYPE},1.3.6.1.2.1.47.1.1.1.1.5]'
          key: BoardDiscovery
          delay: 12h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#ENTITYTYPE}'
                value: '9'
                formulaid: D
              -
                macro: '{#ENTITYDESCR}'
                value: '.*virtue.*'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#ENTITYDESCR}'
                value: '.*Unknown.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#ENTITYDESCR}'
                value: '.*virtual.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          lifetime: 0d
          item_prototypes:
            -
              uuid: c9eb7179c5884c63b4d7006352d82fe0
              name: 'CPU利用率 {#ENTITYDESCR}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.6.1.1.1.1.6.{#SNMPINDEX}'
              key: 'MONITOR_CPUUsage.[{#SNMPINDEX},{#ENTITYDESCR}]'
              delay: 5m
              history: 3d
              trends: 0d
              units: '%'
              tags:
                -
                  tag: Application
                  value: CPU情况
              trigger_prototypes:
                -
                  uuid: 6abddbf60a654305b1ee78b3e6b3992e
                  expression: 'min(/monitor_Firewall_H3C_SecPath/MONITOR_CPUUsage.[{#SNMPINDEX},{#ENTITYDESCR}],#2)>{$CPU_USAGE_THRESHOLD}'
                  name: CPU利用率高
                  priority: HIGH
                  description: '2个周期CPU利用率均大于宏{$CPU_USAGE_THRESHOLD}'
                  type: MULTIPLE
                  manual_close: 'YES'
            -
              uuid: c73b08339d0c4ed7887b3cf13a970c5a
              name: '内存利用率 {#ENTITYDESCR}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.6.1.1.1.1.8.{#SNMPINDEX}'
              key: 'MONITOR_MemoryUsage.[{#SNMPINDEX},{#ENTITYDESCR}]'
              delay: 5m
              history: 3d
              trends: 0d
              units: '%'
              tags:
                -
                  tag: Application
                  value: 内存情况
              trigger_prototypes:
                -
                  uuid: f2108b03b060447fae59b73b9af1e741
                  expression: 'min(/monitor_Firewall_H3C_SecPath/MONITOR_MemoryUsage.[{#SNMPINDEX},{#ENTITYDESCR}],#2)>{$MEMORY_USAGE_THRESHOLD}'
                  name: 内存利用率高
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
        -
          uuid: a63d568bd6d244d2aa24823de6d858a0
          name: CPU发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.25506.2.149.1.1.1.4]'
          key: CPUDiscovery
          delay: 1d
          lifetime: 0d
          item_prototypes:
            -
              uuid: ad7e88aab51e4cd48ef41cad0bb80873
              name: '并发会话数 CPU[{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.149.1.1.1.4.{#SNMPINDEX}'
              key: 'CurrentSessionNumber.[{#SNMPINDEX}]'
              delay: 3m
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: 并发会话数
            -
              uuid: 7c975375025048bbac112d537160cfa2
              name: '其他新建会话速率 CPU[{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.149.1.1.1.11.{#SNMPINDEX}'
              key: 'OtherSessionCreatedRate.[{#SNMPINDEX}]'
              delay: 3m
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: 新建会话数
            -
              uuid: 9abc3a074ee14dc9b98b6a720a8fb2a5
              name: '其他并发会话数 CPU[{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.149.1.1.1.8.{#SNMPINDEX}'
              key: 'OtherSessionNumber.[{#SNMPINDEX}]'
              delay: 3m
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: 并发会话数
            -
              uuid: 3d34694a12104824a45bc918fbe8ac9a
              name: '新建会话速率 CPU[{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.149.1.1.1.5.{#SNMPINDEX}'
              key: 'SessionCreatedRate.[{#SNMPINDEX}]'
              delay: 3m
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: 新建会话数
            -
              uuid: 84ca68c80ba14ae8b82947ab8ca03d3b
              name: 'TCP新建会话速率 CPU[{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.149.1.1.1.9.{#SNMPINDEX}'
              key: 'TCPSessionCreatedRate[{#SNMPINDEX}]'
              delay: 3m
              history: 3d
              trends: 0d
              tags:
                -
                  tag: Application
                  value: 新建会话数
            -
              uuid: 9d16781448ea424dad0433c12d68f5ec
              name: 'TCP并发会话数 CPU[{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.149.1.1.1.6.{#SNMPINDEX}'
              key: 'TCPSessionNumber.[{#SNMPINDEX}]'
              delay: 3m
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: 并发会话数
              trigger_prototypes:
                -
                  uuid: 96f7443779364133aa73123c4e59fed2
                  expression: 'min(/monitor_Firewall_H3C_SecPath/TCPSessionNumber.[{#SNMPINDEX}],#2)>{$TCP_SESSION_THRESHOLD}'
                  name: TCP并发会话数高
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
            -
              uuid: 0b8533f85ffe42d4bc19ecd778368846
              name: 'UDP新建会话速率 CPU[{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.149.1.1.1.10.{#SNMPINDEX}'
              key: 'UDPSessionCreatedRate.[{#SNMPINDEX}]'
              delay: 3m
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: 新建会话数
            -
              uuid: d3bb82acf8884e5d8f1367fc9067031a
              name: 'UDP并发会话数 CPU[{#SNMPINDEX}]'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.149.1.1.1.7.{#SNMPINDEX}'
              key: 'UDPSessionNumber.[{#SNMPINDEX}]'
              delay: 3m
              history: 3d
              trends: 0d
              units: 个
              tags:
                -
                  tag: Application
                  value: 并发会话数
              trigger_prototypes:
                -
                  uuid: 912274d36ada41f0bee6c563be1be533
                  expression: 'min(/monitor_Firewall_H3C_SecPath/UDPSessionNumber.[{#SNMPINDEX}],#2)>{$UDP_SESSION_THRESHOLD}'
                  name: UDP并发会话数高
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
        -
          uuid: 66d214a43e1a4268a7f4540fd6dd78c2
          name: 实体发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ENTITYDESCR},1.3.6.1.2.1.47.1.1.1.1.7,{#ENTITYTYPE},1.3.6.1.2.1.47.1.1.1.1.5]'
          key: EntityDiscovery
          delay: 12h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#ENTITYTYPE}'
                value: 6|7|9
                formulaid: D
              -
                macro: '{#ENTITYDESCR}'
                value: '.*virtue.*'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#ENTITYDESCR}'
                value: '.*Unknown.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#ENTITYDESCR}'
                value: '.*virtual.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          lifetime: 0d
          item_prototypes:
            -
              uuid: 4537057b1a5943229a7d9865d1545139
              name: '实体运行状态 {#ENTITYDESCR}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.25506.2.6.1.1.1.1.3.{#SNMPINDEX}'
              key: 'EntityOperationStatus.[{#SNMPINDEX}]'
              delay: 10m
              history: 3d
              trends: 0d
              valuemap:
                name: private-Hh3cOperState
              tags:
                -
                  tag: Application
                  value: 实体运行情况
              trigger_prototypes:
                -
                  uuid: 8d59fa14526d4eea86b3b3e98c77396c
                  expression: 'last(/monitor_Firewall_H3C_SecPath/EntityOperationStatus.[{#SNMPINDEX}],#1)=2'
                  name: '{#ENTITYDESCR} 实体失效'
                  priority: HIGH
                  manual_close: 'YES'
                -
                  uuid: 207f7eaebf634ddd99b403a63d9ffb0c
                  expression: 'last(/monitor_Firewall_H3C_SecPath/EntityOperationStatus.[{#SNMPINDEX}],#1)=4'
                  name: '{#ENTITYDESCR} 实体故障'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
        -
          uuid: 15cc1beb1fbd4fa69a6874bb4f2b6509
          name: 端口发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr,{#IFALIAS},IF-MIB::ifAlias]'
          key: InterfaceDiscovery_status
          delay: 12h
          filter:
            conditions:
              -
                macro: '{#IFDESCR}'
                value: '.*Vlan.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          lifetime: 0d
          description: |
            You may also consider using IF-MIB::ifType or IF-MIB::ifAlias for discovery depending on your filtering needs.
            
            {$CLOUD_SNMP_COMMUNITY} is a global macro.
          item_prototypes:
            -
              uuid: 27f49260c11f4a2e84fc038358a9d11c
              name: '端口 {#IFDESCR}({#IFALIAS})状态'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'InterfaceOperationStatus.[{#SNMPINDEX}]'
              delay: 5m
              history: 3d
              trends: 0d
              description: 'The current operational state of the interface.'
              tags:
                -
                  tag: Application
                  value: 端口状态
              trigger_prototypes:
                -
                  uuid: 68b301c49fb4489da64f6de30a7bd8fb
                  expression: 'last(/monitor_Firewall_H3C_SecPath/InterfaceOperationStatus.[{#SNMPINDEX}],#2)=1 and  last(/monitor_Firewall_H3C_SecPath/InterfaceOperationStatus.[{#SNMPINDEX}],#1)=2'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/monitor_Firewall_H3C_SecPath/InterfaceOperationStatus.[{#SNMPINDEX}],#2)=1 and  last(/monitor_Firewall_H3C_SecPath/InterfaceOperationStatus.[{#SNMPINDEX}],#1)=1'
                  name: '端口 {#IFDESCR} down'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
        -
          uuid: 2303fa2e22d64ebf8da374d0ad3d3de0
          name: 端口发现
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr,{#IFSTATUS},IF-MIB::ifOperStatus,{#IFALIAS},IF-MIB::ifAlias]'
          key: InterfaceDiscovery_traffic
          delay: 12h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFSTATUS}'
                value: '1'
                formulaid: E
              -
                macro: '{#IFDESCR}'
                value: '.*Vlan.*'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#IFDESCR}'
                value: '.*Loop.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#IFDESCR}'
                value: '.*VLAN.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
              -
                macro: '{#IFDESCR}'
                value: '.*NULL.*'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          lifetime: 0d
          item_prototypes:
            -
              uuid: 96d13a1d21834c9d819e356cfed99330
              name: '端口带宽 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'InterfaceBandwidth.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 12h
              history: 3d
              trends: 0d
              units: Mbps
              tags:
                -
                  tag: Application
                  value: 端口带宽
            -
              uuid: 45c92bef007a4ddbbdc0da44341dcf0a
              name: '入方向带宽利用率 {#IFDESCR}({#IFALIAS})'
              type: CALCULATED
              key: 'InterfaceInBandwidthUsage.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              value_type: FLOAT
              units: '%'
              params: 'last(//InterfaceInTraffic.[{#SNMPINDEX},{#IFDESCR}])/last(//InterfaceBandwidth.[{#SNMPINDEX},{#IFDESCR}])/10000'
              tags:
                -
                  tag: Application
                  value: 入方向带宽利用率
              trigger_prototypes:
                -
                  uuid: f6c2ff371e8340cb9225b99be094b387
                  expression: 'last(/monitor_Firewall_H3C_SecPath/InterfaceInBandwidthUsage.[{#SNMPINDEX},{#IFDESCR}])>{$BANDWIDTH_USAGE_IN_THRESHOLD}'
                  name: '{#IFDESCR} 入方向带宽利用率高'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: 端口描述
                      value: '{#IFALIAS}'
            -
              uuid: 2f1cac41cb5f4af4a5fd96df5759c775
              name: '入方向广播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.9.{#SNMPINDEX}'
              key: 'InterfaceInBroadcastPacketsTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向广播包流量
            -
              uuid: 28cd12f694d34ac3b6d9e517b42749ae
              name: '入方向组播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.9.{#SNMPINDEX}'
              key: 'InterfaceInMulticastPacketsTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向组播报文速率
            -
              uuid: f809ce8254ba4aee892eaaaa674d1376
              name: '入方向错包 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'InterfaceInPacketError.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 30m
              history: 7d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向错包
              trigger_prototypes:
                -
                  uuid: c87b805b07504331a761f6f7b37d5201
                  expression: 'last(/monitor_Firewall_H3C_SecPath/InterfaceInPacketError.[{#SNMPINDEX},{#IFDESCR}])>{$ERROR_PACKETS_IN_THRESHOLD}'
                  name: '{#IFDESCR} 入方向错包率高'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: 端口描述
                      value: '{#IFALIAS}'
            -
              uuid: bca6b079d78c44c398dafcd6a548a7d0
              name: '入方向流量 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'InterfaceInTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向流量
            -
              uuid: bd386c90371949b58728267d2decd15d
              name: '入方向单播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.7.{#SNMPINDEX}'
              key: 'InterfaceInUnicastPacketsTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 入方向单播报文速率
            -
              uuid: 588a8062a3c844b8ad237d7a6f51ab88
              name: '出方向带宽利用率 {#IFDESCR}({#IFALIAS})'
              type: CALCULATED
              key: 'InterfaceOutBandwidthUsage[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              value_type: FLOAT
              units: '%'
              params: 'last(//InterfaceOutTraffic.[{#SNMPINDEX},{#IFDESCR}])/last(//InterfaceBandwidth.[{#SNMPINDEX},{#IFDESCR}])/10000'
              tags:
                -
                  tag: Application
                  value: 出方向带宽利用率
              trigger_prototypes:
                -
                  uuid: 62a72a7dc69343f8868c0bf703d20ceb
                  expression: 'last(/monitor_Firewall_H3C_SecPath/InterfaceOutBandwidthUsage[{#SNMPINDEX},{#IFDESCR}])>{$BANDWIDTH_USAGE_OUT_THRESHOLD}'
                  name: '{#IFDESCR} 出方向带宽利用率高'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: 端口描述
                      value: '{#IFALIAS}'
            -
              uuid: 060ce6a34cc147a69ceb642cb5ff8d53
              name: '出方向广播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.13.{#SNMPINDEX}'
              key: 'InterfaceOutBroadcastPacketTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向广播报文速率
            -
              uuid: 2bcd02ffa0e946f7a73177681299a918
              name: '出方向组播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.12.{#SNMPINDEX}'
              key: 'InterfaceOutMulticastPackestTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 3d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向组播报文速率
            -
              uuid: b36beedde0dd4dcf83513345f8e3c63b
              name: '出方向错包 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'InterfaceOutPacketError.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 30m
              history: 7d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向错包
              trigger_prototypes:
                -
                  uuid: f6501c35978f40c18f5a3c718719bda4
                  expression: 'last(/monitor_Firewall_H3C_SecPath/InterfaceOutPacketError.[{#SNMPINDEX},{#IFDESCR}])>{$ERROR_PACKETS_OUT_THRESHOLD}'
                  name: '{#IFDESCR} 出方向错包率高'
                  priority: HIGH
                  type: MULTIPLE
                  manual_close: 'YES'
                  tags:
                    -
                      tag: 端口描述
                      value: '{#IFALIAS}'
            -
              uuid: 4acebced44274ea5bfb7df3648811d10
              name: '出方向流量 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'InterfaceOutTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向流量
            -
              uuid: 2cd2c065436b44a4816929159d1b28a7
              name: '出方向单播报文速率 {#IFDESCR}({#IFALIAS})'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.11.{#SNMPINDEX}'
              key: 'InterfaceOutUnicastPacketsTraffic.[{#SNMPINDEX},{#IFDESCR}]'
              delay: 10m
              history: 30d
              trends: 0d
              units: pps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 出方向单播报文速率
      macros:
        -
          macro: '{$BANDWIDTH_USAGE_IN_THRESHOLD}'
          value: '90'
        -
          macro: '{$BANDWIDTH_USAGE_OUT_THRESHOLD}'
          value: '90'
        -
          macro: '{$CLOUD_SNMP_COMMUNITY}'
          value: public
        -
          macro: '{$CPU_USAGE_THRESHOLD}'
          value: '60'
        -
          macro: '{$ERROR_PACKETS_IN_THRESHOLD}'
          value: '10'
        -
          macro: '{$ERROR_PACKETS_OUT_THRESHOLD}'
          value: '10'
        -
          macro: '{$ICMP_LOSS_WARN}'
          value: '30'
        -
          macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.1'
        -
          macro: '{$MEMORY_USAGE_THRESHOLD}'
          value: '60'
        -
          macro: '{$TCP_SESSION_THRESHOLD}'
          value: '500000'
        -
          macro: '{$UDP_SESSION_THRESHOLD}'
          value: '500000'
      valuemaps:
        -
          uuid: 6385abfd00cd49d2a13274c44f1fd6cf
          name: private-Hh3cOperState
          mappings:
            -
              value: '1'
              newvalue: notSupported
            -
              value: '2'
              newvalue: disabled
            -
              value: '3'
              newvalue: enabled
            -
              value: '4'
              newvalue: dangerous
