<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T10:58:03Z</date>
  <groups>
    <group>
      <name>Templates</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Template SNMP Router OSPF v2</template>
      <name>Template SNMP Router OSPF v2</name>
      <description>https://share.zabbix.com/network_devices/snmp-router-ospf-v2-1</description>
      <groups>
        <group>
          <name>Templates</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>OSPF</name>
        </application>
      </applications>
      <items>
        <item>
          <name>OSPF router admin status</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.14.1.2.0</snmp_oid>
          <key>ospfAdminStat</key>
          <delay>5m</delay>
          <description>The administrative status of OSPF in the router. The value 'enabled' denotes that the OSPF Process is active on at least one interface; 'disabled' disables it on all interfaces.</description>
          <applications>
            <application>
              <name>OSPF</name>
            </application>
          </applications>
          <valuemap>
            <name>SNMP OSPF Admin Status</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{nodata(15m)}=1</expression>
              <name>No data collected for OSPF-MIB</name>
              <priority>WARNING</priority>
              <tags>
                <tag>
                  <tag>OSPF-config</tag>
                </tag>
              </tags>
            </trigger>
            <trigger>
              <expression>{last()}>1</expression>
              <name>OSPF Router Admin Status</name>
              <priority>WARNING</priority>
              <tags>
                <tag>
                  <tag>OSPF-config</tag>
                </tag>
              </tags>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>OSPF AS-scope LSA count</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.14.1.24.0</snmp_oid>
          <key>ospfAsLsaCount</key>
          <delay>5m</delay>
          <description>The number of AS-scope link state advertisements in the AS-scope link state database.</description>
          <applications>
            <application>
              <name>OSPF</name>
            </application>
          </applications>
        </item>
        <item>
          <name>OSPF External LSA count</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.14.1.6.0</snmp_oid>
          <key>ospfExternLsaCount</key>
          <delay>5m</delay>
          <description>The number of external (LS type-5) link state advertisements in the link state database. OSPF Version 2, Appendix A.4.5 AS external link advertisements</description>
          <applications>
            <application>
              <name>OSPF</name>
            </application>
          </applications>
        </item>
        <item>
          <name>OSPF New LSAs originated count</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.14.1.9.0</snmp_oid>
          <key>ospfOriginateNewLsas</key>
          <delay>5m</delay>
          <description>The number of new link state advertisements that have been originated. This number is incremented each time the router originates a new LSA. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ospfDiscontinuityTime.</description>
          <applications>
            <application>
              <name>OSPF</name>
            </application>
          </applications>
        </item>
        <item>
          <name>OSPF New LSA originate rate</name>
          <type>DEPENDENT</type>
          <key>ospfOriginateNewLsasPerSecond</key>
          <delay>0</delay>
          <value_type>FLOAT</value_type>
          <units>1/s</units>
          <description>Dependent item for graphing</description>
          <applications>
            <application>
              <name>OSPF</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>CHANGE_PER_SECOND</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>ospfOriginateNewLsas</key>
          </master_item>
        </item>
        <item>
          <name>OSPF router ID</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.14.1.1.0</snmp_oid>
          <key>ospfRouterId</key>
          <delay>10m</delay>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>A 32-bit integer uniquely identifying the router in the Autonomous System. By convention, to ensure uniqueness, this should default to the value of one of the router's IP interface addresses. This object is persistent and when written the entity SHOULD save the change to non-volatile storage.</description>
          <applications>
            <application>
              <name>OSPF</name>
            </application>
          </applications>
        </item>
        <item>
          <name>OSPF New LSAs received count</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.14.1.10.0</snmp_oid>
          <key>ospfRxNewLsas</key>
          <delay>5m</delay>
          <description>The number of link state advertisements received that are determined to be new instantiations. This number does not include newer instantiations of self-originated link state advertisements. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ospfDiscontinuityTime.</description>
          <applications>
            <application>
              <name>OSPF</name>
            </application>
          </applications>
        </item>
        <item>
          <name>OSPF New LSA receive rate</name>
          <type>DEPENDENT</type>
          <key>ospfRxNewLsasPerSecond</key>
          <delay>0</delay>
          <value_type>FLOAT</value_type>
          <units>1/s</units>
          <description>Dependent item for graphing</description>
          <applications>
            <application>
              <name>OSPF</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>CHANGE_PER_SECOND</type>
              <params></params>
            </step>
          </preprocessing>
          <master_item>
            <key>ospfRxNewLsas</key>
          </master_item>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>OSPF Areas</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.14.2.1.1]</snmp_oid>
          <key>ospfAreaId</key>
          <delay>5m</delay>
          <lifetime>1h</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>OSPF area $1 LSA count</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.2.1.7.{#SNMPINDEX}</snmp_oid>
              <key>ospfAreaLsaCount[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <description>The total number of link-state advertisements in this area's link-state database, excluding AS External LSA's.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF area {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
            </item_prototype>
            <item_prototype>
              <name>OSPF area $1 status</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.2.1.10.{#SNMPINDEX}</snmp_oid>
              <key>ospfAreaStatus[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <description>This variable displays the status of the entry. Setting it to 'invalid' has the effect of rendering it inoperative. The internal effect (row removal) is implementation dependent.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF area {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <valuemap>
                <name>SNMP OSPF Area Status</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}>1</expression>
                  <name>OSPF area {#SNMPINDEX} not active</name>
                  <priority>WARNING</priority>
                  <tags>
                    <tag>
                      <tag>OSPF</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>OSPF area $1 SPF run rate</name>
              <type>DEPENDENT</type>
              <key>ospfSpfRunsPerSecond[{#SNMPINDEX}]</key>
              <delay>0</delay>
              <value_type>FLOAT</value_type>
              <units>1/s</units>
              <description>Dependent item for graphing</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF area {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
              <master_item>
                <key>ospfSpfRuns[{#SNMPINDEX}]</key>
              </master_item>
            </item_prototype>
            <item_prototype>
              <name>OSPF area $1 SPF run count</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.2.1.4.{#SNMPINDEX}</snmp_oid>
              <key>ospfSpfRuns[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <description>The number of times that the intra-area route table has been calculated using this area's link-state database. This is typically done using Dijkstra's algorithm.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF area {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>OSPF area {#SNMPINDEX} SPF algorithm runs</name>
              <ymin_type_1>FIXED</ymin_type_1>
              <graph_items>
                <graph_item>
                  <drawtype>FILLED_REGION</drawtype>
                  <color>4000FF</color>
                  <calc_fnc>MAX</calc_fnc>
                  <item>
                    <host>Template SNMP Router OSPF v2</host>
                    <key>ospfSpfRuns[{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>OSPF Interfaces</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.14.7.1.1]</snmp_oid>
          <key>ospfIfIpAddress</key>
          <delay>5m</delay>
          <lifetime>1h</lifetime>
          <description>Identifies OSPF Interfaces.</description>
          <item_prototypes>
            <item_prototype>
              <name>OSPF interface $1 admin status</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.7.1.5.{#SNMPINDEX}</snmp_oid>
              <key>ospfIfAdminStat[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <description>The OSPF interface's administrative status. The value formed on the interface, and the interface will be advertised as an internal route to some area. The value 'disabled' denotes that the interface is external to OSPF.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF interface {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <valuemap>
                <name>SNMP OSPF Admin Status</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}=2</expression>
                  <name>OSPF interface {#SNMPINDEX} disabled</name>
                  <priority>INFO</priority>
                  <tags>
                    <tag>
                      <tag>OSPF-config</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>OSPF interface $1 Backup Designated Router</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.7.1.14.{#SNMPINDEX}.0</snmp_oid>
              <key>ospfIfBackupDesignatedRouter[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <description>The IP Address of the Backup Designated Router.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF interface {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                  <params>3600</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>OSPF interface $1 Designated Router</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.7.1.13.{#SNMPINDEX}.0</snmp_oid>
              <key>ospfIfDesignatedRouter[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <trends>0</trends>
              <value_type>TEXT</value_type>
              <description>The IP Address of the Designated Router.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF interface {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                  <params>3600</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>OSPF interface $1 event rate</name>
              <type>DEPENDENT</type>
              <key>ospfIfEventsPerSecond[{#SNMPINDEX}]</key>
              <delay>0</delay>
              <value_type>FLOAT</value_type>
              <units>1/s</units>
              <description>Dependent item for graphs</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF interface {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
              <master_item>
                <key>ospfIfEvents[{#SNMPINDEX}]</key>
              </master_item>
            </item_prototype>
            <item_prototype>
              <name>OSPF interface $1 events</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.7.1.15.{#SNMPINDEX}</snmp_oid>
              <key>ospfIfEvents[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <description>The number of times this OSPF interface has changed its state or an error has occurred. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ospfDiscontinuityTime.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF interface {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{diff()}&lt;>0</expression>
                  <name>OSPF interface {#SNMPINDEX} event</name>
                  <priority>INFO</priority>
                  <tags>
                    <tag>
                      <tag>OSPF</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>OSPF interface $1 hello interval</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.7.1.9.{#SNMPINDEX}</snmp_oid>
              <key>ospfIfHelloInterval[{#SNMPINDEX}]</key>
              <delay>15m</delay>
              <status>DISABLED</status>
              <units>s</units>
              <description>The length of time, in seconds, between the Hello packets that the router sends on the interface. This value must be the same for all routers attached to a common network.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF interface {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
            </item_prototype>
            <item_prototype>
              <name>OSPF interface $1 dead interval</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.7.1.10.{#SNMPINDEX}</snmp_oid>
              <key>ospfIfRtrDeadInterval[{#SNMPINDEX}]</key>
              <delay>15m</delay>
              <status>DISABLED</status>
              <units>s</units>
              <description>The number of seconds that a router's Hello packets have not been seen before it's neighbors declare the router down. This should be some multiple of the Hello interval. This value must be the same for all routers attached to a common network.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF interface {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
            </item_prototype>
            <item_prototype>
              <name>OSPF interface $1 state</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.7.1.12.{#SNMPINDEX}</snmp_oid>
              <key>ospfIfState[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <description>The OSPF Interface State.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF interface {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <valuemap>
                <name>SNMP OSPF interface state</name>
              </valuemap>
            </item_prototype>
            <item_prototype>
              <name>OSPF interface $1 Interface Type</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.7.1.4.{#SNMPINDEX}.0</snmp_oid>
              <key>ospfIfType[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <description>The OSPF interface type. By way of a default, this field may be intuited from the corresponding value of ifType. Broadcast LANs, such as Ethernet and IEEE 802.5, take the value 'broadcast', X.25 and similar technologies take the value 'nbma', and links that are definitively point to point take the value 'pointToPoint'.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF interface {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <valuemap>
                <name>SNMP OSPF Interface Type</name>
              </valuemap>
            </item_prototype>
          </item_prototypes>
          <trigger_prototypes>
            <trigger_prototype>
              <expression>{Template SNMP Router OSPF v2:ospfIfBackupDesignatedRouter[{#SNMPINDEX}].str(0.0.0.0)}=1 and {Template SNMP Router OSPF v2:ospfIfDesignatedRouter[{#SNMPINDEX}].str(0.0.0.0)}&lt;>1</expression>
              <name>OSPF interface {#SNMPINDEX} Backup Designated Router is down</name>
              <priority>AVERAGE</priority>
              <description>DR exists, but not BackupDR — misconfiguration or OSPF link is down</description>
              <tags>
                <tag>
                  <tag>OSPF</tag>
                </tag>
              </tags>
            </trigger_prototype>
          </trigger_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>OSPF interface {#SNMPINDEX} event rate</name>
              <ymin_type_1>FIXED</ymin_type_1>
              <graph_items>
                <graph_item>
                  <drawtype>FILLED_REGION</drawtype>
                  <color>D84315</color>
                  <calc_fnc>MAX</calc_fnc>
                  <item>
                    <host>Template SNMP Router OSPF v2</host>
                    <key>ospfIfEvents[{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>OSPF Neighbors</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.14.10.1.1]</snmp_oid>
          <key>ospfNbrIpAddr</key>
          <delay>5m</delay>
          <lifetime>1h</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>OSPF NBMA Neighbor $1 Status</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.10.1.9.{#SNMPINDEX}.0</snmp_oid>
              <key>ospfNbmaNbrStatus[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <description>This variable displays the status of the entry. Setting it to 'invalid' has the effect of rendering it inoperative. The internal effect (row removal) is implementation dependent.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF neighbor {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <valuemap>
                <name>SNMP OSPF Area Status</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}>1</expression>
                  <name>OSPF NBMA Neighbor {#SNMPVALUE} Status</name>
                  <priority>WARNING</priority>
                  <tags>
                    <tag>
                      <tag>OSPF-neighbor</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>OSPF Neighbor $1 Router ID</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.10.1.3.{#SNMPINDEX}.0</snmp_oid>
              <key>ospfNbrRtrId[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <trends>0</trends>
              <value_type>CHAR</value_type>
              <description>A 32-bit integer (represented as a type IpAddress) uniquely identifying the neighboring router in the Autonomous System.</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF neighbor {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                  <params>3600</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>OSPF neighbor $1 state</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.14.10.1.6.{#SNMPINDEX}</snmp_oid>
              <key>ospfNbrState[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <description>The State of the relationship with this Neighbor. [RU] Возможные состояния Down — начальное состояние процесса обнаружения соседей. Это состояние указывает на то, что от соседей не была получена свежая информация. В NBMA сетях Hello-пакеты могут отправляться и соседям в состоянии Down, однако с меньшей частотой (PollInterval) Attempt — это состояние имеет смысл только для соседей, которые присоединены к NBMA сетям. Оно указывает на то, что от соседа не была получена свежая информация и что нужно сделать попытку связаться с соседом. Это делается путём отправки соседу сообщений Hello с промежутком времени Hello Interval (в Cisco в этом состоянии сообщения Hello отправляются каждый PollInterval. Имеет смысл для соседей в NBMA сетях, которые заданы командой neighbor) Init — состояние, в котором находится маршрутизатор, отправивший своему соседу hello и ожидающий от него ответного hello Two-way — при получении ответных hello маршрутизатор должен увидеть в них свой RID в списке соседей. Если это так, то он устанавливает отношения и переходит в состояние two-way Когда в широковещательном сегменте более 3х маршрутизаторов, то в этом состоянии остаются между собой маршрутизаторы DROTHER Exstart — маршрутизаторы определяют Master/Slave отношения на основании Router ID. Маршрутизатор с высшим RID становится Master-маршрутизатором, который определяет DD Sequence number, а также первым начинает обмен DD-пакетами Exchange — маршрутизаторы посылают друг другу database description пакеты (DD) с информацией о сетях, содержащихся в их собственной LSDB Loading — Если маршрутизатор видит, что части маршрутов нет в его LSDB, он посылает сообщение LSR с перечислением тех сетей, по которым он хочет получить дополнительную информацию. Пока маршрутизатор находится в ожидании ответа в виде LSU сообщений, он пребывает в состоянии Loading Full — Когда маршрутизатор получил всю информацию и LSDB на обоих маршрутизаторах синхронизирована, оба маршрутизатора переходят в состояние fully adjacent (FULL)</description>
              <applications>
                <application>
                  <name>OSPF</name>
                </application>
              </applications>
              <application_prototypes>
                <application_prototype>
                  <name>OSPF neighbor {#SNMPINDEX}</name>
                </application_prototype>
              </application_prototypes>
              <valuemap>
                <name>SNMP OSPF Neighbor State (ospfNbrState)</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}=2</expression>
                  <name>OSPF neighbor {#SNMPVALUE} state: attempt</name>
                  <priority>WARNING</priority>
                  <description>Attempt — это состояние имеет смысл только для соседей, которые присоединены к NBMA сетям. Оно указывает на то, что от соседа не была получена свежая информация и что нужно сделать попытку связаться с соседом. Это делается путём отправки соседу сообщений Hello с промежутком времени Hello Interval (в Cisco в этом состоянии сообщения Hello отправляются каждый PollInterval. Имеет смысл для соседей в NBMA сетях, которые заданы командой neighbor)</description>
                  <tags>
                    <tag>
                      <tag>OSPF-neighbor</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}=1</expression>
                  <name>OSPF neighbor {#SNMPVALUE} state: down</name>
                  <priority>AVERAGE</priority>
                  <description>down — начальное состояние процесса обнаружения соседей. Это состояние указывает на то, что от соседей не была получена свежая информация. В NBMA сетях Hello-пакеты могут отправляться и соседям в состоянии Down, однако с меньшей частотой (PollInterval)</description>
                  <tags>
                    <tag>
                      <tag>OSPF-neighbor</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}=6</expression>
                  <name>OSPF neighbor {#SNMPVALUE} state: exchange</name>
                  <priority>WARNING</priority>
                  <description>Exchange — маршрутизаторы посылают друг другу database description пакеты (DD) с информацией о сетях, содержащихся в их собственной LSDB</description>
                  <tags>
                    <tag>
                      <tag>OSPF-neighbor</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}=5</expression>
                  <name>OSPF neighbor {#SNMPVALUE} state: exstart</name>
                  <priority>AVERAGE</priority>
                  <description>Exstart — маршрутизаторы определяют Master/Slave отношения на основании Router ID. Маршрутизатор с высшим RID становится Master-маршрутизатором, который определяет DD Sequence number, а также первым начинает обмен DD-пакетами</description>
                  <tags>
                    <tag>
                      <tag>OSPF-neighbor</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}=3</expression>
                  <name>OSPF neighbor {#SNMPVALUE} state: init</name>
                  <priority>AVERAGE</priority>
                  <description>init — состояние, в котором находится маршрутизатор, отправивший своему соседу hello и ожидающий от него ответного hello</description>
                  <tags>
                    <tag>
                      <tag>OSPF-neighbor</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}=7</expression>
                  <name>OSPF neighbor {#SNMPVALUE} state: loading</name>
                  <priority>WARNING</priority>
                  <description>Loading — Если маршрутизатор видит, что части маршрутов нет в его LSDB, он посылает сообщение LSR с перечислением тех сетей, по которым он хочет получить дополнительную информацию. Пока маршрутизатор находится в ожидании ответа в виде LSU сообщений, он пребывает в состоянии Loading</description>
                  <tags>
                    <tag>
                      <tag>OSPF-neighbor</tag>
                    </tag>
                  </tags>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
      </discovery_rules>
      <screens>
        <screen>
          <name>OSPF Algorithm Run Count</name>
          <hsize>1</hsize>
          <vsize>1</vsize>
        </screen>
      </screens>
    </template>
  </templates>
  <graphs>
    <graph>
      <name>OSPF LSA rate</name>
      <ymin_type_1>FIXED</ymin_type_1>
      <graph_items>
        <graph_item>
          <drawtype>FILLED_REGION</drawtype>
          <color>1A7C11</color>
          <calc_fnc>MAX</calc_fnc>
          <item>
            <host>Template SNMP Router OSPF v2</host>
            <key>ospfRxNewLsasPerSecond</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <drawtype>BOLD_LINE</drawtype>
          <color>0040FF</color>
          <calc_fnc>MAX</calc_fnc>
          <item>
            <host>Template SNMP Router OSPF v2</host>
            <key>ospfOriginateNewLsasPerSecond</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
  </graphs>
  <value_maps>
    <value_map>
      <name>SNMP OSPF Admin Status</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>enabled</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>disabled</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>SNMP OSPF Area Status</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>active</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>notInService</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>SNMP OSPF interface state</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>down</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>loopback</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>waiting</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>pointToPoint</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>designatedRouter</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>backupDesignatedRouter</newvalue>
        </mapping>
        <mapping>
          <value>7</value>
          <newvalue>otherDesignatedRouter</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>SNMP OSPF Interface Type</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>broadcast</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>nbma</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>pointToPoint</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>pointToMultipoint</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>SNMP OSPF Neighbor State (ospfNbrState)</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>down</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>attempt</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>init</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>twoWay</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>exchangeStart</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>exchange</newvalue>
        </mapping>
        <mapping>
          <value>7</value>
          <newvalue>loading</newvalue>
        </mapping>
        <mapping>
          <value>8</value>
          <newvalue>full</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>