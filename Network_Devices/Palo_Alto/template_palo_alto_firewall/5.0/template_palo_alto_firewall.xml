<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T10:51:09Z</date>
  <groups>
    <group>
      <name>Templates SNMP Devices</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Template_Palo_Alto_Firewall</template>
      <name>Template_Palo_Alto_Firewall</name>
      <groups>
        <group>
          <name>Templates SNMP Devices</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>FAN</name>
        </application>
        <application>
          <name>General</name>
        </application>
        <application>
          <name>Memory</name>
        </application>
        <application>
          <name>Temperature</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Chassis Type</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.2.1.0</snmp_oid>
          <key>panChassisType</key>
          <delay>86400</delay>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>PAN-COMMON-MIB::panChassisType Chassis type for this Palo Alto device.</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Max Possible Sessions</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.3.2.0</snmp_oid>
          <key>panSessionMax</key>
          <delay>3600</delay>
          <description>PAN-COMMON-MIB::panSessionMax Total number of sessions supported.</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Session Utilization</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.3.1.0</snmp_oid>
          <key>panSessionUtilization</key>
          <delay>300</delay>
          <units>%</units>
          <description>PAN-COMMON-MIB::panSessionUtilization Session table utilization percentage.</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Hardware Version</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.2.0</snmp_oid>
          <key>panSysHwVersion</key>
          <delay>3600</delay>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>PAN-COMMON-MIB::panSysHwVersion Hardware version of the unit.</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Software Version</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.25461.2.1.2.1.1.0</snmp_oid>
          <key>panSysSwVersion</key>
          <delay>3600</delay>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>PAN-COMMON-MIB::panSysSwVersion Full software version. The first two components of the full version are the major and minor versions. The third component indicates the maintenance release number and the fourth, the build number.</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>$1 Discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.2.1.99.1.1.1.1]</snmp_oid>
          <key>entPhySensorType[FAN]</key>
          <delay>300</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPVALUE}</macro>
                <value>10</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <description>ENTITY-SENSOR-MIB::entPhySensorType The type of data returned by the associated entPhySensorValue object.</description>
          <item_prototypes>
            <item_prototype>
              <name>Operational status of FAN $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.2.1.99.1.1.1.5.{#SNMPINDEX}</snmp_oid>
              <key>entPhySensorOperStatus[{#SNMPVALUE},FAN]</key>
              <delay>30</delay>
              <description>ENTITY-SENSOR-MIB::entPhySensorOperStatus The operational status of the sensor.</description>
              <applications>
                <application>
                  <name>FAN</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}=3</expression>
                  <name>FAN #{#SNMPINDEX} is nonoperational</name>
                  <priority>HIGH</priority>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}=2</expression>
                  <name>FAN #{#SNMPINDEX} is unavailable</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Current speed of $2 $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.2.1.99.1.1.1.4.{#SNMPINDEX}</snmp_oid>
              <key>entPhySensorValue[{#SNMPVALUE},FAN]</key>
              <delay>60</delay>
              <units>rpm</units>
              <description>ENTITY-SENSOR-MIB::entPhySensorValue The most recent measurement obtained by the agent for this sensor.</description>
              <applications>
                <application>
                  <name>FAN</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>$1 Discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.2.1.99.1.1.1.1]</snmp_oid>
          <key>entPhySensorType[Temperature]</key>
          <delay>300</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPVALUE}</macro>
                <value>^8$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <description>ENTITY-SENSOR-MIB::entPhySensorType The type of data returned by the associated entPhySensorValue object.</description>
          <item_prototypes>
            <item_prototype>
              <name>Operational status of $2 Sensor $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.2.1.99.1.1.1.5.{#SNMPINDEX}</snmp_oid>
              <key>entPhySensorOperStatus[{#SNMPVALUE},Temperature]</key>
              <delay>30</delay>
              <description>ENTITY-SENSOR-MIB::entPhySensorOperStatus The operational status of the sensor.</description>
              <applications>
                <application>
                  <name>Temperature</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}=3</expression>
                  <name>Temperature Sensor #{#SNMPINDEX} is nonoperational</name>
                  <priority>HIGH</priority>
                </trigger_prototype>
                <trigger_prototype>
                  <expression>{last()}=2</expression>
                  <name>Temperature Sensor #{#SNMPINDEX} is unavailable</name>
                  <priority>AVERAGE</priority>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Temperature on Sensor #$1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.2.1.99.1.1.1.4.{#SNMPINDEX}</snmp_oid>
              <key>entPhySensorValue[{#SNMPVALUE},Temperature]</key>
              <delay>60</delay>
              <units>Â°C</units>
              <description>ENTITY-SENSOR-MIB::entPhySensorValue The most recent measurement obtained by the agent for this sensor.</description>
              <applications>
                <application>
                  <name>Temperature</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Memory</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.2.1.25.2.3.1.3]</snmp_oid>
          <key>hrStorageDescr[memory]</key>
          <delay>300</delay>
          <status>DISABLED</status>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPVALUE}</macro>
                <value>Memory</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>{#SNMPVALUE} Size</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}</snmp_oid>
              <key>hrStorageSize[memory,{#SNMPINDEX}]</key>
              <delay>300</delay>
              <units>B</units>
              <applications>
                <application>
                  <name>Memory</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>MULTIPLIER</type>
                  <params>1024</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>{#SNMPVALUE} Used</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}</snmp_oid>
              <key>hrStorageUsed[memory,{#SNMPINDEX}]</key>
              <delay>300</delay>
              <units>B</units>
              <applications>
                <application>
                  <name>Memory</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>MULTIPLIER</type>
                  <params>1024</params>
                </step>
              </preprocessing>
            </item_prototype>
          </item_prototypes>
          <trigger_prototypes>
            <trigger_prototype>
              <expression>{Template_Palo_Alto_Firewall:hrStorageUsed[memory,{#SNMPINDEX}].avg(5m)}>{Template_Palo_Alto_Firewall:hrStorageSize[memory,{#SNMPINDEX}].last()}*0.9</expression>
              <name>#{#SNMPVALUE} usage is high [{ITEM.LASTVALUE1}]</name>
              <priority>AVERAGE</priority>
            </trigger_prototype>
          </trigger_prototypes>
        </discovery_rule>
      </discovery_rules>
    </template>
  </templates>
</zabbix_export>