zabbix_export:
  version: '5.4'
  date: '2021-11-09T08:28:46Z'
  groups:
    -
      uuid: 130d9e4fb0484b2092428a3e30573bd3
      name: 'Access Points'
  templates:
    -
      uuid: bc1ec7a69a1f41a3b035ed25fb280ad2
      template: 'Meraki Access Points'
      name: 'Meraki Access Points'
      description: |
        ## Overview
        
        As I did not find any template to monitor my Meraki APs on the Meraki CLoud, here you are a template proposal I made.
        
        
        I have tested on my zabbix server and it works.
        
        
        the idea is to find all Meraki APs in the Cloud (SNMPv2-SMI::enterprises.29671.1.1.4.1.2)
        
        
        And each Meraki AP status (SNMPv2-SMI::enterprises.29671.1.1.4.1.3) (0-Down, 1-UP)
        
        
        With a Discovery List I add each AP as a Item Prototype and create a High trigger proto for each status.
        
        
         
        
        
        To make it work you must enable SNMP read on your MERAKI cloud:
        
        
        <https://documentation.meraki.com/zGeneral_Administration/Monitoring_and_Reporting/SNMP_Overview_and_Configuration>
        
        
        The Template Needs as well a MACRO: {$SNMP\_MERAKI\_COMMUNITY} for the SNMP Comunity
        
        
         
        
        
        
        ## Author
        
        amendez
        
        
      groups:
        -
          name: 'Access Points'
      discovery_rules:
        -
          uuid: 4701227f59b14a9daaf243b711b8316d
          name: APMERAKI
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ITEM.NAME},SNMPv2-SMI::enterprises.29671.1.1.4.1.2,{#ITEM.STATUS},SNMPv2-SMI::enterprises.29671.1.1.4.1.3]'
          key: APLIST
          delay: 30s
          item_prototypes:
            -
              uuid: 0d2f162d4c514974823c3246f79e5a7c
              name: 'Name.{#ITEM.NAME}'
              type: CALCULATED
              key: 'MerakiDeviceIndex.[{#SNMPINDEX}]'
              delay: 30s
              params: '{#ITEM.STATUS}'
            -
              uuid: a4de1505c3ad41db81b881fcb3a08179
              name: '{#ITEM.NAME}.Status:{#ITEM.STATUS}'
              type: CALCULATED
              key: 'MerakiDeviceIndexStatus.[{#SNMPINDEX}]'
              delay: 30s
              params: '{#ITEM.STATUS}'
              trigger_prototypes:
                -
                  uuid: 857cbdbd52f24a76a91bf35ed1a3ec2f
                  expression: 'last(/Meraki Access Points/MerakiDeviceIndexStatus.[{#SNMPINDEX}])=0'
                  name: '{#ITEM.NAME}.Status'
                  priority: HIGH
                  tags:
                    -
                      tag: DOWN
                      value: '0'
                    -
                      tag: UP
                      value: '1'
