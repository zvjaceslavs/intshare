<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-26T04:42:17Z</date>
  <groups>
    <group>
      <name>Templates</name>
    </group>
    <group>
      <name>Templates/Modules</name>
    </group>
    <group>
      <name>UPS</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>NetAgent UPS</template>
      <name>NetAgent UPS</name>
      <templates>
        <template>
          <name>Template Module ICMP Ping</name>
        </template>
      </templates>
      <groups>
        <group>
          <name>Templates</name>
        </group>
        <group>
          <name>UPS</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>information(s)</name>
        </application>
        <application>
          <name>Operational</name>
        </application>
      </applications>
      <items>
        <item>
          <name>UPS battery status</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.2.1.1.0</snmp_oid>
          <key>netagent.battery.status</key>
          <delay>30m</delay>
          <applications>
            <application>
              <name>Operational</name>
            </application>
          </applications>
          <valuemap>
            <name>apcBatteryStatus</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{last(,30m)}=1 or {last(,30m)}=4</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{last(,30m)}=2</recovery_expression>
              <name>UPS NetAgent - Batteries are unable to sustain the present load or are degraded</name>
              <priority>HIGH</priority>
              <manual_close>YES</manual_close>
            </trigger>
            <trigger>
              <expression>{last(,15m)}=3</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{last(,15m)}=2</recovery_expression>
              <name>UPS NetAgent - Remaining battery run-time is poor</name>
              <priority>AVERAGE</priority>
              <description>Battery is low</description>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Uptime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.2.1.1.3.0</snmp_oid>
          <key>sysUpTime</key>
          <units>uptime</units>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>UPS time on battery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.2.1.2.0</snmp_oid>
          <key>upsBaseBatteryTimeOnBattery</key>
          <delay>60s</delay>
          <history>7d</history>
          <units>s</units>
          <description>The elapsed time in seconds since the UPS has switched to battery power. Прошедшее время в секундах с момента переключения ИБП на батареи.</description>
          <applications>
            <application>
              <name>Operational</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>UPS Battery Last Replace Date</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.2.1.3.0</snmp_oid>
          <key>upsBaseLBatteryLastReplaceDate</key>
          <delay>1h</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>The date when the UPS system's batteries were last replaced in mm/dd/yy format. For UPS models, this value is originally set in the factory. When the UPS batteries are replaced, this value should be reset by the administrator Дата последней замены батарей системы ИБП в формате мм / дд / гг. Это значение изначально установлено на заводе. Когда батареи ИБП заменены, это значение должно быть сброшено администратором</description>
          <applications>
            <application>
              <name>information(s)</name>
            </application>
          </applications>
        </item>
        <item>
          <name>UPS status</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.4.1.1.0</snmp_oid>
          <key>upsBaseOutputStatus</key>
          <delay>30s</delay>
          <description>The current state of the UPS. If the UPS is unable to determine the state of the UPS this variable is set to unknown(1).</description>
          <applications>
            <application>
              <name>Operational</name>
            </application>
          </applications>
          <valuemap>
            <name>UPS NetAgent Status</name>
          </valuemap>
        </item>
        <item>
          <name>UPS battery capacity (%)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.2.2.1.0</snmp_oid>
          <key>upsSmartBatteryCapacity</key>
          <delay>60s</delay>
          <history>7d</history>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <description>The remaining battery capacity expressed in percent of full capacity. Оставшаяся емкость аккумулятора выражена в процентов от полной емкости.</description>
          <applications>
            <application>
              <name>Operational</name>
            </application>
          </applications>
        </item>
        <item>
          <name>UPS battery temperature</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.2.2.3.0</snmp_oid>
          <key>upsSmartBatteryTemperature</key>
          <delay>60s</delay>
          <units>°C</units>
          <description>The current internal UPS temperature expressed in tenths of a Celsius degree. Текущая внутренняя температура ИБП, выраженная в десятых долях градус Цельсия.</description>
          <applications>
            <application>
              <name>Operational</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.1</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>UPS Firmware Revision</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.1.2.1.0</snmp_oid>
          <key>upsSmartIdentFirmwareRevision</key>
          <delay>30s</delay>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>information(s)</name>
            </application>
          </applications>
        </item>
        <item>
          <name>UPS input voltage</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.3.2.1.0</snmp_oid>
          <key>upsSmartInputLineVoltage</key>
          <delay>30s</delay>
          <value_type>FLOAT</value_type>
          <units>VAC</units>
          <applications>
            <application>
              <name>Operational</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.1</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>UPS output frequency</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.4.2.2.0</snmp_oid>
          <key>upsSmartOutputFrequency</key>
          <delay>30s</delay>
          <units>Hz</units>
          <description>The current input frequency to the UPS system in 1/10 Hz.</description>
          <applications>
            <application>
              <name>Operational</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.1</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>UPS output load (%)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.4.2.3.0</snmp_oid>
          <key>upsSmartOutputLoad</key>
          <delay>60s</delay>
          <units>%</units>
          <description>The current UPS load expressed in percent of rated capacity.</description>
          <applications>
            <application>
              <name>Operational</name>
            </application>
          </applications>
        </item>
        <item>
          <name>UPS output voltage</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.935.1.1.1.4.2.1.0</snmp_oid>
          <key>upsSmartOutputVoltage</key>
          <delay>30s</delay>
          <units>VAC</units>
          <description>The output voltage of the UPS system in 1/10 VAC</description>
          <applications>
            <application>
              <name>Operational</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.1</params>
            </step>
          </preprocessing>
        </item>
      </items>
    </template>
    <template>
      <template>Template Module ICMP Ping</template>
      <name>Template Module ICMP Ping</name>
      <description>Template Module ICMP Ping version: 0.12</description>
      <groups>
        <group>
          <name>Templates/Modules</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Status</name>
        </application>
      </applications>
      <items>
        <item>
          <name>ICMP ping</name>
          <type>SIMPLE</type>
          <key>icmpping</key>
          <delay>60</delay>
          <history>1w</history>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <valuemap>
            <name>Service state</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{max(#3)}=0</expression>
              <name>Unavailable by ICMP ping</name>
              <priority>HIGH</priority>
              <description>Last value: {ITEM.LASTVALUE1}. Last three attempts returned timeout. Please check device connectivity.</description>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>ICMP loss</name>
          <type>SIMPLE</type>
          <key>icmppingloss</key>
          <delay>60</delay>
          <history>1w</history>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{min(5m)}>{$ICMP_LOSS_WARN} and {min(5m)}&lt;100</expression>
              <name>High ICMP ping loss</name>
              <priority>WARNING</priority>
              <dependencies>
                <dependency>
                  <name>Unavailable by ICMP ping</name>
                  <expression>{Template Module ICMP Ping:icmpping.max(#3)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>ICMP response time</name>
          <type>SIMPLE</type>
          <key>icmppingsec</key>
          <delay>60</delay>
          <history>1w</history>
          <value_type>FLOAT</value_type>
          <units>s</units>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{avg(5m)}>{$ICMP_RESPONSE_TIME_WARN}</expression>
              <name>High ICMP ping response time</name>
              <priority>WARNING</priority>
              <dependencies>
                <dependency>
                  <name>High ICMP ping loss</name>
                  <expression>{Template Module ICMP Ping:icmppingloss.min(5m)}>{$ICMP_LOSS_WARN} and {Template Module ICMP Ping:icmppingloss.min(5m)}&lt;100</expression>
                </dependency>
                <dependency>
                  <name>Unavailable by ICMP ping</name>
                  <expression>{Template Module ICMP Ping:icmpping.max(#3)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
      </items>
      <macros>
        <macro>
          <macro>{$ICMP_LOSS_WARN}</macro>
          <value>20</value>
        </macro>
        <macro>
          <macro>{$ICMP_RESPONSE_TIME_WARN}</macro>
          <value>0.15</value>
        </macro>
      </macros>
    </template>
  </templates>
  <value_maps>
    <value_map>
      <name>apcBatteryStatus</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>unknown</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>batteryNormal</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>batteryLow</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Service state</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Down</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Up</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>UPS NetAgent Status</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>unknown</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>onLine</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>onBattery</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>onBoost</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>sleeping</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>onBypass</newvalue>
        </mapping>
        <mapping>
          <value>7</value>
          <newvalue>rebooting</newvalue>
        </mapping>
        <mapping>
          <value>8</value>
          <newvalue>standBy</newvalue>
        </mapping>
        <mapping>
          <value>9</value>
          <newvalue>onBuck</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>