<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T10:58:49Z</date>
  <groups>
    <group>
      <name>PABX</name>
    </group>
    <group>
      <name>Templates/Modules</name>
    </group>
    <group>
      <name>Templates/Network devices</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>PABX-TEMPLATE</template>
      <name>PABX</name>
      <description>Model for PBX OXE R9.1 or greater, discovery: "trunk" only works on OXE R12.2 Modelo para PBX OXE R9.1 ou superior, descoberta: tronco só funciona em OXE R12.2</description>
      <templates>
        <template>
          <name>Template Net Network Generic Device SNMP</name>
        </template>
      </templates>
      <groups>
        <group>
          <name>PABX</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>PABX</name>
        </application>
        <application>
          <name>PABX-General-Status</name>
        </application>
        <application>
          <name>PABX CAC</name>
        </application>
        <application>
          <name>PABX DSP</name>
        </application>
        <application>
          <name>PABX IpDomain</name>
        </application>
        <application>
          <name>PABX Trunk</name>
        </application>
      </applications>
      <items>
        <item>
          <name>pbxRole</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.637.64.4400.1.4.0</snmp_oid>
          <key>pbxRole</key>
          <description>"Indicates the PCX role. Available values are: INDETERMINATE, MAIN, STAND-BY, ACTIVE_PCS or INACTIVE_PCS where: - MAIN and STAND-BY values are used to indicate the Com Server role - ACTIVE_PCS and INACTIVE_PCS values are used to indicate the Passive Communication Server (PCS) status - The INDETERMINATE value is not sent in response to an SNMP request when the corresponding SNMP agent is not started Indica a função PCX. Os valores disponíveis são: INDETERMINATE, MAIN, STAND-BY, ACTIVE_PCS ou INACTIVE_PCS onde: - Os valores MAIN e STAND-BY são usados para indicar a função do Com Server - Os valores ACTIVE_PCS e INACTIVE_PCS são usados para indicar o status do Passive Communication Server (PCS) - O valor INDETERMINATE não é enviado em resposta a uma solicitação SNMP quando o agente SNMP correspondente não é iniciado"</description>
          <applications>
            <application>
              <name>PABX-General-Status</name>
            </application>
          </applications>
          <valuemap>
            <name>pbxRole</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{last()}=0</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{last()}=1 or {last()}=2 or {last()}=3 or {last()}=4</recovery_expression>
              <name>{HOST.NAME} Failure - Role is {ITEM.VALUE}</name>
              <priority>DISASTER</priority>
              <description>Role is {ITEM.VALUE}</description>
              <dependencies>
                <dependency>
                  <name>No SNMP data collection</name>
                  <expression>{PABX-TEMPLATE:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
            <trigger>
              <expression>{last(#1)}&lt;>{last(#2)}=1 and {last()}>0</expression>
              <name>{HOST.NAME} role has changed (new role: {ITEM.VALUE})</name>
              <priority>INFO</priority>
              <description>System role has changed. Ack to close. A função do sistema mudou. Ack para fechar.</description>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>pbxState</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.637.64.4400.1.2</snmp_oid>
          <key>pbxState</key>
          <value_type>FLOAT</value_type>
          <description>Available values are: INDETERMINATE, CRITICAL, MAJOR, MINOR, WARNING or NORMAL Os valores disponíveis são: INDETERMINADO, CRÍTICO, MAIOR, MENOR, AVISO ou NORMAL</description>
          <applications>
            <application>
              <name>PABX-General-Status</name>
            </application>
          </applications>
          <valuemap>
            <name>pbxState</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{last()}=1 or {last()}=2</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{last()}=4 or {last()}=5</recovery_expression>
              <name>{HOST.NAME} - Failure - State is {ITEM.VALUE}</name>
              <priority>HIGH</priority>
              <description>{HOST.NAME} Failure - State is {ITEM.VALUE} Falha de {HOST.NAME} - o status é {ITEM.VALUE}</description>
              <dependencies>
                <dependency>
                  <name>No SNMP data collection</name>
                  <expression>{PABX-TEMPLATE:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
            <trigger>
              <expression>{last()}=0</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{last()}=4 or {last()}=5</recovery_expression>
              <name>{HOST.NAME} Failure - State is {ITEM.VALUE}</name>
              <priority>DISASTER</priority>
              <description>{HOST.NAME} Failure - State is {ITEM.VALUE} Falha de {HOST.NAME} - o status é {ITEM.VALUE}</description>
              <dependencies>
                <dependency>
                  <name>No SNMP data collection</name>
                  <expression>{PABX-TEMPLATE:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
            <trigger>
              <expression>{last(#1)}&lt;>{last(#2)}=1 and {last()}>0</expression>
              <name>{HOST.NAME} state has changed (state: {ITEM.VALUE})</name>
              <priority>INFO</priority>
              <description>System state has changed. Ack to close. O estado do sistema mudou. Ack para fechar.</description>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Sets in service</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.637.64.4400.1.7.0</snmp_oid>
          <key>setsInService</key>
          <description>Indicates the number of sets in service.This counter includes all types of set but not SIP sets Indica o número de SETS em serviço. Este contador inclui todos os tipos de SETS, mas não os conjuntos SIP</description>
          <applications>
            <application>
              <name>PABX-General-Status</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Sets out service</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.637.64.4400.1.8.0</snmp_oid>
          <key>setsOutOfServices</key>
          <description>Indicates the number of sets out of service. This counter includes all types of set but not SIP sets. Indica o número de SETS fora de serviço. Este contador inclui todos os tipos de conjunto, mas não os SETS SIP.</description>
          <applications>
            <application>
              <name>PABX-General-Status</name>
            </application>
          </applications>
        </item>
        <item>
          <name>SIP sets register</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.637.64.4400.1.5.0</snmp_oid>
          <key>sipRegSets</key>
          <description>Indicates the number of SIP terminals registered in the PCX, as well as SIP terminals not defined in PCX configuration (provided that authentication is not required for SIP terminal registration) Indica o número de terminais SIP registrados no PCX, bem como terminais SIP não definidos na configuração do PCX (desde que a autenticação não seja necessária para o registro do terminal SIP)</description>
          <applications>
            <application>
              <name>PABX-General-Status</name>
            </application>
          </applications>
        </item>
        <item>
          <name>SIP sets unregister</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.4.1.637.64.4400.1.6.0</snmp_oid>
          <key>sipUnregSets</key>
          <description>Indicates the number of SIP terminals not registered in the PCX. This counter is equal to the number of SIP terminals configured in the PCX minus the number of SIP terminals registered in the PCX. If authentication is not required for SIP terminal registration, this counter may be negative (when there are more self registered SIP terminals than SIP terminals configured in the PCX). Indica o número de terminais SIP não registrados no PCX. Este contador é igual ao número de terminais SIP configurados no PCX menos o número de terminais SIP registrados no PCX. Se a autenticação não for necessária para o registro do terminal SIP, este contador pode ser negativo (quando houver mais terminais SIP autorregistrados do que terminais SIP configurados no PCX).</description>
          <applications>
            <application>
              <name>PABX-General-Status</name>
            </application>
          </applications>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>CAC Discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#IPDOMAIN},.1.3.6.1.4.1.637.64.4400.1.3.1.1,{#CAC_ALLOWED},.1.3.6.1.4.1.637.64.4400.1.3.1.9,{#CAC_USED},.1.3.6.1.4.1.637.64.4400.1.3.1.10]</snmp_oid>
          <key>cac.discovery</key>
          <description>Indicates the number of external communications Indica o número de comunicações externas</description>
          <item_prototypes>
            <item_prototype>
              <name>Allowed Ext. Communications - IpDomain.[{#IPDOMAIN}]</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.637.64.4400.1.3.1.9.{#SNMPINDEX}</snmp_oid>
              <key>cac.allowed.[{#IPDOMAIN}]</key>
              <value_type>FLOAT</value_type>
              <description>Indicates the number of allowed external communications Indica o número de comunicações externas permitidas</description>
              <applications>
                <application>
                  <name>PABX CAC</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}&lt;=0</expression>
                  <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                  <recovery_expression>{last()}>0</recovery_expression>
                  <name>{HOST.NAME} - Domain {#IPDOMAIN} - Failure - No allowed external communications</name>
                  <priority>HIGH</priority>
                  <description>No allowed external communications in {HOST.NAME} - Domain {#IPDOMAIN}</description>
                  <manual_close>YES</manual_close>
                  <dependencies>
                    <dependency>
                      <name>No SNMP data collection</name>
                      <expression>{PABX-TEMPLATE:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                    </dependency>
                  </dependencies>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Used Ext. Communications - IpDomain.[{#IPDOMAIN}]</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.637.64.4400.1.3.1.10.{#SNMPINDEX}</snmp_oid>
              <key>cac.used.[{#IPDOMAIN}]</key>
              <value_type>FLOAT</value_type>
              <description>Indicates the current number of external communications This counter is only used if the number of allowed external communications is limited, if not its value is 0 Indica o número atual de comunicações externas. Este contador só é usado se o número de comunicações externas permitidas for limitado, caso contrário seu valor é 0 Command: cnx dom 1.3.6.1.4.1.637.64.4400.1.3.1.10.X X=IPDOMAIN</description>
              <applications>
                <application>
                  <name>PABX CAC</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
          <trigger_prototypes>
            <trigger_prototype>
              <expression>{PABX-TEMPLATE:cac.used.[{#IPDOMAIN}].last()} / {PABX-TEMPLATE:cac.allowed.[{#IPDOMAIN}].last()} >= 0.8</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{PABX-TEMPLATE:cac.used.[{#IPDOMAIN}].last()} / {PABX-TEMPLATE:cac.allowed.[{#IPDOMAIN}].last()} &lt; 0.8</recovery_expression>
              <name>{HOST.NAME} - Domain {#IPDOMAIN} - Used external communications is greater or equal than 80%</name>
              <priority>WARNING</priority>
              <description>Used external communications is greater than 80% in {HOST.NAME} - Domain {#IPDOMAIN}</description>
              <manual_close>YES</manual_close>
              <dependencies>
                <dependency>
                  <name>No SNMP data collection</name>
                  <expression>{PABX-TEMPLATE:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                </dependency>
              </dependencies>
            </trigger_prototype>
          </trigger_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>Ext. Communications [{#IPDOMAIN}]</name>
              <yaxismin>-1</yaxismin>
              <show_triggers>NO</show_triggers>
              <ymin_type_1>FIXED</ymin_type_1>
              <graph_items>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>1A7C11</color>
                  <item>
                    <host>PABX-TEMPLATE</host>
                    <key>cac.allowed.[{#IPDOMAIN}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>2</sortorder>
                  <color>F63100</color>
                  <item>
                    <host>PABX-TEMPLATE</host>
                    <key>cac.used.[{#IPDOMAIN}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>DSP Discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#IPDOMAIN},.1.3.6.1.4.1.637.64.4400.1.3.1.1,{#DSP_RESS_AVAILABLE},.1.3.6.1.4.1.637.64.4400.1.3.1.5,{#DSP_RESS_BUSY},.1.3.6.1.4.1.637.64.4400.1.3.1.6,{#DSP_RESS_OUT_OF_ORDER},.1.3.6.1.4.1.637.64.4400.1.3.1.7]</snmp_oid>
          <key>dsp.discovery</key>
          <description>Indicates the number of DSP resources (i.e. compressors) Indica o número de recursos DSP (ou seja, compressores)</description>
          <item_prototypes>
            <item_prototype>
              <name>Available DSP - IpDomain.[{#IPDOMAIN}]</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.637.64.4400.1.3.1.5.{#SNMPINDEX}</snmp_oid>
              <key>dsp.available.[{#IPDOMAIN}]</key>
              <value_type>FLOAT</value_type>
              <description>Indicates the number of available DSP resources (i.e. compressors) Indica o número de recursos DSP disponíveis (ou seja, compressores) Command: cnx dom OID-BASE: 1.3.6.1.4.1.637.64.4400.1.3.1.5.X X=IPDOMAIN</description>
              <applications>
                <application>
                  <name>PABX DSP</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Busy DSP - IpDomain.[{#IPDOMAIN}]</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.637.64.4400.1.3.1.6.{#SNMPINDEX}</snmp_oid>
              <key>dsp.busy.[{#IPDOMAIN}]</key>
              <value_type>FLOAT</value_type>
              <description>Indicates the number of busy compressors Indica o número de compressores ocupados Command: cnx dom 1.3.6.1.4.1.637.64.4400.1.3.1.6.X X=IPDOMAIN</description>
              <applications>
                <application>
                  <name>PABX DSP</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Out Service DSP - IpDomain.[{#IPDOMAIN}]</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.1.3.6.1.4.1.637.64.4400.1.3.1.7.{#SNMPINDEX}</snmp_oid>
              <key>dsp.out.[{#IPDOMAIN}]</key>
              <value_type>FLOAT</value_type>
              <description>Indicates the number of out service compressors Indica o número de compressores fora de serviço Command: cnx dom 1.3.6.1.4.1.637.64.4400.1.3.1.6.X X=IPDOMAIN</description>
              <applications>
                <application>
                  <name>PABX DSP</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
          <trigger_prototypes>
            <trigger_prototype>
              <expression>{PABX-TEMPLATE:dsp.busy.[{#IPDOMAIN}].last()} / {PABX-TEMPLATE:dsp.available.[{#IPDOMAIN}].last()} >= 0.8</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{PABX-TEMPLATE:dsp.busy.[{#IPDOMAIN}].last()} / {PABX-TEMPLATE:dsp.available.[{#IPDOMAIN}].last()} &lt; 0.8</recovery_expression>
              <name>{HOST.NAME} - Domain {#IPDOMAIN} - Busy compressors is greater or equal than 80%</name>
              <priority>WARNING</priority>
              <description>Busy compressors is greater or equal than 80% in {HOST.NAME} - Domain {#IPDOMAIN}</description>
              <manual_close>YES</manual_close>
              <dependencies>
                <dependency>
                  <name>No SNMP data collection</name>
                  <expression>{PABX-TEMPLATE:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                </dependency>
              </dependencies>
            </trigger_prototype>
            <trigger_prototype>
              <expression>{PABX-TEMPLATE:dsp.available.[{#IPDOMAIN}].last()}=0 and {PABX-TEMPLATE:dsp.out.[{#IPDOMAIN}].last()}>=0</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{PABX-TEMPLATE:dsp.available.[{#IPDOMAIN}].last()}> 0 and {PABX-TEMPLATE:dsp.out.[{#IPDOMAIN}].last()}=0</recovery_expression>
              <name>{HOST.NAME} - Out Service all compressors {HOST.NAME} - Domain {#IPDOMAIN}</name>
              <priority>HIGH</priority>
              <description>Out Service all compressors {HOST.NAME} - Domain {#IPDOMAIN}</description>
              <manual_close>YES</manual_close>
              <dependencies>
                <dependency>
                  <name>No SNMP data collection</name>
                  <expression>{PABX-TEMPLATE:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                </dependency>
              </dependencies>
            </trigger_prototype>
          </trigger_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>Compressors (DSP) - [{#IPDOMAIN}]</name>
              <yaxismax>0</yaxismax>
              <show_work_period>NO</show_work_period>
              <show_triggers>NO</show_triggers>
              <type>PIE</type>
              <graph_items>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>1A7C11</color>
                  <item>
                    <host>PABX-TEMPLATE</host>
                    <key>dsp.available.[{#IPDOMAIN}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>2</sortorder>
                  <color>FFFF00</color>
                  <item>
                    <host>PABX-TEMPLATE</host>
                    <key>dsp.busy.[{#IPDOMAIN}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>3</sortorder>
                  <color>F63100</color>
                  <item>
                    <host>PABX-TEMPLATE</host>
                    <key>dsp.out.[{#IPDOMAIN}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>IpDomain Discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#IPDOMAIN},.1.3.6.1.4.1.637.64.4400.1.3.1.1]</snmp_oid>
          <key>ipdomain.discovery</key>
          <delay>30m</delay>
          <description>IP domain number</description>
        </discovery_rule>
        <discovery_rule>
          <name>Trunk Discovey</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#TRUNK_ID},.1.3.6.1.4.1.637.64.4400.1.9.1.1,{#TRUNK_NAME},.1.3.6.1.4.1.637.64.4400.1.9.1.2,{#TRUNK_TYPE},.1.3.6.1.4.1.637.64.4400.1.9.1.5,{#TRUNK_STATUS},.1.3.6.1.4.1.637.64.4400.1.9.1.10,{#FREE_CHAN},.1.3.6.1.4.1.637.64.4400.1.9.1.7,{#BUSY_CHAN},.1.3.6.1.4.1.637.64.4400.1.9.1.8,{#OOS_CHAN},.1.3.6.1.4.1.637.64.4400.1.9.1.9]</snmp_oid>
          <key>trunk.discovery</key>
          <delay>30s</delay>
          <description>Info the trunks and channels Informações sobre os troncos e canais</description>
        </discovery_rule>
      </discovery_rules>
    </template>
    <template>
      <template>PABX-TRAPS</template>
      <name>PABX-TRAPS</name>
      <groups>
        <group>
          <name>PABX</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>TRAPS</name>
        </application>
      </applications>
      <items>
        <item>
          <name>SNMP TRAP - Inter ACT link HS</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*379]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Inter ACT link HS - Incident: 379 Inter-crystal signaling link problems on Link establishment or shutdown of existing link Several possible causes; No system reaction. Check IP resources boards within INTIPB. To see timer used tabtemptool.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(379)}=1</expression>
              <name>{HOST.NAME} - Inter ACT link HS</name>
              <priority>WARNING</priority>
              <description>{ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - PCS Establishment or Loss Link</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*427]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} PCS Establishment or Loss Link - Incident: 427 PCS->CS: @IP P1 error P2 P1 : IP Adress of the CS P2 : Error Type - 1 Establishment of the link - 0 Lost link Establishment or lost of the link with the CS No system reaction Verify the state off the IP link between the PCS and the CS</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>(({iregexp(error.(0)})&lt;>0)</expression>
              <name>PCS ({ITEM.VALUE}.regsub("\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(?:\/\d{2})?"),"\1") Loss Link</name>
              <priority>WARNING</priority>
              <description>PCS ({ITEM.VALUE}.regsub("\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(?:\/\d{2})?"),"\1") Loss Link</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - PCS with domain - Establishment or Loss Link</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*428]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} PCS with domain - Establishment or Loss Link - Incident: 428 CS->PCS: @IP P1 error P2 PCS domain P3 P1 : IP Adress of the PCS P2 : Error Type - 1 Establishment of the link - 0 Lost link P3 : domain off the PCS Establishment or lost of the link with the PCS No system reaction Verify the state off the IP link between the PCS and the CS</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>(({iregexp(error.(0)})&lt;>0)</expression>
              <name>PCS ({ITEM.VALUE}.regsub("(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(?:\/\d{2})?).*(domain.\d{1,4})"),"\1 - \2") Loss Link</name>
              <priority>WARNING</priority>
              <description>PCS ({ITEM.VALUE}.regsub("(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(?:\/\d{2})?).*(domain.\d{1,4})"),"\1 - \2") Loss Link</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - PCS Database update error</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*433]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} PCS Database update: error - Incident: 433 PCS P1: Database update: error P2 info P3. P1 : PCS IP address P2 : Reason of the update failure. - 1 Error mapping on remanents. - 2 PCS unreachable. - 3 PCS bad soft. release. - 4 The database bacup failed. - 5 The database copy on PCS failed. - 6 The database restoration on PCS failed. - 7 The PCS reboot failed. - 8 PCS in active mode. - 9 A process Bck is already running on the PCS. P3 : Further information, swinst errors (if P2 = 3, 5 or 6). - 0 No info. - 1 Invalid command syntax. - 2 The telephonic application is started. - 3 The telephonic application is stopped. - 4 An other backup is already running. - 5 Not enough space on root file system. - 6 No telephonic application has been installed. - 7 The emulation layer is stopped. - 8 Invalid archive format. - 9 Remote CPU unreachable. - 10 Warnings during the command. - 11 Failure. The PCS database update failed. No system reaction No action.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(433)}=1</expression>
              <name>{HOSTNAME} - PCS Database update error</name>
              <priority>WARNING</priority>
              <description>PCS Database update error: {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - FlexLM no checkout can be realized</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*640]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} FLEXLM_ERROR_SERVER : no checkout can be realized - Incident: 640 FLEXLM_ERROR_SERVER : no checkout can be realized P1 P2 P1: Number of sub-incident flex error server P2: Parameter sent by the application Value of P1 Meaning of P1 Field P2 1 FlexLM server not found FlexLM error number 2 Impossible to check in licenses FlexLM error number 3 Server busy FlexLM error number 4 Impossible to check out licenses FlexLM error number 5 Problem on the license file FlexLM error number 6 Invalid feature name FlexLM error number 7 Invalid license file FlexLM error number 8 General FlexLM error FlexLM error number An error occur during the licensing process on the FlexLM server. No system reaction Verify the FlexLM server configuration (Number of unused licenses, ...).</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \2</params>
            </step>
            <step>
              <type>REGEX</type>
              <params>.*(\d{1,8}) No checkout can be realized in FlexLM Server: \1</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>(({iregexp((1|2|3|4|5|6|7|8)})&lt;>0)</expression>
              <name>{HOSTNAME} - FLEXLM - No checkout can be realized</name>
              <priority>AVERAGE</priority>
              <description>No checkout can be realized {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - FlexLM -Network breakdown with the licensing FlexLM server</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*642]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <description>{HOSTNAME} Network breakdown with the licensing FlexLM server - Incident: 642 FLEXLM_SERVER_LINK: Network breakdown with the licensing FlexLM server P1 P2 P1: Number of sub-incident. P2 : Parameter sent by the application Value of P1 Meaning of P1 Field P2 1 FlexLM network problem FlexLM error code 2 PANIC MODE is running FlexLM error code Network link error with the licensing FlexLM server. Verify that the FlexLM server is always running and connected o the network. No system reaction. Note the incident, with all pertinent information on an observation sheet (or problem report), specifying the error context as much as possible.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
            <step>
              <type>REGEX</type>
              <params>.*(\d{1,2}) \1</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{last()}=1</expression>
              <name>{HOSTNAME} - FlexLM - Network problem FlexLM error code</name>
              <priority>AVERAGE</priority>
              <description>FlexLM network problem FlexLM error code {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
            <trigger>
              <expression>{last()}=2</expression>
              <name>{HOSTNAME} - FlexLM - PANIC MODE is running FlexLM error code</name>
              <priority>AVERAGE</priority>
              <description>PANIC MODE is running FlexLM error code: {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - FlexLM - Link breakdown with the FLEX agent</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*644]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <description>{HOSTNAME} The flex agent is not running or does not respond - Incident: 644 FLEX_AG_CRASH: Link breakdown with the FLEX agent P1 P2 P1: Number of sub-incident FLEX ag crash P2: Parameter sent by the application Value of P1 Meaning of P1 Field P2 1 No link with the FLEX agent IPC status The flex agent is not running or does not respond. No system reaction. Note the incident, with all pertinent information on an observation sheet (or problem report), specifying the error context as much as possible.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
            <step>
              <type>REGEX</type>
              <params>.*(\d{1}) \1</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{last()}=1</expression>
              <name>{HOSTNAME} - FlexLM - Link breakdown</name>
              <priority>AVERAGE</priority>
              <description>FlexLM - Link breakdown {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Login Alert</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*1125]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <status>DISABLED</status>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(1125)}=1</expression>
              <name>{HOSTNAME} - LOGIN MTCL ALERT</name>
              <status>DISABLED</status>
              <priority>INFO</priority>
              <description>{ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Powerfail, shutdown</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*1521]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Powerfail, shutdown - Incident: 1521 Powerfail, shutdown Power failure Power failure detection. The system tries an absolute shut down. Check the power supply.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>(({regexp({PABX-TRAPS:snmptrap[637\.64\.0\.10\.1\.1\.8.*:*1521].str(1521)})&lt;>0)</expression>
              <name>Powerfail, shutdown</name>
              <priority>WARNING</priority>
              <description>Powerfail, shutdown {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Shutdown Command</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2073]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Shutdown command has been called</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(2073)}=1</expression>
              <name>{HOSTNAME} - Shutdown Command</name>
              <priority>INFO</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - CPU was halted due to a shutdown</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2077]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Bascul command called - Incident: 2077 CPU was halted due to a shutdown CPU was halted due to a shutdown. CPU is shutting down. No action.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(2077)}=1</expression>
              <name>{HOSTNAME} - CPU was halted due to a shutdown</name>
              <priority>WARNING</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - SQL error</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2255]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} SQL error - Incident: 2255 SQL error: appli P1 table P2 error P3 (P4) P1: Application instance which has transmitted the incident P2: SQL table with which the instance was working when the incident occurred P3: Number of the SQL error (Refer to the CQL manual) P4: TTY Input/output used by the P1 application during the current execution (ttyxx, sccxx, spbxx, io2ttyxx, etc., ? if unknown) SQL error: SQL unknown operation Similar to SQL_ERROR. Similar to SQL_ERROR. Similar to SQL_ERROR.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>SNMP TRAP - Presence of two main Call Server on the network</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2345]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Presence of two main Call Server on the network - Incident: 2345 Presence of two main Call Server on the network After a network break down both duplicate Call Server is Main The system goes down Check the IP network</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(2345)}=1</expression>
              <name>{HOSTNAME} - Presence of two main Call Server on the network</name>
              <priority>INFO</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Bascul command called</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2346]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Bascul command called - Incident: 2346 Bascul command called Bascul command called The system goes down Check the switchover of the standby CPU</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>SNMP TRAP - Reset of standby CPU</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2347]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Reset of standby CPU - Incident: 2347 Reset of standby CPU if CPU CS: reset main CPU reset the standby if CPU5,6,7: reset after loosing IP connection with main CPU The system goes down if CPU CS: Check the main CPU if CPU 5,6,7: Check IP network between CPU</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(2347)}=1</expression>
              <name>{HOSTNAME} - Reset of standby CPU</name>
              <priority>INFO</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Local CPU Shutdown</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2348]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Local CPU Shutdown - Incident: 2348 Local CPU Shutdown System has detected an incoherent state A reset/switchover is necessary. No operator action required</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(2348)}=1</expression>
              <name>{HOSTNAME} - Local CPU Shutdown</name>
              <priority>INFO</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Bascul command called</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2349]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Bascul command called - Incident: 2349 Bascul command called Bascul command called The system goes down Check the switchover of the standby CPU</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>SNMP TRAP - Failure of the backup inter-ACT link establishment</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2479]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Failure of the backup inter-ACT link establishment - Incident: 2479 Failure of the backup inter-ACT link establishment The CPU did not receive any message from the LIO telling that the ISDN backup link is active The backup call is released Check the configuration (in particular the backup number)</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(2479)}=1</expression>
              <name>{HOSTNAME} - Failure of the backup inter-ACT link establishment</name>
              <priority>INFO</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Virtual board not initialized.</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2489]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Virtual board not initialized- Incident: 2489 P1 virtual board (P2,P3) of the associated board P4 (P5,P6) not initialized. P1 = logical name of the unstarted virtual board P2 = Crystal number P3 = uninitialized virtual board number P4 = logical name of the associated board P5 = Crystal number P6 = board number of the associated board This anomaly message informs the operator than one board did not start two minutes past the starting of the associated board. No reaction for the system Reset associated board and check again; if the same incident occurs consult with expert of connected exchange.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(2489)}=1</expression>
              <name>{HOSTNAME} - Virtual board not initialized.</name>
              <priority>INFO</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Loss of a virtual board</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2490]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Loss of a virtual board - Incident: 2490 Loss of a virtual board P1 (P2,P3) of the associated board P4 (P5,P6) P1: Logical name of lost virtual board P2: Crystal number P3: Virtual coupler number P4: Logical name of the associated coupler P5: Crystal number P6: Coupler number of the associated board Loss of a virtual coupler Any transmission with the virtual coupler has become impossible. All the resources previously occupied by the terminals of the lost virtual coupler are released. Reinitialize the virtual coupler for executing rstcpl. If the problem persists, note the incident with all its information on an observation sheet (problem report), specifying the error context if possible.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(2490)}=1</expression>
              <name>{HOSTNAME} - Loss of a virtual board</name>
              <priority>WARNING</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Virtual board commissioning</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2491]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Virtual board commissioning - Incident: 2491 P1(P2,P3) virtual board commissioning of the associated board P4(P5,P6) P1: Type of the commissioned virtual board P2: Crystal number P3: Virtual coupler number P4: Logical name of the associated coupler P5: Crystal number P6: Coupler number of the associated board Virtual coupler commissioning The virtual coupler is commissioned. This does not mean that the equipment which comes with it is commissioned too. No system reaction No operator action required</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(2491)}=1</expression>
              <name>{HOSTNAME} - Virtual board commissioning</name>
              <priority>INFO</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - SQL error</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2650]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} SQL error - Incident: 2650 SQL error: appli P1 table P2 error P3 P1: Number of the application transmitting the incident P2: Table or object number P3: Error number Unknown operation to get to a data base The database has become incoherent as a result of a software error (for instance, attempt to get to a non-existent field).The database does not correspond to the software version. If it appears during the system initialization, the problem is serious since certain data won't get a new stock of memory or will get an incomplete stock. The problem is less critical if it occurs during a configuration because the system ignores the modification or the edition in progress. Reload the database if it is saved. Note the incident with all its information on an observation sheet (problem report), specifying the error context if possible.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>SNMP TRAP - SIP trunk group put into service</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*5800]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} SIP external gateway P1 is out of service - Incident: 5800 P1 SIP trunk group put into service P1: SIP trunk group id put into service SIP Gateway put into service No system reaction No action</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(5800)}=1</expression>
              <name>{HOSTNAME} - SIP trunk group put into service</name>
              <priority>INFO</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - SIP trunk group put out of service</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*5801]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} SIP trunk group put out of service - Incident: 5801 P1 SIP trunk group put out of service P1: SIP trunk group id put into service SIP Gateway out of service No system reaction No action</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(5801)}=1</expression>
              <name>{HOSTNAME} - SIP trunk group put out of service</name>
              <priority>WARNING</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - SIP external gateway P1 is in service</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*5812]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} SIP external gateway P1 is in service - Incident: 5812 SIP external gateway P1 is in service P1: SIP external gateway number SIP Gateway put into service No system reaction No action</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(5812)}=1</expression>
              <name>{HOSTNAME} - SIP external gateway in service</name>
              <priority>INFO</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - SIP external gateway P1 is out of service</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*5813]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} SIP external gateway P1 is out of service - Incident: 5813 SIP external gateway P1 is out of service P1: SIP external gateway number SIP Gateway put out of service No system reaction No action</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(5813)}=1</expression>
              <name>{HOSTNAME} - SIP external gateway is out of service</name>
              <priority>WARNING</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Critical failure in SIP component</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*5814]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Critical failure in SIP component - Incident: 5814 Critical failure in SIP component Look at the SIP Alarm log file: /tmpd/sipalarm.log or at the traces for more informations No system reaction No action</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(5814)}=1</expression>
              <name>{HOSTNAME} - Critical failure in SIP component</name>
              <priority>WARNING</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Media Gateway has received a power supply alarm</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*5856]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Media Gateway has received a power supply alarm - Incident: 5856 Media Gateway has received a power supply alarm CPU has received a power supply alarm, so there is probably a power supply problem. No reaction Check power supply.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(5856)}=1</expression>
              <name>{HOSTNAME} - Media Gateway has received a power supply alarm</name>
              <priority>WARNING</priority>
              <description>{HOSTNAME} - {ITEM.VALUE}</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - GD/GA/INTIP/RGD: reason of reboot</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*5857]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} GD/GA/INTIP/RGD: reason of reboot P1- Incident: 5857 P1 Error state P1: GD/GA code: - 0: Reset by "reboot" or "shutdown -r" command - 1: Reset on exception of the real time task - 2: Hardware reset on loss of DL IP - 3: Soft reset on loss of DL IP - 4: Soft reset on loss of DL backup - 5: Bad initialization with Call Server - 6: Time out in phase of initialization - 7: Reset by "rstcpl" command - 8: Update of binaries - 9: Update of parameters with mgconfig - 10: Update of parameters with UAconfig - 11: NMI Watchdog - 12: Update of bios - 13: Power off on GD/GA or Reset by "rstcpl" command on GA - 14: Not enough memory for the real time task - 15: Reset on exception in the Linux core - 16: Not enough buffer descriptor - 17: Reset on not obtaining IP parameters from the DHCP server - 18: Change of IP parameters by the DHCP server - 19: No renewal of IP parameters on expiration of the lease time - 20: Backup configured but not validated (DHCP mode is configured) - 21: Reset on startemg file not received and no backup mode - 22: Reset on lanpbx.cfg file not received when CS address : is dynamic and no backup mode - 23: Time out in phase of waiting of backup or IP establishment - 24: Software anomaly - 25: Reset with the re-establishment of the power supply : if DL IP is KO - 26: Reset with the re-establishment of the power supply : during the stop of the CPU applications - 27: Reset with the re-establishment of the power supply : when the CPU applications are stopped - 28: Reset on Ethernet link test failed at system startup - 29: Reset on back panel - communication lost between GD and GA - 30: Reset on connect not received - 255: Unknown reason: : - impossible to store reason in flash : - defective ramdisk : - impossible to treat NMI watchdog : - stop of the system on empty battery : - hot unplug INTIP code: - 0: Normal state - 1: Reset order from CPU - 2: Reset order from monitor - 3: Reset order from V24 - 4: Backtrace - 5: Signalization link lost - 6: DHCP loss - 7: Backplane clock loss - 8: Fatal error on C1 - 9: No more memory (C1 pool) - 10: No more memory (BD Pool) - 11: No more memory (Heap) - 12: C1 download timeout - 13: Too many CTX event - 14: Cold init asked by CPU - 15: Bad state in Mngt state machine - 16: Signalization link establishment failed - 17: No coupler detected in shelf - 18: IP Redundancy: loss of Ethernet - 19 : Fatal CPU error (checkstop) - 20 : Blocking Bus Monitor (Machine Check) - 255: other reason Note (INTIP): For reason 5 and 6, a diagnosis has been processed automatically by INTIP board. You just have to download NetDiag.txt file using TFTP from CPU (Main or Standby) which contains results. See document 3BA_29000_0628_PAZZA for more information Example: Tftp 192.168.42.15 bin get NetDiag.txt quit RGD code: - 0: Reset by "reboot" or "shutdown -r" command - 1: Reset on exception of the real time task - 2: Hardware reset on loss of DL HSL - 5: Bad initialization with Call Server - 6: Time out in phase of initialization - 7: Reset by "rstcpl" command - 8: Update of binaries - 11: NMI Watchdog - 12: Update of bios - 13: Power off on RGD - 14: Not enough memory for the real time task - 15: Reset on exception in the Linux core - 16: Not enough buffer descriptors - 24: Software anomaly - 255: Unknown reason: : - impossible to store reason in flash : - defective ramdisk : - impossible to treat NMI watchdog : - stop of the system on empty battery : - hot unplug No system reaction Note the incident on a problem report. For INTIP reason 20: Change GIP6 board and if the problem persist change INTIP board and return board to R&amp;D for analyse.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(5857)}=1</expression>
              <name>{HOSTNAME} - GD/GA/INTIP/RGD: reason of reboot</name>
              <priority>AVERAGE</priority>
              <description>{HOSTNAME} - {ITEM.VALUE} GD/GA/INTIP/RGD: reason of reboot</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - Media Gateway power supply has come back</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*5858]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} Media Gateway power supply has come back - Incident: 5858</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(5858)}=1</expression>
              <name>{HOSTNAME} - Media Gateway power supply has come back</name>
              <priority>WARNING</priority>
              <description>{HOSTNAME} - {ITEM.VALUE} Media Gateway power supply has come back</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP TRAP - MG/RGD: download status error</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap[637\.64\.0\.10\.1\.1\.8.*:*5859]</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <description>{HOSTNAME} MG/RGD: download status P1 - Incident: 5859 MG/RGD: download status P1 P1 Error state P1: RGD code: - 0: No Ethernet - 1: binrgd download failure - 2: TFTP failure on binaries download - 3: Binary files corrupted - 4: Not enough memory - 5: Failure on copy in flash - 6: Bad network configuration - 255: Unknown status MG code: - 1: binmg download failure - 2: TFTP failure on binaries download No system reaction MG : MG has started using its old binaries, please check binaries versions MG : and if necessary, do a MG reset RGD : Note the incident on a problem report.</description>
          <applications>
            <application>
              <name>TRAPS</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>REGEX</type>
              <params>637\.64\.0\.10\.1\.1\.8.*:.(\d{1,4})\n.*637\.64\.0\.10\.1\.1\.9.*STRING:."(.*)" \1 - \2</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{str(5859)}=1</expression>
              <name>{HOSTNAME} - MG/RGD: download status error</name>
              <priority>AVERAGE</priority>
              <description>{HOSTNAME} - {ITEM.VALUE} MG/RGD: download status error</description>
              <type>MULTIPLE</type>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
      </items>
    </template>
    <template>
      <template>Template Module EtherLike-MIB SNMP</template>
      <name>Template Module EtherLike-MIB SNMP</name>
      <description>Template EtherLike-MIB (duplex control only) MIBs used: EtherLike-MIB Template tooling version used: 0.38</description>
      <groups>
        <group>
          <name>Templates/Modules</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Network interfaces</name>
        </application>
      </applications>
      <discovery_rules>
        <discovery_rule>
          <name>EtherLike-MIB Discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.10.7.2.1.19,{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2]</snmp_oid>
          <key>net.if.duplex.discovery</key>
          <delay>1h</delay>
          <filter>
            <evaltype>AND</evaltype>
            <conditions>
              <condition>
                <macro>{#IFOPERSTATUS}</macro>
                <value>1</value>
                <formulaid>A</formulaid>
              </condition>
              <condition>
                <macro>{#SNMPVALUE}</macro>
                <value>(2|3)</value>
                <formulaid>B</formulaid>
              </condition>
            </conditions>
          </filter>
          <description>Discovering interfaces from IF-MIB and EtherLike-MIB. Interfaces with up(1) Operational Status are discovered.</description>
          <item_prototypes>
            <item_prototype>
              <name>Interface {#IFNAME}({#IFALIAS}): Duplex status</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.10.7.2.1.19.{#SNMPINDEX}</snmp_oid>
              <key>net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}]</key>
              <history>7d</history>
              <description>MIB: EtherLike-MIB The current mode of operation of the MAC entity. 'unknown' indicates that the current duplex mode could not be determined. Management control of the duplex mode is accomplished through the MAU MIB. When an interface does not support autonegotiation, or when autonegotiation is not enabled, the duplex mode is controlled using ifMauDefaultType. When autonegotiation is supported and enabled, duplex mode is controlled using ifMauAutoNegAdvertisedBits. In either case, the currently operating duplex mode is reflected both in this object and in ifMauType. Note that this object provides redundant information with ifMauType. Normally, redundant objects are discouraged. However, in this instance, it allows a management application to determine the duplex status of an interface without having to know every possible value of ifMauType. This was felt to be sufficiently valuable to justify the redundancy. Reference: [IEEE 802.3 Std.], 30.3.1.1.32,aDuplexStatus.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFNAME}({#IFALIAS})</name>
                </application_prototype>
              </application_prototypes>
              <valuemap>
                <name>EtherLike-MIB::dot3StatsDuplexStatus</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}=2</expression>
                  <name>Interface {#IFNAME}({#IFALIAS}): In half-duplex mode</name>
                  <priority>WARNING</priority>
                  <description>Please check autonegotiation settings and cabling</description>
                  <manual_close>YES</manual_close>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
          <preprocessing>
            <step>
              <type>JAVASCRIPT</type>
              <params>try { var data = JSON.parse(value); } catch (error) { throw 'Failed to parse JSON of EtherLike-MIB discovery.'; } var fields = ['{#SNMPVALUE}','{#IFOPERSTATUS}','{#IFALIAS}','{#IFNAME}','{#IFDESCR}']; data.forEach(function (element) { fields.forEach(function (field) { element[field] = element[field] || ''; }); }); return JSON.stringify(data);</params>
            </step>
          </preprocessing>
        </discovery_rule>
      </discovery_rules>
    </template>
    <template>
      <template>Template Module Generic SNMP</template>
      <name>Template Module Generic SNMP</name>
      <description>Template Module Generic MIBs used: SNMPv2-MIB Template tooling version used: 0.36</description>
      <templates>
        <template>
          <name>Template Module ICMP Ping</name>
        </template>
      </templates>
      <groups>
        <group>
          <name>Templates/Modules</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>General</name>
        </application>
      </applications>
      <items>
        <item>
          <name>SNMP traps (fallback)</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap.fallback</key>
          <history>2w</history>
          <trends>0</trends>
          <value_type>LOG</value_type>
          <description>Item is used to collect all SNMP traps unmatched by other snmptrap items</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <logtimefmt>hh:mm:sszyyyy/MM/dd</logtimefmt>
        </item>
        <item>
          <name>System contact details</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.4.0</snmp_oid>
          <key>system.contact[sysContact.0]</key>
          <delay>1h</delay>
          <history>2w</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>MIB: SNMPv2-MIB The textual identification of the contact person for this managed node, together with information on how to contact this person. If no contact information is known, the value is the zero-length string.</description>
          <inventory_link>CONTACT</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>1d</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>System description</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.1.0</snmp_oid>
          <key>system.descr[sysDescr.0]</key>
          <delay>1h</delay>
          <history>2w</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>MIB: SNMPv2-MIB A textual description of the entity. This value should include the full name and version identification of the system's hardware type, software operating-system, and networking software.</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>1d</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>System location</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.6.0</snmp_oid>
          <key>system.location[sysLocation.0]</key>
          <delay>1h</delay>
          <history>2w</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>MIB: SNMPv2-MIB The physical location of this node (e.g., `telephone closet, 3rd floor'). If the location is unknown, the value is the zero-length string.</description>
          <inventory_link>LOCATION</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>1h</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>System name</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.5.0</snmp_oid>
          <key>system.name</key>
          <delay>1h</delay>
          <history>2w</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>MIB: SNMPv2-MIB An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name. If the name is unknown, the value is the zero-length string.</description>
          <inventory_link>NAME</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>1h</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{diff()}=1 and {strlen()}>0</expression>
              <name>System name has changed (new name: {ITEM.VALUE})</name>
              <priority>INFO</priority>
              <description>System name has changed. Ack to close.</description>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>System object ID</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.2.0</snmp_oid>
          <key>system.objectid[sysObjectID.0]</key>
          <delay>15m</delay>
          <history>2w</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>MIB: SNMPv2-MIB The vendor's authoritative identification of the network management subsystem contained in the entity. This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed. For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>DISCARD_UNCHANGED_HEARTBEAT</type>
              <params>1h</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>Uptime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.3.0</snmp_oid>
          <key>system.uptime[sysUpTime.0]</key>
          <delay>30s</delay>
          <history>2w</history>
          <trends>0d</trends>
          <units>uptime</units>
          <description>MIB: SNMPv2-MIB The time (in hundredths of a second) since the network management portion of the system was last re-initialized.</description>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{last()}&lt;10m</expression>
              <name>{HOST.NAME} has been restarted (uptime &lt; 10m)</name>
              <priority>WARNING</priority>
              <description>Uptime is less than 10 minutes</description>
              <manual_close>YES</manual_close>
              <dependencies>
                <dependency>
                  <name>No SNMP data collection</name>
                  <expression>{Template Module Generic SNMP:zabbix[host,snmp,available].max({$SNMP.TIMEOUT})}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>SNMP agent availability</name>
          <type>INTERNAL</type>
          <key>zabbix[host,snmp,available]</key>
          <history>7d</history>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <valuemap>
            <name>zabbix.host.available</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{max({$SNMP.TIMEOUT})}=0</expression>
              <name>No SNMP data collection</name>
              <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
              <priority>WARNING</priority>
              <description>SNMP is not available for polling. Please check device connectivity and SNMP settings.</description>
              <dependencies>
                <dependency>
                  <name>Unavailable by ICMP ping</name>
                  <expression>{Template Module Generic SNMP:icmpping.max(#3)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
      </items>
      <macros>
        <macro>
          <macro>{$SNMP.TIMEOUT}</macro>
          <value>5m</value>
        </macro>
      </macros>
    </template>
    <template>
      <template>Template Module ICMP Ping</template>
      <name>Template Module ICMP Ping</name>
      <description>Template Module ICMP Ping version: 0.12</description>
      <groups>
        <group>
          <name>Templates/Modules</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Status</name>
        </application>
      </applications>
      <items>
        <item>
          <name>ICMP ping</name>
          <type>SIMPLE</type>
          <key>icmpping</key>
          <delay>60</delay>
          <history>1w</history>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <valuemap>
            <name>Service state</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{max(#3)}=0</expression>
              <name>Unavailable by ICMP ping</name>
              <priority>HIGH</priority>
              <description>Last value: {ITEM.LASTVALUE1}. Last three attempts returned timeout. Please check device connectivity.</description>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>ICMP loss</name>
          <type>SIMPLE</type>
          <key>icmppingloss</key>
          <delay>60</delay>
          <history>1w</history>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{min(5m)}>{$ICMP_LOSS_WARN} and {min(5m)}&lt;100</expression>
              <name>High ICMP ping loss</name>
              <priority>WARNING</priority>
              <dependencies>
                <dependency>
                  <name>Unavailable by ICMP ping</name>
                  <expression>{Template Module ICMP Ping:icmpping.max(#3)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>ICMP response time</name>
          <type>SIMPLE</type>
          <key>icmppingsec</key>
          <delay>60</delay>
          <history>1w</history>
          <value_type>FLOAT</value_type>
          <units>s</units>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{avg(5m)}>{$ICMP_RESPONSE_TIME_WARN}</expression>
              <name>High ICMP ping response time</name>
              <priority>WARNING</priority>
              <dependencies>
                <dependency>
                  <name>High ICMP ping loss</name>
                  <expression>{Template Module ICMP Ping:icmppingloss.min(5m)}>{$ICMP_LOSS_WARN} and {Template Module ICMP Ping:icmppingloss.min(5m)}&lt;100</expression>
                </dependency>
                <dependency>
                  <name>Unavailable by ICMP ping</name>
                  <expression>{Template Module ICMP Ping:icmpping.max(#3)}=0</expression>
                </dependency>
              </dependencies>
            </trigger>
          </triggers>
        </item>
      </items>
      <macros>
        <macro>
          <macro>{$ICMP_LOSS_WARN}</macro>
          <value>20</value>
        </macro>
        <macro>
          <macro>{$ICMP_RESPONSE_TIME_WARN}</macro>
          <value>0.15</value>
        </macro>
      </macros>
    </template>
    <template>
      <template>Template Module Interfaces Simple SNMP</template>
      <name>Template Module Interfaces Simple SNMP</name>
      <description>Template Module Interfaces Simple (no ifXTable). This is the exact copy of Template Module Interfaces template with the exception that metrics from ifXTable are replaced with ifTable counters where possible. Use this template with devices where IF-MIB::ifXtable is not available. If supported by the host - use Template Module Interfaces template instead. MIBs used: IF-MIB Known Issues: Description: 32bit counters are used in this template (since there is no ifXtable available). If busy interfaces return incorrect bits sent/received - set update interval to 1m or less. Template tooling version used: 0.36</description>
      <groups>
        <group>
          <name>Templates/Modules</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Network interfaces</name>
        </application>
      </applications>
      <discovery_rules>
        <discovery_rule>
          <name>Network interfaces discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFNAME},1.3.6.1.2.1.2.2.1.2,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
          <key>net.if.discovery</key>
          <delay>1h</delay>
          <filter>
            <evaltype>AND</evaltype>
            <conditions>
              <condition>
                <macro>{#IFADMINSTATUS}</macro>
                <value>{$NET.IF.IFADMINSTATUS.MATCHES}</value>
                <formulaid>A</formulaid>
              </condition>
              <condition>
                <macro>{#IFADMINSTATUS}</macro>
                <value>{$NET.IF.IFADMINSTATUS.NOT_MATCHES}</value>
                <operator>NOT_MATCHES_REGEX</operator>
                <formulaid>B</formulaid>
              </condition>
              <condition>
                <macro>{#IFOPERSTATUS}</macro>
                <value>{$NET.IF.IFOPERSTATUS.MATCHES}</value>
                <formulaid>G</formulaid>
              </condition>
              <condition>
                <macro>{#IFOPERSTATUS}</macro>
                <value>{$NET.IF.IFOPERSTATUS.NOT_MATCHES}</value>
                <operator>NOT_MATCHES_REGEX</operator>
                <formulaid>H</formulaid>
              </condition>
              <condition>
                <macro>{#IFNAME}</macro>
                <value>{$NET.IF.IFNAME.MATCHES}</value>
                <formulaid>E</formulaid>
              </condition>
              <condition>
                <macro>{#IFNAME}</macro>
                <value>{$NET.IF.IFNAME.NOT_MATCHES}</value>
                <operator>NOT_MATCHES_REGEX</operator>
                <formulaid>F</formulaid>
              </condition>
              <condition>
                <macro>{#IFDESCR}</macro>
                <value>{$NET.IF.IFDESCR.MATCHES}</value>
                <formulaid>C</formulaid>
              </condition>
              <condition>
                <macro>{#IFDESCR}</macro>
                <value>{$NET.IF.IFDESCR.NOT_MATCHES}</value>
                <operator>NOT_MATCHES_REGEX</operator>
                <formulaid>D</formulaid>
              </condition>
              <condition>
                <macro>{#IFTYPE}</macro>
                <value>{$NET.IF.IFTYPE.MATCHES}</value>
                <formulaid>I</formulaid>
              </condition>
              <condition>
                <macro>{#IFTYPE}</macro>
                <value>{$NET.IF.IFTYPE.NOT_MATCHES}</value>
                <operator>NOT_MATCHES_REGEX</operator>
                <formulaid>J</formulaid>
              </condition>
            </conditions>
          </filter>
          <description>Discovering interfaces from IF-MIB.</description>
          <item_prototypes>
            <item_prototype>
              <name>Interface {#IFDESCR}: Inbound packets discarded</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}</snmp_oid>
              <key>net.if.in.discards[ifInDiscards.{#SNMPINDEX}]</key>
              <delay>3m</delay>
              <history>7d</history>
              <description>MIB: IF-MIB The number of inbound packets which were chosen to be discarded even though no errors had been detected to prevent their being deliverable to a higher-layer protocol. One possible reason for discarding such a packet could be to free up buffer space. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFDESCR}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Interface {#IFDESCR}: Inbound packets with errors</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}</snmp_oid>
              <key>net.if.in.errors[ifInErrors.{#SNMPINDEX}]</key>
              <delay>3m</delay>
              <history>7d</history>
              <description>MIB: IF-MIB For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol. For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFDESCR}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Interface {#IFDESCR}: Bits received</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}</snmp_oid>
              <key>net.if.in[ifInOctets.{#SNMPINDEX}]</key>
              <delay>3m</delay>
              <history>7d</history>
              <units>bps</units>
              <description>MIB: IF-MIB The total number of octets received on the interface,including framing characters. Discontinuities in the value of this counter can occurat re-initialization of the management system, and atother times as indicated by the value of ifCounterDiscontinuityTime.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFDESCR}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Interface {#IFDESCR}: Outbound packets discarded</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}</snmp_oid>
              <key>net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]</key>
              <delay>3m</delay>
              <history>7d</history>
              <description>MIB: IF-MIB The number of outbound packets which were chosen to be discarded even though no errors had been detected to prevent their being deliverable to a higher-layer protocol. One possible reason for discarding such a packet could be to free up buffer space. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFDESCR}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Interface {#IFDESCR}: Outbound packets with errors</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}</snmp_oid>
              <key>net.if.out.errors[ifOutErrors.{#SNMPINDEX}]</key>
              <delay>3m</delay>
              <history>7d</history>
              <description>MIB: IF-MIB For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol. For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFDESCR}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Interface {#IFDESCR}: Bits sent</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}</snmp_oid>
              <key>net.if.out[ifOutOctets.{#SNMPINDEX}]</key>
              <delay>3m</delay>
              <history>7d</history>
              <units>bps</units>
              <description>MIB: IF-MIB The total number of octets transmitted out of the interface, including framing characters. Discontinuities in the value of this counter can occurat re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFDESCR}</name>
                </application_prototype>
              </application_prototypes>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Interface {#IFDESCR}: Speed</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}</snmp_oid>
              <key>net.if.speed[ifSpeed.{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <history>7d</history>
              <trends>0d</trends>
              <units>bps</units>
              <description>MIB: IF-MIB An estimate of the interface's current bandwidth in bits per second. For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. If the bandwidth of the interface is greater than the maximum value reportable by this object then this object should report its maximum value (4,294,967,295) and ifHighSpeed must be used to report the interace's speed. For a sub-layer which has no concept of bandwidth, this object should be zero.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFDESCR}</name>
                </application_prototype>
              </application_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Interface {#IFDESCR}: Operational status</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}</snmp_oid>
              <key>net.if.status[ifOperStatus.{#SNMPINDEX}]</key>
              <history>7d</history>
              <trends>0</trends>
              <description>MIB: IF-MIB The current operational state of the interface. - The testing(3) state indicates that no operational packet scan be passed - If ifAdminStatus is down(2) then ifOperStatus should be down(2) - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection) - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFDESCR}</name>
                </application_prototype>
              </application_prototypes>
              <valuemap>
                <name>IF-MIB::ifOperStatus</name>
              </valuemap>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{$IFCONTROL:"{#IFNAME}"}=1 and ({last()}=2 and {diff()}=1)</expression>
                  <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                  <recovery_expression>{last()}&lt;>2 or {$IFCONTROL:"{#IFNAME}"}=0</recovery_expression>
                  <name>Interface {#IFDESCR}: Link down</name>
                  <opdata>Current state: {ITEM.LASTVALUE1}</opdata>
                  <priority>AVERAGE</priority>
                  <description>This trigger expression works as follows: 1. Can be triggered if operations status is down. 2. {$IFCONTROL:"{#IFNAME}"}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down. 3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.) WARNING: if closed manually - won't fire again on next poll, because of .diff.</description>
                  <manual_close>YES</manual_close>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Interface {#IFDESCR}: Interface type</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}</snmp_oid>
              <key>net.if.type[ifType.{#SNMPINDEX}]</key>
              <delay>1h</delay>
              <history>7d</history>
              <trends>0d</trends>
              <description>MIB: IF-MIB The type of interface. Additional values for ifType are assigned by the Internet Assigned NumbersAuthority (IANA), through updating the syntax of the IANAifType textual convention.</description>
              <application_prototypes>
                <application_prototype>
                  <name>Interface {#IFDESCR}</name>
                </application_prototype>
              </application_prototypes>
              <valuemap>
                <name>IF-MIB::ifType</name>
              </valuemap>
              <preprocessing>
                <step>
                  <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                  <params>1d</params>
                </step>
              </preprocessing>
            </item_prototype>
          </item_prototypes>
          <trigger_prototypes>
            <trigger_prototype>
              <expression>{Template Module Interfaces Simple SNMP:net.if.speed[ifSpeed.{#SNMPINDEX}].change()}&lt;0 and {Template Module Interfaces Simple SNMP:net.if.speed[ifSpeed.{#SNMPINDEX}].last()}>0 and ( {Template Module Interfaces Simple SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=6 or {Template Module Interfaces Simple SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=7 or {Template Module Interfaces Simple SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=11 or {Template Module Interfaces Simple SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=62 or {Template Module Interfaces Simple SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=69 or {Template Module Interfaces Simple SNMP:net.if.type[ifType.{#SNMPINDEX}].last()}=117 ) and ({Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}&lt;>2)</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>({Template Module Interfaces Simple SNMP:net.if.speed[ifSpeed.{#SNMPINDEX}].change()}>0 and {Template Module Interfaces Simple SNMP:net.if.speed[ifSpeed.{#SNMPINDEX}].prev()}>0) or ({Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2)</recovery_expression>
              <name>Interface {#IFDESCR}: Ethernet has changed to lower speed than it was before</name>
              <opdata>Current reported speed: {ITEM.LASTVALUE1}</opdata>
              <priority>INFO</priority>
              <description>This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.</description>
              <manual_close>YES</manual_close>
              <dependencies>
                <dependency>
                  <name>Interface {#IFDESCR}: Link down</name>
                  <expression>{$IFCONTROL:"{#IFNAME}"}=1 and ({Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2 and {Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].diff()}=1)</expression>
                  <recovery_expression>{Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}&lt;>2 or {$IFCONTROL:"{#IFNAME}"}=0</recovery_expression>
                </dependency>
              </dependencies>
            </trigger_prototype>
            <trigger_prototype>
              <expression>({Template Module Interfaces Simple SNMP:net.if.in[ifInOctets.{#SNMPINDEX}].avg(15m)}>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*{Template Module Interfaces Simple SNMP:net.if.speed[ifSpeed.{#SNMPINDEX}].last()} or {Template Module Interfaces Simple SNMP:net.if.out[ifOutOctets.{#SNMPINDEX}].avg(15m)}>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*{Template Module Interfaces Simple SNMP:net.if.speed[ifSpeed.{#SNMPINDEX}].last()}) and {Template Module Interfaces Simple SNMP:net.if.speed[ifSpeed.{#SNMPINDEX}].last()}>0</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{Template Module Interfaces Simple SNMP:net.if.in[ifInOctets.{#SNMPINDEX}].avg(15m)}&lt;(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*{Template Module Interfaces Simple SNMP:net.if.speed[ifSpeed.{#SNMPINDEX}].last()} and {Template Module Interfaces Simple SNMP:net.if.out[ifOutOctets.{#SNMPINDEX}].avg(15m)}&lt;(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*{Template Module Interfaces Simple SNMP:net.if.speed[ifSpeed.{#SNMPINDEX}].last()}</recovery_expression>
              <name>Interface {#IFDESCR}: High bandwidth usage (> {$IF.UTIL.MAX:"{#IFNAME}"}% )</name>
              <opdata>In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}</opdata>
              <priority>WARNING</priority>
              <description>The network interface utilization is close to its estimated maximum bandwidth.</description>
              <manual_close>YES</manual_close>
              <dependencies>
                <dependency>
                  <name>Interface {#IFDESCR}: Link down</name>
                  <expression>{$IFCONTROL:"{#IFNAME}"}=1 and ({Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2 and {Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].diff()}=1)</expression>
                  <recovery_expression>{Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}&lt;>2 or {$IFCONTROL:"{#IFNAME}"}=0</recovery_expression>
                </dependency>
              </dependencies>
            </trigger_prototype>
            <trigger_prototype>
              <expression>{Template Module Interfaces Simple SNMP:net.if.in.errors[ifInErrors.{#SNMPINDEX}].min(5m)}>{$IF.ERRORS.WARN:"{#IFNAME}"} or {Template Module Interfaces Simple SNMP:net.if.out.errors[ifOutErrors.{#SNMPINDEX}].min(5m)}>{$IF.ERRORS.WARN:"{#IFNAME}"}</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{Template Module Interfaces Simple SNMP:net.if.in.errors[ifInErrors.{#SNMPINDEX}].max(5m)}&lt;{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8 and {Template Module Interfaces Simple SNMP:net.if.out.errors[ifOutErrors.{#SNMPINDEX}].max(5m)}&lt;{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8</recovery_expression>
              <name>Interface {#IFDESCR}: High error rate (> {$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)</name>
              <opdata>errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}</opdata>
              <priority>WARNING</priority>
              <description>Recovers when below 80% of {$IF.ERRORS.WARN:"{#IFNAME}"} threshold</description>
              <manual_close>YES</manual_close>
              <dependencies>
                <dependency>
                  <name>Interface {#IFDESCR}: Link down</name>
                  <expression>{$IFCONTROL:"{#IFNAME}"}=1 and ({Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2 and {Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].diff()}=1)</expression>
                  <recovery_expression>{Template Module Interfaces Simple SNMP:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}&lt;>2 or {$IFCONTROL:"{#IFNAME}"}=0</recovery_expression>
                </dependency>
              </dependencies>
            </trigger_prototype>
          </trigger_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>Interface {#IFDESCR}: Network traffic</name>
              <graph_items>
                <graph_item>
                  <drawtype>GRADIENT_LINE</drawtype>
                  <color>1A7C11</color>
                  <item>
                    <host>Template Module Interfaces Simple SNMP</host>
                    <key>net.if.in[ifInOctets.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <drawtype>BOLD_LINE</drawtype>
                  <color>2774A4</color>
                  <item>
                    <host>Template Module Interfaces Simple SNMP</host>
                    <key>net.if.out[ifOutOctets.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>2</sortorder>
                  <color>F63100</color>
                  <yaxisside>RIGHT</yaxisside>
                  <item>
                    <host>Template Module Interfaces Simple SNMP</host>
                    <key>net.if.out.errors[ifOutErrors.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>3</sortorder>
                  <color>A54F10</color>
                  <yaxisside>RIGHT</yaxisside>
                  <item>
                    <host>Template Module Interfaces Simple SNMP</host>
                    <key>net.if.in.errors[ifInErrors.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>4</sortorder>
                  <color>FC6EA3</color>
                  <yaxisside>RIGHT</yaxisside>
                  <item>
                    <host>Template Module Interfaces Simple SNMP</host>
                    <key>net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>5</sortorder>
                  <color>6C59DC</color>
                  <yaxisside>RIGHT</yaxisside>
                  <item>
                    <host>Template Module Interfaces Simple SNMP</host>
                    <key>net.if.in.discards[ifInDiscards.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
      </discovery_rules>
      <macros>
        <macro>
          <macro>{$IF.ERRORS.WARN}</macro>
          <value>2</value>
        </macro>
        <macro>
          <macro>{$IF.UTIL.MAX}</macro>
          <value>95</value>
        </macro>
        <macro>
          <macro>{$IFCONTROL}</macro>
          <value>1</value>
        </macro>
        <macro>
          <macro>{$NET.IF.IFADMINSTATUS.MATCHES}</macro>
          <value>^.*</value>
          <description>Ignore notPresent(6)</description>
        </macro>
        <macro>
          <macro>{$NET.IF.IFADMINSTATUS.NOT_MATCHES}</macro>
          <value>^2$</value>
          <description>Ignore down(2) administrative status</description>
        </macro>
        <macro>
          <macro>{$NET.IF.IFDESCR.MATCHES}</macro>
          <value>.*</value>
        </macro>
        <macro>
          <macro>{$NET.IF.IFDESCR.NOT_MATCHES}</macro>
          <value>CHANGE_IF_NEEDED</value>
        </macro>
        <macro>
          <macro>{$NET.IF.IFNAME.MATCHES}</macro>
          <value>^.*$</value>
        </macro>
        <macro>
          <macro>{$NET.IF.IFNAME.NOT_MATCHES}</macro>
          <value>(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})</value>
          <description>Filter out loopbacks, nulls, docker veth links and docker0 bridge by default</description>
        </macro>
        <macro>
          <macro>{$NET.IF.IFOPERSTATUS.MATCHES}</macro>
          <value>^.*$</value>
        </macro>
        <macro>
          <macro>{$NET.IF.IFOPERSTATUS.NOT_MATCHES}</macro>
          <value>^6$</value>
          <description>Ignore notPresent(6)</description>
        </macro>
        <macro>
          <macro>{$NET.IF.IFTYPE.MATCHES}</macro>
          <value>.*</value>
        </macro>
        <macro>
          <macro>{$NET.IF.IFTYPE.NOT_MATCHES}</macro>
          <value>CHANGE_IF_NEEDED</value>
        </macro>
      </macros>
      <screens>
        <screen>
          <name>Network interfaces</name>
          <hsize>1</hsize>
          <vsize>1</vsize>
          <screen_items>
            <screen_item>
              <resourcetype>20</resourcetype>
              <style>0</style>
              <resource>
                <name>Interface {#IFDESCR}: Network traffic</name>
                <host>Template Module Interfaces Simple SNMP</host>
              </resource>
              <width>500</width>
              <height>100</height>
              <x>0</x>
              <y>0</y>
              <colspan>1</colspan>
              <rowspan>1</rowspan>
              <elements>25</elements>
              <valign>0</valign>
              <halign>0</halign>
              <dynamic>0</dynamic>
              <sort_triggers>0</sort_triggers>
              <url></url>
              <application></application>
              <max_columns>3</max_columns>
            </screen_item>
          </screen_items>
        </screen>
      </screens>
    </template>
    <template>
      <template>Template Net Network Generic Device SNMP</template>
      <name>Template Net Network Generic Device SNMP</name>
      <description>Template Net Network Generic Device Template tooling version used: 0.36</description>
      <templates>
        <template>
          <name>Template Module EtherLike-MIB SNMP</name>
        </template>
        <template>
          <name>Template Module Generic SNMP</name>
        </template>
        <template>
          <name>Template Module Interfaces Simple SNMP</name>
        </template>
      </templates>
      <groups>
        <group>
          <name>Templates/Network devices</name>
        </group>
      </groups>
    </template>
  </templates>
  <triggers>
    <trigger>
      <expression>{PABX-TRAPS:snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2346].str(2346)}=1 or {PABX-TRAPS:snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2349].str(2349)}=1</expression>
      <name>{HOSTNAME} - Bascul command called</name>
      <priority>INFO</priority>
      <description>{HOSTNAME} - {ITEM.VALUE}</description>
      <type>MULTIPLE</type>
      <manual_close>YES</manual_close>
    </trigger>
    <trigger>
      <expression>{PABX-TRAPS:snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2255].str(2255)}=1 or {PABX-TRAPS:snmptrap[637\.64\.0\.10\.1\.1\.8.*:*2650].str(2650)}=1</expression>
      <name>{HOSTNAME} - SQL error</name>
      <priority>WARNING</priority>
      <description>SQL error: {ITEM.VALUE}</description>
      <type>MULTIPLE</type>
      <manual_close>YES</manual_close>
    </trigger>
  </triggers>
  <value_maps>
    <value_map>
      <name>EtherLike-MIB::dot3StatsDuplexStatus</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>unknown</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>halfDuplex</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>fullDuplex</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>IF-MIB::ifOperStatus</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>up</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>down</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>unknown</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>dormant</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>notPresent</newvalue>
        </mapping>
        <mapping>
          <value>7</value>
          <newvalue>lowerLayerDown</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>IF-MIB::ifType</name>
      <mappings>
        <mapping>
          <value>1</value>
          <newvalue>other</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>regular1822</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>hdh1822</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>ddnX25</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>rfc877x25</newvalue>
        </mapping>
        <mapping>
          <value>6</value>
          <newvalue>ethernetCsmacd</newvalue>
        </mapping>
        <mapping>
          <value>7</value>
          <newvalue>iso88023Csmacd</newvalue>
        </mapping>
        <mapping>
          <value>8</value>
          <newvalue>iso88024TokenBus</newvalue>
        </mapping>
        <mapping>
          <value>9</value>
          <newvalue>iso88025TokenRing</newvalue>
        </mapping>
        <mapping>
          <value>10</value>
          <newvalue>iso88026Man</newvalue>
        </mapping>
        <mapping>
          <value>11</value>
          <newvalue>starLan</newvalue>
        </mapping>
        <mapping>
          <value>12</value>
          <newvalue>proteon10Mbit</newvalue>
        </mapping>
        <mapping>
          <value>13</value>
          <newvalue>proteon80Mbit</newvalue>
        </mapping>
        <mapping>
          <value>14</value>
          <newvalue>hyperchannel</newvalue>
        </mapping>
        <mapping>
          <value>15</value>
          <newvalue>fddi</newvalue>
        </mapping>
        <mapping>
          <value>16</value>
          <newvalue>lapb</newvalue>
        </mapping>
        <mapping>
          <value>17</value>
          <newvalue>sdlc</newvalue>
        </mapping>
        <mapping>
          <value>18</value>
          <newvalue>ds1</newvalue>
        </mapping>
        <mapping>
          <value>19</value>
          <newvalue>e1</newvalue>
        </mapping>
        <mapping>
          <value>20</value>
          <newvalue>basicISDN</newvalue>
        </mapping>
        <mapping>
          <value>21</value>
          <newvalue>primaryISDN</newvalue>
        </mapping>
        <mapping>
          <value>22</value>
          <newvalue>propPointToPointSerial</newvalue>
        </mapping>
        <mapping>
          <value>23</value>
          <newvalue>ppp</newvalue>
        </mapping>
        <mapping>
          <value>24</value>
          <newvalue>softwareLoopback</newvalue>
        </mapping>
        <mapping>
          <value>25</value>
          <newvalue>eon</newvalue>
        </mapping>
        <mapping>
          <value>26</value>
          <newvalue>ethernet3Mbit</newvalue>
        </mapping>
        <mapping>
          <value>27</value>
          <newvalue>nsip</newvalue>
        </mapping>
        <mapping>
          <value>28</value>
          <newvalue>slip</newvalue>
        </mapping>
        <mapping>
          <value>29</value>
          <newvalue>ultra</newvalue>
        </mapping>
        <mapping>
          <value>30</value>
          <newvalue>ds3</newvalue>
        </mapping>
        <mapping>
          <value>31</value>
          <newvalue>sip</newvalue>
        </mapping>
        <mapping>
          <value>32</value>
          <newvalue>frameRelay</newvalue>
        </mapping>
        <mapping>
          <value>33</value>
          <newvalue>rs232</newvalue>
        </mapping>
        <mapping>
          <value>34</value>
          <newvalue>para</newvalue>
        </mapping>
        <mapping>
          <value>35</value>
          <newvalue>arcnet</newvalue>
        </mapping>
        <mapping>
          <value>36</value>
          <newvalue>arcnetPlus</newvalue>
        </mapping>
        <mapping>
          <value>37</value>
          <newvalue>atm</newvalue>
        </mapping>
        <mapping>
          <value>38</value>
          <newvalue>miox25</newvalue>
        </mapping>
        <mapping>
          <value>39</value>
          <newvalue>sonet</newvalue>
        </mapping>
        <mapping>
          <value>40</value>
          <newvalue>x25ple</newvalue>
        </mapping>
        <mapping>
          <value>41</value>
          <newvalue>iso88022llc</newvalue>
        </mapping>
        <mapping>
          <value>42</value>
          <newvalue>localTalk</newvalue>
        </mapping>
        <mapping>
          <value>43</value>
          <newvalue>smdsDxi</newvalue>
        </mapping>
        <mapping>
          <value>44</value>
          <newvalue>frameRelayService</newvalue>
        </mapping>
        <mapping>
          <value>45</value>
          <newvalue>v35</newvalue>
        </mapping>
        <mapping>
          <value>46</value>
          <newvalue>hssi</newvalue>
        </mapping>
        <mapping>
          <value>47</value>
          <newvalue>hippi</newvalue>
        </mapping>
        <mapping>
          <value>48</value>
          <newvalue>modem</newvalue>
        </mapping>
        <mapping>
          <value>49</value>
          <newvalue>aal5</newvalue>
        </mapping>
        <mapping>
          <value>50</value>
          <newvalue>sonetPath</newvalue>
        </mapping>
        <mapping>
          <value>51</value>
          <newvalue>sonetVT</newvalue>
        </mapping>
        <mapping>
          <value>52</value>
          <newvalue>smdsIcip</newvalue>
        </mapping>
        <mapping>
          <value>53</value>
          <newvalue>propVirtual</newvalue>
        </mapping>
        <mapping>
          <value>54</value>
          <newvalue>propMultiplexor</newvalue>
        </mapping>
        <mapping>
          <value>55</value>
          <newvalue>ieee80212</newvalue>
        </mapping>
        <mapping>
          <value>56</value>
          <newvalue>fibreChannel</newvalue>
        </mapping>
        <mapping>
          <value>57</value>
          <newvalue>hippiInterface</newvalue>
        </mapping>
        <mapping>
          <value>58</value>
          <newvalue>frameRelayInterconnect</newvalue>
        </mapping>
        <mapping>
          <value>59</value>
          <newvalue>aflane8023</newvalue>
        </mapping>
        <mapping>
          <value>60</value>
          <newvalue>aflane8025</newvalue>
        </mapping>
        <mapping>
          <value>61</value>
          <newvalue>cctEmul</newvalue>
        </mapping>
        <mapping>
          <value>62</value>
          <newvalue>fastEther</newvalue>
        </mapping>
        <mapping>
          <value>63</value>
          <newvalue>isdn</newvalue>
        </mapping>
        <mapping>
          <value>64</value>
          <newvalue>v11</newvalue>
        </mapping>
        <mapping>
          <value>65</value>
          <newvalue>v36</newvalue>
        </mapping>
        <mapping>
          <value>66</value>
          <newvalue>g703at64k</newvalue>
        </mapping>
        <mapping>
          <value>67</value>
          <newvalue>g703at2mb</newvalue>
        </mapping>
        <mapping>
          <value>68</value>
          <newvalue>qllc</newvalue>
        </mapping>
        <mapping>
          <value>69</value>
          <newvalue>fastEtherFX</newvalue>
        </mapping>
        <mapping>
          <value>70</value>
          <newvalue>channel</newvalue>
        </mapping>
        <mapping>
          <value>71</value>
          <newvalue>ieee80211</newvalue>
        </mapping>
        <mapping>
          <value>72</value>
          <newvalue>ibm370parChan</newvalue>
        </mapping>
        <mapping>
          <value>73</value>
          <newvalue>escon</newvalue>
        </mapping>
        <mapping>
          <value>74</value>
          <newvalue>dlsw</newvalue>
        </mapping>
        <mapping>
          <value>75</value>
          <newvalue>isdns</newvalue>
        </mapping>
        <mapping>
          <value>76</value>
          <newvalue>isdnu</newvalue>
        </mapping>
        <mapping>
          <value>77</value>
          <newvalue>lapd</newvalue>
        </mapping>
        <mapping>
          <value>78</value>
          <newvalue>ipSwitch</newvalue>
        </mapping>
        <mapping>
          <value>79</value>
          <newvalue>rsrb</newvalue>
        </mapping>
        <mapping>
          <value>80</value>
          <newvalue>atmLogical</newvalue>
        </mapping>
        <mapping>
          <value>81</value>
          <newvalue>ds0</newvalue>
        </mapping>
        <mapping>
          <value>82</value>
          <newvalue>ds0Bundle</newvalue>
        </mapping>
        <mapping>
          <value>83</value>
          <newvalue>bsc</newvalue>
        </mapping>
        <mapping>
          <value>84</value>
          <newvalue>async</newvalue>
        </mapping>
        <mapping>
          <value>85</value>
          <newvalue>cnr</newvalue>
        </mapping>
        <mapping>
          <value>86</value>
          <newvalue>iso88025Dtr</newvalue>
        </mapping>
        <mapping>
          <value>87</value>
          <newvalue>eplrs</newvalue>
        </mapping>
        <mapping>
          <value>88</value>
          <newvalue>arap</newvalue>
        </mapping>
        <mapping>
          <value>89</value>
          <newvalue>propCnls</newvalue>
        </mapping>
        <mapping>
          <value>90</value>
          <newvalue>hostPad</newvalue>
        </mapping>
        <mapping>
          <value>91</value>
          <newvalue>termPad</newvalue>
        </mapping>
        <mapping>
          <value>92</value>
          <newvalue>frameRelayMPI</newvalue>
        </mapping>
        <mapping>
          <value>93</value>
          <newvalue>x213</newvalue>
        </mapping>
        <mapping>
          <value>94</value>
          <newvalue>adsl</newvalue>
        </mapping>
        <mapping>
          <value>95</value>
          <newvalue>radsl</newvalue>
        </mapping>
        <mapping>
          <value>96</value>
          <newvalue>sdsl</newvalue>
        </mapping>
        <mapping>
          <value>97</value>
          <newvalue>vdsl</newvalue>
        </mapping>
        <mapping>
          <value>98</value>
          <newvalue>iso88025CRFPInt</newvalue>
        </mapping>
        <mapping>
          <value>99</value>
          <newvalue>myrinet</newvalue>
        </mapping>
        <mapping>
          <value>100</value>
          <newvalue>voiceEM</newvalue>
        </mapping>
        <mapping>
          <value>101</value>
          <newvalue>voiceFXO</newvalue>
        </mapping>
        <mapping>
          <value>102</value>
          <newvalue>voiceFXS</newvalue>
        </mapping>
        <mapping>
          <value>103</value>
          <newvalue>voiceEncap</newvalue>
        </mapping>
        <mapping>
          <value>104</value>
          <newvalue>voiceOverIp</newvalue>
        </mapping>
        <mapping>
          <value>105</value>
          <newvalue>atmDxi</newvalue>
        </mapping>
        <mapping>
          <value>106</value>
          <newvalue>atmFuni</newvalue>
        </mapping>
        <mapping>
          <value>107</value>
          <newvalue>atmIma</newvalue>
        </mapping>
        <mapping>
          <value>108</value>
          <newvalue>pppMultilinkBundle</newvalue>
        </mapping>
        <mapping>
          <value>109</value>
          <newvalue>ipOverCdlc</newvalue>
        </mapping>
        <mapping>
          <value>110</value>
          <newvalue>ipOverClaw</newvalue>
        </mapping>
        <mapping>
          <value>111</value>
          <newvalue>stackToStack</newvalue>
        </mapping>
        <mapping>
          <value>112</value>
          <newvalue>virtualIpAddress</newvalue>
        </mapping>
        <mapping>
          <value>113</value>
          <newvalue>mpc</newvalue>
        </mapping>
        <mapping>
          <value>114</value>
          <newvalue>ipOverAtm</newvalue>
        </mapping>
        <mapping>
          <value>115</value>
          <newvalue>iso88025Fiber</newvalue>
        </mapping>
        <mapping>
          <value>116</value>
          <newvalue>tdlc</newvalue>
        </mapping>
        <mapping>
          <value>117</value>
          <newvalue>gigabitEthernet</newvalue>
        </mapping>
        <mapping>
          <value>118</value>
          <newvalue>hdlc</newvalue>
        </mapping>
        <mapping>
          <value>119</value>
          <newvalue>lapf</newvalue>
        </mapping>
        <mapping>
          <value>120</value>
          <newvalue>v37</newvalue>
        </mapping>
        <mapping>
          <value>121</value>
          <newvalue>x25mlp</newvalue>
        </mapping>
        <mapping>
          <value>122</value>
          <newvalue>x25huntGroup</newvalue>
        </mapping>
        <mapping>
          <value>123</value>
          <newvalue>trasnpHdlc</newvalue>
        </mapping>
        <mapping>
          <value>124</value>
          <newvalue>interleave</newvalue>
        </mapping>
        <mapping>
          <value>125</value>
          <newvalue>fast</newvalue>
        </mapping>
        <mapping>
          <value>126</value>
          <newvalue>ip</newvalue>
        </mapping>
        <mapping>
          <value>127</value>
          <newvalue>docsCableMaclayer</newvalue>
        </mapping>
        <mapping>
          <value>128</value>
          <newvalue>docsCableDownstream</newvalue>
        </mapping>
        <mapping>
          <value>129</value>
          <newvalue>docsCableUpstream</newvalue>
        </mapping>
        <mapping>
          <value>130</value>
          <newvalue>a12MppSwitch</newvalue>
        </mapping>
        <mapping>
          <value>131</value>
          <newvalue>tunnel</newvalue>
        </mapping>
        <mapping>
          <value>132</value>
          <newvalue>coffee</newvalue>
        </mapping>
        <mapping>
          <value>133</value>
          <newvalue>ces</newvalue>
        </mapping>
        <mapping>
          <value>134</value>
          <newvalue>atmSubInterface</newvalue>
        </mapping>
        <mapping>
          <value>135</value>
          <newvalue>l2vlan</newvalue>
        </mapping>
        <mapping>
          <value>136</value>
          <newvalue>l3ipvlan</newvalue>
        </mapping>
        <mapping>
          <value>137</value>
          <newvalue>l3ipxvlan</newvalue>
        </mapping>
        <mapping>
          <value>138</value>
          <newvalue>digitalPowerline</newvalue>
        </mapping>
        <mapping>
          <value>139</value>
          <newvalue>mediaMailOverIp</newvalue>
        </mapping>
        <mapping>
          <value>140</value>
          <newvalue>dtm</newvalue>
        </mapping>
        <mapping>
          <value>141</value>
          <newvalue>dcn</newvalue>
        </mapping>
        <mapping>
          <value>142</value>
          <newvalue>ipForward</newvalue>
        </mapping>
        <mapping>
          <value>143</value>
          <newvalue>msdsl</newvalue>
        </mapping>
        <mapping>
          <value>144</value>
          <newvalue>ieee1394</newvalue>
        </mapping>
        <mapping>
          <value>145</value>
          <newvalue>if-gsn</newvalue>
        </mapping>
        <mapping>
          <value>146</value>
          <newvalue>dvbRccMacLayer</newvalue>
        </mapping>
        <mapping>
          <value>147</value>
          <newvalue>dvbRccDownstream</newvalue>
        </mapping>
        <mapping>
          <value>148</value>
          <newvalue>dvbRccUpstream</newvalue>
        </mapping>
        <mapping>
          <value>149</value>
          <newvalue>atmVirtual</newvalue>
        </mapping>
        <mapping>
          <value>150</value>
          <newvalue>mplsTunnel</newvalue>
        </mapping>
        <mapping>
          <value>151</value>
          <newvalue>srp</newvalue>
        </mapping>
        <mapping>
          <value>152</value>
          <newvalue>voiceOverAtm</newvalue>
        </mapping>
        <mapping>
          <value>153</value>
          <newvalue>voiceOverFrameRelay</newvalue>
        </mapping>
        <mapping>
          <value>154</value>
          <newvalue>idsl</newvalue>
        </mapping>
        <mapping>
          <value>155</value>
          <newvalue>compositeLink</newvalue>
        </mapping>
        <mapping>
          <value>156</value>
          <newvalue>ss7SigLink</newvalue>
        </mapping>
        <mapping>
          <value>157</value>
          <newvalue>propWirelessP2P</newvalue>
        </mapping>
        <mapping>
          <value>158</value>
          <newvalue>frForward</newvalue>
        </mapping>
        <mapping>
          <value>159</value>
          <newvalue>rfc1483</newvalue>
        </mapping>
        <mapping>
          <value>160</value>
          <newvalue>usb</newvalue>
        </mapping>
        <mapping>
          <value>161</value>
          <newvalue>ieee8023adLag</newvalue>
        </mapping>
        <mapping>
          <value>162</value>
          <newvalue>bgppolicyaccounting</newvalue>
        </mapping>
        <mapping>
          <value>163</value>
          <newvalue>frf16MfrBundle</newvalue>
        </mapping>
        <mapping>
          <value>164</value>
          <newvalue>h323Gatekeeper</newvalue>
        </mapping>
        <mapping>
          <value>165</value>
          <newvalue>h323Proxy</newvalue>
        </mapping>
        <mapping>
          <value>166</value>
          <newvalue>mpls</newvalue>
        </mapping>
        <mapping>
          <value>167</value>
          <newvalue>mfSigLink</newvalue>
        </mapping>
        <mapping>
          <value>168</value>
          <newvalue>hdsl2</newvalue>
        </mapping>
        <mapping>
          <value>169</value>
          <newvalue>shdsl</newvalue>
        </mapping>
        <mapping>
          <value>170</value>
          <newvalue>ds1FDL</newvalue>
        </mapping>
        <mapping>
          <value>171</value>
          <newvalue>pos</newvalue>
        </mapping>
        <mapping>
          <value>172</value>
          <newvalue>dvbAsiIn</newvalue>
        </mapping>
        <mapping>
          <value>173</value>
          <newvalue>dvbAsiOut</newvalue>
        </mapping>
        <mapping>
          <value>174</value>
          <newvalue>plc</newvalue>
        </mapping>
        <mapping>
          <value>175</value>
          <newvalue>nfas</newvalue>
        </mapping>
        <mapping>
          <value>176</value>
          <newvalue>tr008</newvalue>
        </mapping>
        <mapping>
          <value>177</value>
          <newvalue>gr303RDT</newvalue>
        </mapping>
        <mapping>
          <value>178</value>
          <newvalue>gr303IDT</newvalue>
        </mapping>
        <mapping>
          <value>179</value>
          <newvalue>isup</newvalue>
        </mapping>
        <mapping>
          <value>180</value>
          <newvalue>propDocsWirelessMaclayer</newvalue>
        </mapping>
        <mapping>
          <value>181</value>
          <newvalue>propDocsWirelessDownstream</newvalue>
        </mapping>
        <mapping>
          <value>182</value>
          <newvalue>propDocsWirelessUpstream</newvalue>
        </mapping>
        <mapping>
          <value>183</value>
          <newvalue>hiperlan2</newvalue>
        </mapping>
        <mapping>
          <value>184</value>
          <newvalue>propBWAp2Mp</newvalue>
        </mapping>
        <mapping>
          <value>185</value>
          <newvalue>sonetOverheadChannel</newvalue>
        </mapping>
        <mapping>
          <value>186</value>
          <newvalue>digitalWrapperOverheadChannel</newvalue>
        </mapping>
        <mapping>
          <value>187</value>
          <newvalue>aal2</newvalue>
        </mapping>
        <mapping>
          <value>188</value>
          <newvalue>radioMAC</newvalue>
        </mapping>
        <mapping>
          <value>189</value>
          <newvalue>atmRadio</newvalue>
        </mapping>
        <mapping>
          <value>190</value>
          <newvalue>imt</newvalue>
        </mapping>
        <mapping>
          <value>191</value>
          <newvalue>mvl</newvalue>
        </mapping>
        <mapping>
          <value>192</value>
          <newvalue>reachDSL</newvalue>
        </mapping>
        <mapping>
          <value>193</value>
          <newvalue>frDlciEndPt</newvalue>
        </mapping>
        <mapping>
          <value>194</value>
          <newvalue>atmVciEndPt</newvalue>
        </mapping>
        <mapping>
          <value>195</value>
          <newvalue>opticalChannel</newvalue>
        </mapping>
        <mapping>
          <value>196</value>
          <newvalue>opticalTransport</newvalue>
        </mapping>
        <mapping>
          <value>197</value>
          <newvalue>propAtm</newvalue>
        </mapping>
        <mapping>
          <value>198</value>
          <newvalue>voiceOverCable</newvalue>
        </mapping>
        <mapping>
          <value>199</value>
          <newvalue>infiniband</newvalue>
        </mapping>
        <mapping>
          <value>200</value>
          <newvalue>teLink</newvalue>
        </mapping>
        <mapping>
          <value>201</value>
          <newvalue>q2931</newvalue>
        </mapping>
        <mapping>
          <value>202</value>
          <newvalue>virtualTg</newvalue>
        </mapping>
        <mapping>
          <value>203</value>
          <newvalue>sipTg</newvalue>
        </mapping>
        <mapping>
          <value>204</value>
          <newvalue>sipSig</newvalue>
        </mapping>
        <mapping>
          <value>205</value>
          <newvalue>docsCableUpstreamChannel</newvalue>
        </mapping>
        <mapping>
          <value>206</value>
          <newvalue>econet</newvalue>
        </mapping>
        <mapping>
          <value>207</value>
          <newvalue>pon155</newvalue>
        </mapping>
        <mapping>
          <value>208</value>
          <newvalue>pon622</newvalue>
        </mapping>
        <mapping>
          <value>209</value>
          <newvalue>bridge</newvalue>
        </mapping>
        <mapping>
          <value>210</value>
          <newvalue>linegroup</newvalue>
        </mapping>
        <mapping>
          <value>211</value>
          <newvalue>voiceEMFGD</newvalue>
        </mapping>
        <mapping>
          <value>212</value>
          <newvalue>voiceFGDEANA</newvalue>
        </mapping>
        <mapping>
          <value>213</value>
          <newvalue>voiceDID</newvalue>
        </mapping>
        <mapping>
          <value>214</value>
          <newvalue>mpegTransport</newvalue>
        </mapping>
        <mapping>
          <value>215</value>
          <newvalue>sixToFour</newvalue>
        </mapping>
        <mapping>
          <value>216</value>
          <newvalue>gtp</newvalue>
        </mapping>
        <mapping>
          <value>217</value>
          <newvalue>pdnEtherLoop1</newvalue>
        </mapping>
        <mapping>
          <value>218</value>
          <newvalue>pdnEtherLoop2</newvalue>
        </mapping>
        <mapping>
          <value>219</value>
          <newvalue>opticalChannelGroup</newvalue>
        </mapping>
        <mapping>
          <value>220</value>
          <newvalue>homepna</newvalue>
        </mapping>
        <mapping>
          <value>221</value>
          <newvalue>gfp</newvalue>
        </mapping>
        <mapping>
          <value>222</value>
          <newvalue>ciscoISLvlan</newvalue>
        </mapping>
        <mapping>
          <value>223</value>
          <newvalue>actelisMetaLOOP</newvalue>
        </mapping>
        <mapping>
          <value>224</value>
          <newvalue>fcipLink</newvalue>
        </mapping>
        <mapping>
          <value>225</value>
          <newvalue>rpr</newvalue>
        </mapping>
        <mapping>
          <value>226</value>
          <newvalue>qam</newvalue>
        </mapping>
        <mapping>
          <value>227</value>
          <newvalue>lmp</newvalue>
        </mapping>
        <mapping>
          <value>228</value>
          <newvalue>cblVectaStar</newvalue>
        </mapping>
        <mapping>
          <value>229</value>
          <newvalue>docsCableMCmtsDownstream</newvalue>
        </mapping>
        <mapping>
          <value>230</value>
          <newvalue>adsl2</newvalue>
        </mapping>
        <mapping>
          <value>231</value>
          <newvalue>macSecControlledIF</newvalue>
        </mapping>
        <mapping>
          <value>232</value>
          <newvalue>macSecUncontrolledIF</newvalue>
        </mapping>
        <mapping>
          <value>233</value>
          <newvalue>aviciOpticalEther</newvalue>
        </mapping>
        <mapping>
          <value>234</value>
          <newvalue>atmbond</newvalue>
        </mapping>
        <mapping>
          <value>235</value>
          <newvalue>voiceFGDOS</newvalue>
        </mapping>
        <mapping>
          <value>236</value>
          <newvalue>mocaVersion1</newvalue>
        </mapping>
        <mapping>
          <value>237</value>
          <newvalue>ieee80216WMAN</newvalue>
        </mapping>
        <mapping>
          <value>238</value>
          <newvalue>adsl2plus</newvalue>
        </mapping>
        <mapping>
          <value>239</value>
          <newvalue>dvbRcsMacLayer</newvalue>
        </mapping>
        <mapping>
          <value>240</value>
          <newvalue>dvbTdm</newvalue>
        </mapping>
        <mapping>
          <value>241</value>
          <newvalue>dvbRcsTdma</newvalue>
        </mapping>
        <mapping>
          <value>242</value>
          <newvalue>x86Laps</newvalue>
        </mapping>
        <mapping>
          <value>243</value>
          <newvalue>wwanPP</newvalue>
        </mapping>
        <mapping>
          <value>244</value>
          <newvalue>wwanPP2</newvalue>
        </mapping>
        <mapping>
          <value>245</value>
          <newvalue>voiceEBS</newvalue>
        </mapping>
        <mapping>
          <value>246</value>
          <newvalue>ifPwType</newvalue>
        </mapping>
        <mapping>
          <value>247</value>
          <newvalue>ilan</newvalue>
        </mapping>
        <mapping>
          <value>248</value>
          <newvalue>pip</newvalue>
        </mapping>
        <mapping>
          <value>249</value>
          <newvalue>aluELP</newvalue>
        </mapping>
        <mapping>
          <value>250</value>
          <newvalue>gpon</newvalue>
        </mapping>
        <mapping>
          <value>251</value>
          <newvalue>vdsl2</newvalue>
        </mapping>
        <mapping>
          <value>252</value>
          <newvalue>capwapDot11Profile</newvalue>
        </mapping>
        <mapping>
          <value>253</value>
          <newvalue>capwapDot11Bss</newvalue>
        </mapping>
        <mapping>
          <value>254</value>
          <newvalue>capwapWtpVirtualRadio</newvalue>
        </mapping>
        <mapping>
          <value>255</value>
          <newvalue>bits</newvalue>
        </mapping>
        <mapping>
          <value>256</value>
          <newvalue>docsCableUpstreamRfPort</newvalue>
        </mapping>
        <mapping>
          <value>257</value>
          <newvalue>cableDownstreamRfPort</newvalue>
        </mapping>
        <mapping>
          <value>258</value>
          <newvalue>vmwareVirtualNic</newvalue>
        </mapping>
        <mapping>
          <value>259</value>
          <newvalue>ieee802154</newvalue>
        </mapping>
        <mapping>
          <value>260</value>
          <newvalue>otnOdu</newvalue>
        </mapping>
        <mapping>
          <value>261</value>
          <newvalue>otnOtu</newvalue>
        </mapping>
        <mapping>
          <value>262</value>
          <newvalue>ifVfiType</newvalue>
        </mapping>
        <mapping>
          <value>263</value>
          <newvalue>g9981</newvalue>
        </mapping>
        <mapping>
          <value>264</value>
          <newvalue>g9982</newvalue>
        </mapping>
        <mapping>
          <value>265</value>
          <newvalue>g9983</newvalue>
        </mapping>
        <mapping>
          <value>266</value>
          <newvalue>aluEpon</newvalue>
        </mapping>
        <mapping>
          <value>267</value>
          <newvalue>aluEponOnu</newvalue>
        </mapping>
        <mapping>
          <value>268</value>
          <newvalue>aluEponPhysicalUni</newvalue>
        </mapping>
        <mapping>
          <value>269</value>
          <newvalue>aluEponLogicalLink</newvalue>
        </mapping>
        <mapping>
          <value>270</value>
          <newvalue>aluGponOnu</newvalue>
        </mapping>
        <mapping>
          <value>271</value>
          <newvalue>aluGponPhysicalUni</newvalue>
        </mapping>
        <mapping>
          <value>272</value>
          <newvalue>vmwareNicTeam</newvalue>
        </mapping>
        <mapping>
          <value>277</value>
          <newvalue>docsOfdmDownstream</newvalue>
        </mapping>
        <mapping>
          <value>278</value>
          <newvalue>docsOfdmaUpstream</newvalue>
        </mapping>
        <mapping>
          <value>279</value>
          <newvalue>gfast</newvalue>
        </mapping>
        <mapping>
          <value>280</value>
          <newvalue>sdci</newvalue>
        </mapping>
        <mapping>
          <value>281</value>
          <newvalue>xboxWireless</newvalue>
        </mapping>
        <mapping>
          <value>282</value>
          <newvalue>fastdsl</newvalue>
        </mapping>
        <mapping>
          <value>283</value>
          <newvalue>docsCableScte55d1FwdOob</newvalue>
        </mapping>
        <mapping>
          <value>284</value>
          <newvalue>docsCableScte55d1RetOob</newvalue>
        </mapping>
        <mapping>
          <value>285</value>
          <newvalue>docsCableScte55d2DsOob</newvalue>
        </mapping>
        <mapping>
          <value>286</value>
          <newvalue>docsCableScte55d2UsOob</newvalue>
        </mapping>
        <mapping>
          <value>287</value>
          <newvalue>docsCableNdf</newvalue>
        </mapping>
        <mapping>
          <value>288</value>
          <newvalue>docsCableNdr</newvalue>
        </mapping>
        <mapping>
          <value>289</value>
          <newvalue>ptm</newvalue>
        </mapping>
        <mapping>
          <value>290</value>
          <newvalue>ghn</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>pbxRole</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>INDETERMINATE</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>MAIN</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>STAND-BY</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>ACTIVE_PCS</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>INACTIVE_PCS</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>pbxState</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>INDETERMINATE</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>CRITICAL</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>MAJOR</newvalue>
        </mapping>
        <mapping>
          <value>3</value>
          <newvalue>MINOR</newvalue>
        </mapping>
        <mapping>
          <value>4</value>
          <newvalue>WARNING</newvalue>
        </mapping>
        <mapping>
          <value>5</value>
          <newvalue>NORMAL</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>Service state</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Down</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Up</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>zabbix.host.available</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>not available</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>available</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>unknown</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>