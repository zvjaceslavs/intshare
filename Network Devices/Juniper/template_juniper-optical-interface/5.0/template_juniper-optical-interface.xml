<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T08:02:24Z</date>
  <groups>
    <group>
      <name>Juniper Optical Interfaces</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Juniper-Optical-Interfaces</template>
      <name>Juniper-Optical-Interfaces</name>
      <description>Based on Zabbix's official Template Net Juniper SNMPv2, only minor modifications have been made. 1.The interfaces in the down and shutdown states have been filtered,virtual interfaces have also been filtered 2.The trigger threshold seting is -19dbm or 0dbm. 3.only RxLaserPower items,if you need TxLaserPower items but donâ€™t know how to do it, please email me. whye1700#gmail.com(replace # with @)</description>
      <groups>
        <group>
          <name>Juniper Optical Interfaces</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Juniper Optical Interfaces</name>
        </application>
      </applications>
      <discovery_rules>
        <discovery_rule>
          <name>Juniper Optical Interfaces Discovery</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3,{#JNXDOMCURRENTTABLE},1.3.6.1.4.1.2636.3.60.1.1.1]</snmp_oid>
          <key>net.if.optical.discovery</key>
          <delay>12h</delay>
          <filter>
            <evaltype>AND</evaltype>
            <conditions>
              <condition>
                <macro>{#IFADMINSTATUS}</macro>
                <value>(1|3)</value>
                <formulaid>A</formulaid>
              </condition>
              <condition>
                <macro>{#IFOPERSTATUS}</macro>
                <value>(1|3|4|5|7)</value>
                <formulaid>B</formulaid>
              </condition>
              <condition>
                <macro>{#IFTYPE}</macro>
                <value>6</value>
                <formulaid>C</formulaid>
              </condition>
              <condition>
                <macro>{#IFTYPE}</macro>
                <value>(ge|xe)</value>
                <formulaid>D</formulaid>
              </condition>
            </conditions>
          </filter>
          <lifetime>6h</lifetime>
          <item_prototypes>
            <item_prototype>
              <name>Interface {#IFNAME}({#IFALIAS}): RxLaserPower</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.2636.3.60.1.1.1.1.5.{#SNMPINDEX}</snmp_oid>
              <key>jnxDomCurrentRxLaserPower[ifDescr.{#SNMPINDEX}]</key>
              <delay>60s</delay>
              <value_type>FLOAT</value_type>
              <units>dbm</units>
              <applications>
                <application>
                  <name>Juniper Optical Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>MULTIPLIER</type>
                  <params>0.01</params>
                </step>
              </preprocessing>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()}&lt;-19 or {last()}=0</expression>
                  <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                  <recovery_expression>{last()}>-19 and {last()}&lt;>0</recovery_expression>
                  <name>({#IFALIAS}){#IFNAME}-RxLaser-lower-then-19db</name>
                  <priority>WARNING</priority>
                  <manual_close>YES</manual_close>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>Interface {#IFNAME}({#IFALIAS}): RxLaserPower</name>
              <graph_items>
                <graph_item>
                  <color>4000FF</color>
                  <calc_fnc>ALL</calc_fnc>
                  <item>
                    <host>Juniper-Optical-Interfaces</host>
                    <key>jnxDomCurrentRxLaserPower[ifDescr.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
      </discovery_rules>
    </template>
  </templates>
</zabbix_export>