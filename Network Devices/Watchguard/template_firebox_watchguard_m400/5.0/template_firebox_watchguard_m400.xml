<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-19T21:20:49Z</date>
  <groups>
    <group>
      <name>Halley template</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Halley Firewall Watchguard M400</template>
      <name>Halley Firewall Watchguard M400</name>
      <groups>
        <group>
          <name>Halley template</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>CPU</name>
        </application>
        <application>
          <name>Disk partitions</name>
        </application>
        <application>
          <name>General</name>
        </application>
        <application>
          <name>Interfaces</name>
        </application>
        <application>
          <name>Memory</name>
        </application>
        <application>
          <name>Traffic rules</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Free physical memory in %</name>
          <type>CALCULATED</type>
          <key>hrStorageFree.1</key>
          <delay>30</delay>
          <history>1w</history>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <params>(last("hrStorageUsed.1")/last("hrStorageSize.1"))*100</params>
          <description>Free physical memory in percentage. The memory on this device is an CF card</description>
          <applications>
            <application>
              <name>Memory</name>
            </application>
          </applications>
          <triggers>
            <trigger>
              <expression>{last()}&lt;10</expression>
              <name>Lack of available memory on {HOST.NAME}</name>
              <priority>AVERAGE</priority>
              <manual_close>YES</manual_close>
              <tags>
                <tag>
                  <tag>Value</tag>
                  <value>{ITEM.VALUE}</value>
                </tag>
              </tags>
            </trigger>
          </triggers>
        </item>
        <item>
          <name>Total physical memory</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>HOST-RESOURCES-MIB::hrStorageSize.1</snmp_oid>
          <key>hrStorageSize.1</key>
          <delay>30</delay>
          <history>1w</history>
          <units>B</units>
          <description>Total physical memory. The memory on this device is an CF card</description>
          <applications>
            <application>
              <name>Memory</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>1024</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>Used physical memory</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>HOST-RESOURCES-MIB::hrStorageUsed.1</snmp_oid>
          <key>hrStorageUsed.1</key>
          <delay>30</delay>
          <history>1w</history>
          <units>B</units>
          <description>Used physical memory. The memory on this device is an CF card</description>
          <applications>
            <application>
              <name>Memory</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>1024</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>Cached memory</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>HOST-RESOURCES-MIB::hrStorageUsed.7</snmp_oid>
          <key>hrStorageUsed.7</key>
          <delay>30</delay>
          <history>1w</history>
          <units>B</units>
          <description>Cached memory. The memory on this device is an CF card</description>
          <applications>
            <application>
              <name>Memory</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>1024</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>Swap used space</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>HOST-RESOURCES-MIB::hrStorageUsed.10</snmp_oid>
          <key>hrStorageUsed.10</key>
          <delay>30</delay>
          <history>1w</history>
          <units>B</units>
          <description>Swap used space. The memory on this device is an CF card</description>
          <applications>
            <application>
              <name>Memory</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>1024</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>Device description</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysDescr.0</snmp_oid>
          <key>sysDescr</key>
          <delay>30</delay>
          <history>1w</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>A textual description of the entity. This value should include the full name and version identification of the system's hardware type, software operating-system, and networking software.</description>
          <inventory_link>HARDWARE</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Device location</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysLocation.0</snmp_oid>
          <key>sysLocation</key>
          <delay>30</delay>
          <history>1w</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>The physical location of this node (e.g., `telephone closet, 3rd floor'). If the location is unknown, the value is the zero-length string.</description>
          <inventory_link>LOCATION</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Device name</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysName.0</snmp_oid>
          <key>sysName</key>
          <delay>30</delay>
          <history>1w</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <description>An administratively-assigned name for this managed node. By convention, this is the node's fully-qualified domain name. If the name is unknown, the value is the zero-length string.</description>
          <inventory_link>NAME</inventory_link>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Device uptime</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>SNMPv2-MIB::sysUpTime.0</snmp_oid>
          <key>sysUpTime</key>
          <delay>30</delay>
          <history>1w</history>
          <units>uptime</units>
          <description>The time since the network management portion of the system was last re-initialized.</description>
          <applications>
            <application>
              <name>General</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>Processors</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},HOST-RESOURCES-MIB::hrProcessorLoad]</snmp_oid>
          <key>hrProcessorLoad</key>
          <delay>1d</delay>
          <description>Discover the processors of the firewall device</description>
          <item_prototypes>
            <item_prototype>
              <name>Processor $1 type</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>HOST-RESOURCES-MIB::hrDeviceDescr.{#SNMPINDEX}</snmp_oid>
              <key>hrDeviceDescr[{#SNMPINDEX}]</key>
              <trends>0</trends>
              <value_type>CHAR</value_type>
              <description>Processor type</description>
              <applications>
                <application>
                  <name>CPU</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Utilization of processor $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>HOST-RESOURCES-MIB::hrProcessorLoad.{#SNMPINDEX}</snmp_oid>
              <key>hrProcessorLoad[{#SNMPINDEX}]</key>
              <units>%</units>
              <description>The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.</description>
              <applications>
                <application>
                  <name>CPU</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last(,300)}>70</expression>
                  <name>Utilization of processor {#SNMPINDEX} over 70%</name>
                  <priority>AVERAGE</priority>
                  <description>CPU on {HOST.NAME} is over 70%</description>
                  <manual_close>YES</manual_close>
                  <tags>
                    <tag>
                      <tag>Value</tag>
                      <value>{ITEM.VALUE}</value>
                    </tag>
                  </tags>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>Utilization of processor {#SNMPINDEX}</name>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Halley Firewall Watchguard M400</host>
                    <key>hrProcessorLoad[{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Disk partitions</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},HOST-RESOURCES-MIB::hrStorageDescr]</snmp_oid>
          <key>hrStorageDescr</key>
          <delay>1d</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPVALUE}</macro>
                <value>^(/var|/|/boot|/tmp)$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <description>The rule will discover all disk partitions matching the global regexp "Storage devices for SNMP discovery". {$SNMP_COMMUNITY} is a global macro.</description>
          <item_prototypes>
            <item_prototype>
              <name>Description of storage $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>HOST-RESOURCES-MIB::hrStorageDescr.{#SNMPINDEX}</snmp_oid>
              <key>hrStorageDescr[{#SNMPVALUE}]</key>
              <delay>30s</delay>
              <trends>0</trends>
              <value_type>CHAR</value_type>
              <description>A description of the type and instance of the storage described by this entry.</description>
              <applications>
                <application>
                  <name>Disk partitions</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>Total disk space on $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>HOST-RESOURCES-MIB::hrStorageSize.{#SNMPINDEX}</snmp_oid>
              <key>hrStorageSize[{#SNMPVALUE}]</key>
              <delay>30s</delay>
              <units>B</units>
              <description>total disk space in bytes.</description>
              <applications>
                <application>
                  <name>Disk partitions</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>MULTIPLIER</type>
                  <params>10240</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Used disk space on $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>HOST-RESOURCES-MIB::hrStorageUsed.{#SNMPINDEX}</snmp_oid>
              <key>hrStorageUsed[{#SNMPVALUE}]</key>
              <delay>30s</delay>
              <units>B</units>
              <description>Used disk space in bytes.</description>
              <applications>
                <application>
                  <name>Disk partitions</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>MULTIPLIER</type>
                  <params>10240</params>
                </step>
              </preprocessing>
            </item_prototype>
          </item_prototypes>
          <trigger_prototypes>
            <trigger_prototype>
              <expression>{Halley Firewall Watchguard M400:hrStorageUsed[{#SNMPVALUE}].last(0)} / {Halley Firewall Watchguard M400:hrStorageSize[{#SNMPVALUE}].last(0)} > 0.8</expression>
              <name>Free disk space is less than 20% on volume {#SNMPVALUE}</name>
              <priority>WARNING</priority>
            </trigger_prototype>
          </trigger_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>Disk space usage {#SNMPVALUE}</name>
              <width>600</width>
              <height>340</height>
              <yaxismax>0</yaxismax>
              <show_work_period>NO</show_work_period>
              <show_triggers>NO</show_triggers>
              <type>PIE</type>
              <show_3d>YES</show_3d>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Halley Firewall Watchguard M400</host>
                    <key>hrStorageSize[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>F63100</color>
                  <item>
                    <host>Halley Firewall Watchguard M400</host>
                    <key>hrStorageUsed[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Network interfaces</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr]</snmp_oid>
          <key>ifDescr</key>
          <delay>1d</delay>
          <description>You may also consider using IF-MIB::ifType or IF-MIB::ifAlias for discovery depending on your filtering needs. {$SNMP_COMMUNITY} is a global macro.</description>
          <item_prototypes>
            <item_prototype>
              <name>Inbound errors on interface $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifInErrors.{#SNMPINDEX}</snmp_oid>
              <key>ifInErrors[{#SNMPVALUE}]</key>
              <status>DISABLED</status>
              <description>For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol. For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Incoming traffic on interface $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifInOctets.{#SNMPINDEX}</snmp_oid>
              <key>ifInOctets[{#SNMPVALUE}]</key>
              <delay>30s</delay>
              <units>Bps</units>
              <description>The number of octets in valid MAC frames received on this interface in 1 second, including the MAC header and FCS.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Operational status of interface $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
              <key>ifOperStatus[{#SNMPVALUE}]</key>
              <description>The current operational state of the interface.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{diff(0)}=1</expression>
                  <name>Operational status was changed on {HOST.NAME} interface {#SNMPVALUE}</name>
                  <priority>INFO</priority>
                  <manual_close>YES</manual_close>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>Outbound errors on interface $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOutErrors.{#SNMPINDEX}</snmp_oid>
              <key>ifOutErrors[{#SNMPVALUE}]</key>
              <status>DISABLED</status>
              <description>For packet-oriented interfaces, the number of outbound packets that could not be transmitted because of errors. For character-oriented or fixed-length interfaces, the number of outbound transmission units that could not be transmitted because of errors.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>Outgoing traffic on interface $1</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>IF-MIB::ifOutOctets.{#SNMPINDEX}</snmp_oid>
              <key>ifOutOctets[{#SNMPVALUE}]</key>
              <units>Bps</units>
              <description>The number of octets transmitted in MAC frames on this interface per second , including the MAC header and FCS.</description>
              <applications>
                <application>
                  <name>Interfaces</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>Traffic on interface {#SNMPVALUE}</name>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Halley Firewall Watchguard M400</host>
                    <key>ifInOctets[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>F63100</color>
                  <item>
                    <host>Halley Firewall Watchguard M400</host>
                    <key>ifOutOctets[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>Access Rules</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#SNMPVALUE},.enterprises.3097.4.2.2.1.2]</snmp_oid>
          <key>rule[{#SNMPVALUE}]</key>
          <delay>1d</delay>
          <description>https://www.watchguard.com/help/docs/fireware/11/en-US/Content/en-US/basicadmin/snmp_mibs_details_c.html</description>
          <item_prototypes>
            <item_prototype>
              <name>Traffic on {#SNMPVALUE}</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>.enterprises.3097.4.2.2.1.3.{#SNMPINDEX}</snmp_oid>
              <key>Traffic[{#SNMPVALUE}]</key>
              <units>Bps</units>
              <applications>
                <application>
                  <name>Traffic rules</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>Traffic on {#SNMPVALUE}</name>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Halley Firewall Watchguard M400</host>
                    <key>Traffic[{#SNMPVALUE}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
      </discovery_rules>
      <macros>
        <macro>
          <macro>{$SNMP_COMMUNITY}</macro>
          <value>MonitorZabbix</value>
        </macro>
      </macros>
    </template>
  </templates>
  <graphs>
    <graph>
      <name>Memory Usage</name>
      <graph_items>
        <graph_item>
          <color>1A7C11</color>
          <item>
            <host>Halley Firewall Watchguard M400</host>
            <key>hrStorageSize.1</key>
          </item>
        </graph_item>
        <graph_item>
          <sortorder>1</sortorder>
          <color>F63100</color>
          <item>
            <host>Halley Firewall Watchguard M400</host>
            <key>hrStorageUsed.1</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>Swap used space</name>
      <graph_items>
        <graph_item>
          <color>1A7C11</color>
          <item>
            <host>Halley Firewall Watchguard M400</host>
            <key>hrStorageUsed.10</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
  </graphs>
</zabbix_export>