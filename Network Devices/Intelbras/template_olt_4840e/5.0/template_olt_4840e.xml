<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-19T21:25:20Z</date>
  <groups>
    <group>
      <name>Fabricante GCOM</name>
    </group>
    <group>
      <name>Fabricante Intelbras</name>
    </group>
    <group>
      <name>Templates Solustic</name>
    </group>
    <group>
      <name>Templates Solustic - Modulos SNMP</name>
    </group>
    <group>
      <name>Templates Solustic - OLT</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Solustic-GCOM_EL5610_Intelbras_4840E</template>
      <name>Solustic - OLT GCOM EL5610 (Intelbras 4840E) v1.0.0</name>
      <description>Homologado na EL5610-04P (Intelbras 4840E) firmware V100R001B01D001P006SP5</description>
      <templates>
        <template>
          <name>Solustic-Modulo_SNMP_Generico</name>
        </template>
      </templates>
      <groups>
        <group>
          <name>Fabricante GCOM</name>
        </group>
        <group>
          <name>Fabricante Intelbras</name>
        </group>
        <group>
          <name>Templates Solustic - OLT</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Interfaces PON</name>
        </application>
        <application>
          <name>ONU</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Status de ONU (JSON)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#CARD},1.3.6.1.4.1.13464.1.13.3.1.1.1,{#PON},1.3.6.1.4.1.13464.1.13.3.1.1.2,{#ONU},1.3.6.1.4.1.13464.1.13.3.1.1.3,{#ONUSTATUS},1.3.6.1.4.1.13464.1.13.3.1.1.4]</snmp_oid>
          <key>EPON-ONU-CONFIG-MIB.eponOnuOperationStatus</key>
          <history>0</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>Interfaces PON</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Tempo de atividade (uptime)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.3.0</snmp_oid>
          <key>SNMPv2-MIB.sysUpTime.0</key>
          <delay>2m</delay>
          <units>uptime</units>
          <applications>
            <application>
              <name>Sistema</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
          <triggers>
            <trigger>
              <expression>{change(0)} &lt; 0</expression>
              <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
              <recovery_expression>{last()} > 1h</recovery_expression>
              <name>Reboot detectado</name>
              <priority>INFO</priority>
              <description>Esta trigger ser치 fechada automaticamente ap칩s o host atingir 1 hora de uptime.</description>
              <manual_close>YES</manual_close>
            </trigger>
          </triggers>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>Descoberta de ONUs</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#CARD},1.3.6.1.4.1.13464.1.13.3.1.1.1,{#PON},1.3.6.1.4.1.13464.1.13.3.1.1.2,{#ONU},1.3.6.1.4.1.13464.1.13.3.1.1.3,{#ONUNAME},1.3.6.1.4.1.13464.1.13.3.1.1.5,{#ONUID},1.3.6.1.4.1.13464.1.13.3.1.1.9,{#STATUS},1.3.6.1.4.1.13464.1.13.3.1.1.4]</snmp_oid>
          <key>EPON-ONU-CONFIG-MIB.eponOnuInfoTable</key>
          <delay>2h</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#STATUS}</macro>
                <value>^0$</value>
                <operator>NOT_MATCHES_REGEX</operator>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>ONU {#CARD}/{#PON}/{#ONU} {{#ONUID}.regsub("(\w+).(\w+).(\w+).(\w+).(\w+).(\w+)","\1:\2:\3:\4:\5:\6")} ({#ONUNAME}): Status</name>
              <type>DEPENDENT</type>
              <key>EPON-ONU-CONFIG-MIB.eponOnuOperationStatus.[{#SNMPINDEX}]</key>
              <delay>0</delay>
              <applications>
                <application>
                  <name>ONU</name>
                </application>
              </applications>
              <valuemap>
                <name>EPON-ONU-CONFIG-MIB::eponOnuOperationStatus</name>
              </valuemap>
              <preprocessing>
                <step>
                  <type>JSONPATH</type>
                  <params>$..[?(@['{{#SNMPINDEX}.regsub("","{#SNMPINDEX}")}'] == '{#SNMPINDEX}')].['{#ONUSTATUS}']</params>
                </step>
                <step>
                  <type>TRIM</type>
                  <params>["]</params>
                </step>
                <step>
                  <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                  <params>20m</params>
                </step>
              </preprocessing>
              <master_item>
                <key>EPON-ONU-CONFIG-MIB.eponOnuOperationStatus</key>
              </master_item>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{diff()} = 1 and {last()} = 0</expression>
                  <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                  <recovery_expression>{last()} = 1</recovery_expression>
                  <name>ONU {#CARD}/{#PON}/{#ONU} {{#ONUID}.regsub("(\w+).(\w+).(\w+).(\w+).(\w+).(\w+)","\1:\2:\3:\4:\5:\6")} ({#ONUNAME}) est치 offline</name>
                  <discover>NO_DISCOVER</discover>
                  <priority>AVERAGE</priority>
                  <manual_close>YES</manual_close>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
            <item_prototype>
              <name>ONU {#CARD}/{#PON}/{#ONU} {{#ONUID}.regsub("(\w+).(\w+).(\w+).(\w+).(\w+).(\w+)","\1:\2:\3:\4:\5:\6")} ({#ONUNAME}): Potencia Rx</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.13464.1.13.3.3.1.8.{#SNMPINDEX}</snmp_oid>
              <key>EPON-ONU-CONFIG-MIB.eponOnuOpmRxPower.[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <value_type>FLOAT</value_type>
              <units>dBm</units>
              <applications>
                <application>
                  <name>ONU</name>
                </application>
              </applications>
              <trigger_prototypes>
                <trigger_prototype>
                  <expression>{last()} &lt;= {$OLT_EPON.POTENCIA_RX_ONU.CRITICO}</expression>
                  <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                  <recovery_expression>{min(1h)} >= ( {$OLT_EPON.POTENCIA_RX_ONU.CRITICO} + 2 )</recovery_expression>
                  <name>Potencia da ONU {#CARD}/{#PON}/{#ONU} {{#ONUID}.regsub("(\w+).(\w+).(\w+).(\w+).(\w+).(\w+)","\1:\2:\3:\4:\5:\6")} ({#ONUNAME}) abaixo do limite</name>
                  <discover>NO_DISCOVER</discover>
                  <priority>AVERAGE</priority>
                  <description>ultima leitura: {ITEM.LASTVALUE1} limite: {$OLT_EPON.POTENCIA_RX_ONU.CRITICO} dBm</description>
                  <manual_close>YES</manual_close>
                </trigger_prototype>
              </trigger_prototypes>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>ONU {#CARD}/{#PON}/{#ONU} {{#ONUID}.regsub("(\w+).(\w+).(\w+).(\w+).(\w+).(\w+)","\1:\2:\3:\4:\5:\6")} ({#ONUNAME}): Potencia Rx</name>
              <graph_items>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>1A7C11</color>
                  <item>
                    <host>Solustic-GCOM_EL5610_Intelbras_4840E</host>
                    <key>EPON-ONU-CONFIG-MIB.eponOnuOpmRxPower.[{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
            <graph_prototype>
              <name>ONU {#CARD}/{#PON}/{#ONU} {{#ONUID}.regsub("(\w+).(\w+).(\w+).(\w+).(\w+).(\w+)","\1:\2:\3:\4:\5:\6")} ({#ONUNAME}): Status</name>
              <graph_items>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>1A7C11</color>
                  <item>
                    <host>Solustic-GCOM_EL5610_Intelbras_4840E</host>
                    <key>EPON-ONU-CONFIG-MIB.eponOnuOperationStatus.[{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
          <overrides>
            <override>
              <name>Cria triggers de ONU offline e baixa potencia</name>
              <step>1</step>
              <filter>
                <conditions>
                  <condition>
                    <macro>{#ONUNAME}</macro>
                    <value>{$EPON.ONU_NOME.IMPORTANTE}</value>
                    <formulaid>A</formulaid>
                  </condition>
                </conditions>
              </filter>
              <operations>
                <operation>
                  <operationobject>TRIGGER_PROTOTYPE</operationobject>
                  <operator>LIKE</operator>
                  <value>Potencia da ONU</value>
                  <discover>DISCOVER</discover>
                </operation>
                <operation>
                  <operationobject>TRIGGER_PROTOTYPE</operationobject>
                  <operator>LIKE</operator>
                  <value>est치 offline</value>
                  <discover>DISCOVER</discover>
                </operation>
              </operations>
            </override>
          </overrides>
        </discovery_rule>
        <discovery_rule>
          <name>Descoberta de interfaces PON</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#EPONPONOPMVCC},1.3.6.1.4.1.13464.1.13.2.2.1.4]</snmp_oid>
          <key>EPON-PON-CONFIG-MIB.eponPonOpmTable</key>
          <delay>12h</delay>
          <item_prototypes>
            <item_prototype>
              <name>Total de ONUs offline na PON {{#SNMPINDEX}.regsub("(\d+)\.(\d+)","\1/\2")}</name>
              <type>DEPENDENT</type>
              <key>EPON-ONU-CONFIG-MIB.eponOnuOperationStatus.[{#SNMPINDEX},onustatus != 1]</key>
              <delay>0</delay>
              <preprocessing>
                <step>
                  <type>JSONPATH</type>
                  <params>$..[?(@['{#CARD}'] == '{{#SNMPINDEX}.regsub("(\d+)\.(\d+)","\1")}' &amp;&amp; @['{#PON}'] == '{{#SNMPINDEX}.regsub("(\d+)\.(\d+)","\2")}' &amp;&amp; @['{#ONUSTATUS}'] != '1')].length()</params>
                </step>
              </preprocessing>
              <master_item>
                <key>EPON-ONU-CONFIG-MIB.eponOnuOperationStatus</key>
              </master_item>
            </item_prototype>
            <item_prototype>
              <name>Interface PON {{#SNMPINDEX}.regsub("(\d+)\.(\d+)","\1/\2")}: Corrente bias</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.13464.1.13.2.2.1.5.{#SNMPINDEX}</snmp_oid>
              <key>EPON-PON-CONFIG-MIB.eponPonOpmBias[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <value_type>FLOAT</value_type>
              <units>mA</units>
            </item_prototype>
            <item_prototype>
              <name>Interface PON {{#SNMPINDEX}.regsub("(\d+)\.(\d+)","\1/\2")}: Temperatura</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.13464.1.13.2.2.1.3.{#SNMPINDEX}</snmp_oid>
              <key>EPON-PON-CONFIG-MIB.eponPonOpmTemperature[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <units>췈C</units>
            </item_prototype>
            <item_prototype>
              <name>Interface PON {{#SNMPINDEX}.regsub("(\d+)\.(\d+)","\1/\2")}: Voltagem</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.4.1.13464.1.13.2.2.1.4.{#SNMPINDEX}</snmp_oid>
              <key>EPON-PON-CONFIG-MIB.eponPonOpmVcc[{#SNMPINDEX}]</key>
              <delay>5m</delay>
              <value_type>FLOAT</value_type>
              <units>V</units>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
      </discovery_rules>
      <macros>
        <macro>
          <macro>{$EPON.ONU_NOME.IMPORTANTE}</macro>
          <value>(?i)(pacpon|pac pon|torre)</value>
          <description>Palavra no nome da ONU que deve ser criado alertas diferenciados</description>
        </macro>
        <macro>
          <macro>{$OLT_EPON.POTENCIA_RX_ONU.CRITICO}</macro>
          <value>-29</value>
          <description>Potencia em dBm do sinal da ONU para disparar o alerta.</description>
        </macro>
        <macro>
          <macro>{$REGEX_IFNAME_VIRTUAL}</macro>
          <value>VLAN</value>
        </macro>
        <macro>
          <macro>{$REGEX_IFOPERSTATUS_VIRTUAL}</macro>
          <value>^(2|6)$</value>
        </macro>
        <macro>
          <macro>{$REGEX_IFTYPE_FISICA}</macro>
          <value>^(6|117|62)$</value>
          <description>6=ethernetCsmacd, 117=gigabitEthernet</description>
        </macro>
        <macro>
          <macro>{$REGEX_IFTYPE_VIRTUAL}</macro>
          <value>^(53|58|131|135|136|161)$</value>
          <description>53=propVirtual, 58=frameRelayInterconnect, 131=tunnel, 135=l2vlan, 136=l3ipvlan, 161=ieee8023adLag</description>
        </macro>
      </macros>
    </template>
    <template>
      <template>Solustic-Modulo_SNMP_Generico</template>
      <name>Solustic-Modulo SNMP Generico v1.0.2</name>
      <description>MIBs: - SNMPv2-MIB</description>
      <groups>
        <group>
          <name>Templates Solustic</name>
        </group>
        <group>
          <name>Templates Solustic - Modulos SNMP</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>Sistema</name>
        </application>
        <application>
          <name>Status</name>
        </application>
        <application>
          <name>Traps SNMP</name>
        </application>
      </applications>
      <items>
        <item>
          <name>Traps SNMP nao tratados</name>
          <type>SNMP_TRAP</type>
          <key>snmptrap.fallback</key>
          <delay>0</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>LOG</value_type>
          <applications>
            <application>
              <name>Traps SNMP</name>
            </application>
          </applications>
          <logtimefmt>hh:mm:sszyyyy/MM/dd</logtimefmt>
        </item>
        <item>
          <name>Descricao do sistema (sysDescr)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.1.0</snmp_oid>
          <key>SNMPv2-MIB.sysDescr.0</key>
          <delay>6h</delay>
          <history>30d</history>
          <trends>0</trends>
          <value_type>TEXT</value_type>
          <applications>
            <application>
              <name>Sistema</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Localizacao (sysLocation)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.6.0</snmp_oid>
          <key>SNMPv2-MIB.sysLocation.0</key>
          <delay>6h</delay>
          <history>3d</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <inventory_link>LOCATION</inventory_link>
          <applications>
            <application>
              <name>Sistema</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Nome (hostname)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.5.0</snmp_oid>
          <key>SNMPv2-MIB.sysName.0</key>
          <delay>2h</delay>
          <history>30d</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <inventory_link>NAME</inventory_link>
          <applications>
            <application>
              <name>Sistema</name>
            </application>
          </applications>
        </item>
        <item>
          <name>ID do objeto (sysObjectID)</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.1.2.0</snmp_oid>
          <key>SNMPv2-MIB.sysObjectID.0</key>
          <delay>6h</delay>
          <history>7d</history>
          <trends>0</trends>
          <value_type>CHAR</value_type>
          <inventory_link>TYPE</inventory_link>
          <applications>
            <application>
              <name>Sistema</name>
            </application>
          </applications>
        </item>
        <item>
          <name>Disponibilidade do SNMP</name>
          <type>INTERNAL</type>
          <key>zabbix[host,snmp,available]</key>
          <delay>2m</delay>
          <history>1w</history>
          <trends>0</trends>
          <applications>
            <application>
              <name>Status</name>
            </application>
          </applications>
          <valuemap>
            <name>zabbix.host.available[pt-BR]</name>
          </valuemap>
          <triggers>
            <trigger>
              <expression>{max(3m)}=0</expression>
              <name>SNMP sem resposta</name>
              <priority>WARNING</priority>
              <description>ultimo valor: {ITEM.LASTVALUE1}. O servi칞o SNMP n칚o est치 respondendo. Verifique a conectividade ou as configura칞칫es de SNMP.</description>
            </trigger>
          </triggers>
        </item>
      </items>
    </template>
  </templates>
  <value_maps>
    <value_map>
      <name>EPON-ONU-CONFIG-MIB::eponOnuOperationStatus</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>Down</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>Up</newvalue>
        </mapping>
      </mappings>
    </value_map>
    <value_map>
      <name>zabbix.host.available[pt-BR]</name>
      <mappings>
        <mapping>
          <value>0</value>
          <newvalue>indispon칤vel</newvalue>
        </mapping>
        <mapping>
          <value>1</value>
          <newvalue>dispon칤vel</newvalue>
        </mapping>
        <mapping>
          <value>2</value>
          <newvalue>desconhecido</newvalue>
        </mapping>
      </mappings>
    </value_map>
  </value_maps>
</zabbix_export>