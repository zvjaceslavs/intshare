<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
  <version>5.0</version>
  <date>2021-10-22T08:01:35Z</date>
  <groups>
    <group>
      <name>Templates/Mikrotik Network Devices</name>
    </group>
  </groups>
  <templates>
    <template>
      <template>Mikrotik RouterBOARD</template>
      <name>Mikrotik RouterBOARD</name>
      <description>Ros 专用模板（RB设备） 该模板只用于RouterOS路由系统监控，其它设备请绕路。 By:【犯罪嫌疑人】</description>
      <groups>
        <group>
          <name>Templates/Mikrotik Network Devices</name>
        </group>
      </groups>
      <applications>
        <application>
          <name>CPU状况</name>
        </application>
        <application>
          <name>DHCP</name>
        </application>
        <application>
          <name>PPP接口</name>
        </application>
        <application>
          <name>健康状态</name>
        </application>
        <application>
          <name>内存状况</name>
        </application>
        <application>
          <name>外网接口</name>
        </application>
        <application>
          <name>延迟丢包</name>
        </application>
        <application>
          <name>本地接口</name>
        </application>
      </applications>
      <items>
        <item>
          <name>CPU使用率（总）</name>
          <type>CALCULATED</type>
          <key>cpucore[ifnum]</key>
          <delay>30s</delay>
          <units>%</units>
          <params>(last(cpucore[ifnum1]))/1</params>
          <description>提示：请根据自己设备的核心数来填！复制公式代码即可。 参考如下： 2核心公式 (last(cpucore[ifnum1])+last(cpucore[ifnum2]))/2 3核心公式 (last(cpucore[ifnum1])+last(cpucore[ifnum2])+last(cpucore[ifnum3]))/3 4核心公式 (last(cpucore[ifnum1])+last(cpucore[ifnum2])+last(cpucore[ifnum3])+last(cpucore[ifnum4]))/4</description>
          <applications>
            <application>
              <name>CPU状况</name>
            </application>
          </applications>
        </item>
        <item>
          <name>CPU温度</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.11.0</snmp_oid>
          <key>mikrotik.cpu.temperature</key>
          <delay>30s</delay>
          <value_type>FLOAT</value_type>
          <units>°C</units>
          <applications>
            <application>
              <name>健康状态</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.1</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>设备温度</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.4.1.14988.1.1.3.10.0</snmp_oid>
          <key>mikrotik.device.temperature</key>
          <delay>30s</delay>
          <value_type>FLOAT</value_type>
          <units>°C</units>
          <applications>
            <application>
              <name>健康状态</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.1</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>运行时间</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>.1.3.6.1.2.1.1.3.0</snmp_oid>
          <key>mikrotik.uptime</key>
          <delay>30s</delay>
          <units>uptime</units>
          <applications>
            <application>
              <name>健康状态</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>0.01</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>剩余内存</name>
          <type>CALCULATED</type>
          <key>vm.memory.free[hrStoragefree.Memory]</key>
          <delay>30s</delay>
          <value_type>FLOAT</value_type>
          <units>B</units>
          <params>(last(vm.memory.total[hrStorageSize.Memory])-last(vm.memory.used[hrStorageUsed.Memory]))</params>
          <applications>
            <application>
              <name>内存状况</name>
            </application>
          </applications>
        </item>
        <item>
          <name>内存使用率</name>
          <type>CALCULATED</type>
          <key>vm.memory.pused[memoryUsedPercentage.Memory]</key>
          <delay>30s</delay>
          <value_type>FLOAT</value_type>
          <units>%</units>
          <params>(last(vm.memory.used[hrStorageUsed.Memory])/last(vm.memory.total[hrStorageSize.Memory]))*100</params>
          <applications>
            <application>
              <name>内存状况</name>
            </application>
          </applications>
        </item>
        <item>
          <name>内存大小</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.25.2.3.1.5.65536</snmp_oid>
          <key>vm.memory.total[hrStorageSize.Memory]</key>
          <delay>15s</delay>
          <units>B</units>
          <applications>
            <application>
              <name>内存状况</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>1045</params>
            </step>
          </preprocessing>
        </item>
        <item>
          <name>已用内存</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>1.3.6.1.2.1.25.2.3.1.6.65536</snmp_oid>
          <key>vm.memory.used[hrStorageUsed.Memory]</key>
          <delay>15s</delay>
          <units>B</units>
          <applications>
            <application>
              <name>内存状况</name>
            </application>
          </applications>
          <preprocessing>
            <step>
              <type>MULTIPLIER</type>
              <params>1024</params>
            </step>
          </preprocessing>
        </item>
      </items>
      <discovery_rules>
        <discovery_rule>
          <name>发现本地网卡接口</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discoverylocal[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
          <key>discoverylocal</key>
          <delay>30s</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPINDEX}</macro>
                <value>^([1,2,3,4,5,6,7,8,9]|10)$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <description>正则表达式1-10号网卡 ^([1,2,3,4,5,6,7,8,9]|10)$</description>
          <item_prototypes>
            <item_prototype>
              <name>{#IFNAME}网卡流量接收</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}</snmp_oid>
              <key>net.if.in[localin.{#SNMPINDEX}]</key>
              <delay>1s</delay>
              <applications>
                <application>
                  <name>本地接口</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>{#IFNAME}网卡流量发送</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}</snmp_oid>
              <key>net.if.out[localout.{#SNMPINDEX}]</key>
              <delay>1s</delay>
              <applications>
                <application>
                  <name>本地接口</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>SIMPLE_CHANGE</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>{#IFNAME}网卡接口流量</name>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if.out[localout.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>F63100</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if.in[localin.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>发现网络接口</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
          <key>net.if.discovery</key>
          <delay>30s</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPINDEX}</macro>
                <value>^\d{2,3}$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <description>正则表达式2-3位数字 ^\d{2,3}$</description>
          <item_prototypes>
            <item_prototype>
              <name>{#IFNAME}流量接收</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}</snmp_oid>
              <key>net.if.in[ifHCInOctets.{#SNMPINDEX}]</key>
              <delay>1s</delay>
              <applications>
                <application>
                  <name>本地接口</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
            <item_prototype>
              <name>{#IFNAME}流量发送</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}</snmp_oid>
              <key>net.if.out[ifHCOutOctets.{#SNMPINDEX}]</key>
              <delay>1s</delay>
              <units>bps</units>
              <applications>
                <application>
                  <name>本地接口</name>
                </application>
              </applications>
              <preprocessing>
                <step>
                  <type>CHANGE_PER_SECOND</type>
                  <params></params>
                </step>
                <step>
                  <type>MULTIPLIER</type>
                  <params>8</params>
                </step>
              </preprocessing>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>{#IFNAME}网络流量</name>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if.out[ifHCOutOctets.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>F63100</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if.in[ifHCInOctets.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>自动检查VPN拨出帐号</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discoveryppp[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]</snmp_oid>
          <key>net.if.discoveryppp</key>
          <delay>30s</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPINDEX}</macro>
                <value>^(157)+\d{1,}$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>{#IFNAME}流量接收</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}</snmp_oid>
              <key>net.if.in[ifHCInOctetsppp.{#SNMPINDEX}]</key>
              <delay>30s</delay>
              <units>bps</units>
              <applications>
                <application>
                  <name>PPP接口</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>{#IFNAME}流量发送</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}</snmp_oid>
              <key>net.if.out[ifHCOutOctetsppp.{#SNMPINDEX}]</key>
              <delay>30s</delay>
              <units>bps</units>
              <applications>
                <application>
                  <name>PPP接口</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>{#IFNAME}拨出流量</name>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if.out[ifHCOutOctetsppp.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>F63100</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if.in[ifHCInOctetsppp.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>发现接口流量统计</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discoveryStatistics[{#IFBYTESIN},1.3.6.1.2.1.31.1.1.1.6,{#IFBYTESOUT},1.3.6.1.2.1.31.1.1.1.10,{#IFNAME},1.3.6.1.2.1.2.2.1.2]</snmp_oid>
          <key>net.if.discoveryStatistics</key>
          <delay>30s</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPINDEX}</macro>
                <value>^\d{2,8}$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>{#IFNAME}接收总量获取</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}</snmp_oid>
              <key>net.if[interface.in.{#SNMPINDEX}]</key>
              <delay>30s</delay>
              <units>B</units>
              <applications>
                <application>
                  <name>外网接口</name>
                </application>
                <application>
                  <name>本地接口</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>{#IFNAME}发送总量获取</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}</snmp_oid>
              <key>net.if[interface.out.{#SNMPINDEX}]</key>
              <delay>30s</delay>
              <units>B</units>
              <applications>
                <application>
                  <name>外网接口</name>
                </application>
                <application>
                  <name>本地接口</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>{#IFNAME}接口统计</name>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if[interface.out.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>F63100</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if[interface.in.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>自动发现本地网卡流量统计</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discoveryStatistics[{#IFBYTESIN},1.3.6.1.2.1.31.1.1.1.6,{#IFBYTESOUT},1.3.6.1.2.1.31.1.1.1.10,{#IFNAME},1.3.6.1.2.1.2.2.1.2]</snmp_oid>
          <key>net.if.discoveryStatisticslocal</key>
          <delay>30s</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPINDEX}</macro>
                <value>^([1,2,3,4,5,6,7,8,9]|10)$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>{#IFNAME}本地网卡接收总量获取</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}</snmp_oid>
              <key>net.if[localinterface.in.{#SNMPINDEX}]</key>
              <delay>30s</delay>
              <units>B</units>
              <applications>
                <application>
                  <name>本地接口</name>
                </application>
              </applications>
            </item_prototype>
            <item_prototype>
              <name>{#IFNAME}本地网卡发送总量获取</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}</snmp_oid>
              <key>net.if[localinterface.out{#SNMPINDEX}]</key>
              <delay>30s</delay>
              <units>B</units>
              <applications>
                <application>
                  <name>本地接口</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
          <graph_prototypes>
            <graph_prototype>
              <name>{#IFNAME}本地接口统计</name>
              <graph_items>
                <graph_item>
                  <color>1A7C11</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if[localinterface.out{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
                <graph_item>
                  <sortorder>1</sortorder>
                  <color>F63100</color>
                  <item>
                    <host>Mikrotik RouterBOARD</host>
                    <key>net.if[localinterface.in.{#SNMPINDEX}]</key>
                  </item>
                </graph_item>
              </graph_items>
            </graph_prototype>
          </graph_prototypes>
        </discovery_rule>
        <discovery_rule>
          <name>自动检查CPU</name>
          <type>SNMP_AGENT</type>
          <snmp_oid>discoverycpu[{#IFCPUNUM},1.3.6.1.2.1.25.3.3.1.2]</snmp_oid>
          <key>system.discoverycpu</key>
          <delay>3s</delay>
          <filter>
            <conditions>
              <condition>
                <macro>{#SNMPINDEX}</macro>
                <value>^([0,1,2,3,4,5,6,7,8,9]|10|11|12|13|14|15|16)$</value>
                <formulaid>A</formulaid>
              </condition>
            </conditions>
          </filter>
          <item_prototypes>
            <item_prototype>
              <name>CPU{#SNMPINDEX}使用</name>
              <type>SNMP_AGENT</type>
              <snmp_oid>1.3.6.1.2.1.25.3.3.1.2.{#SNMPINDEX}</snmp_oid>
              <key>cpucore[ifnum{#SNMPINDEX}]</key>
              <delay>15s</delay>
              <applications>
                <application>
                  <name>CPU状况</name>
                </application>
              </applications>
            </item_prototype>
          </item_prototypes>
        </discovery_rule>
      </discovery_rules>
    </template>
  </templates>
  <graphs>
    <graph>
      <name>CPU使用率%</name>
      <graph_items>
        <graph_item>
          <color>1A7C11</color>
          <item>
            <host>Mikrotik RouterBOARD</host>
            <key>cpucore[ifnum]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>内存占用率</name>
      <graph_items>
        <graph_item>
          <color>1A7C11</color>
          <item>
            <host>Mikrotik RouterBOARD</host>
            <key>vm.memory.pused[memoryUsedPercentage.Memory]</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
    <graph>
      <name>设备温度</name>
      <graph_items>
        <graph_item>
          <color>1A7C11</color>
          <item>
            <host>Mikrotik RouterBOARD</host>
            <key>mikrotik.device.temperature</key>
          </item>
        </graph_item>
      </graph_items>
    </graph>
  </graphs>
</zabbix_export>